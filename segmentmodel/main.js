/*! segment-model-spy v0.0.1 - Copyright 2020 Kari Lavikka */!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=31)}([function(t,e,n){"use strict";var r=function(t,e,n){return t.fields=e||[],t.fname=n,t};function i(t){return null==t?null:t.fields}var o=function(t){throw Error(t)},a=function(t){var e,n,r,i=[],a=null,s=0,u=t.length,c="";function l(){i.push(c+t.substring(e,n)),c="",e=n+1}for(t+="",e=n=0;n<u;++n)if("\\"===(r=t[n]))c+=t.substring(e,n),c+=t.substring(++n,++n),e=n;else if(r===a)l(),a=null,s=-1;else{if(a)continue;e===s&&'"'===r?(e=n+1,a=r):e===s&&"'"===r?(e=n+1,a=r):"."!==r||s?"["===r?(n>e&&l(),s=e=n+1):"]"===r&&(s||o("Access path missing open bracket: "+t),s>0&&l(),s=0,e=n+1):n>e?l():e=n+1}return s&&o("Access path missing closing bracket: "+t),a&&o("Access path missing closing quote: "+t),n>e&&(n++,l()),i},s=Array.isArray,u=function(t){return t===Object(t)},c=function(t){return"string"==typeof t};function l(t){return s(t)?"["+t.map(l)+"]":u(t)||c(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}var f=function(t,e){var n=a(t),i="return _["+n.map(l).join("][")+"];";return r(Function("_",i),[t=1===n.length?n[0]:t],e||t)},h=[],d=(f("id"),r((function(t){return t}),h,"identity"));r((function(){return 0}),h,"zero"),r((function(){return 1}),h,"one"),r((function(){return!0}),h,"true"),r((function(){return!1}),h,"false");var p=function(t){return t[t.length-1]},m=function(t){return null==t||""===t?null:+t};function g(t){return function(e){return t*Math.exp(e)}}function y(t){return function(e){return Math.log(t*e)}}function v(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function b(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function w(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function A(t,e,n,r,i){var o=r(t[0]),a=r(p(t)),s=null!=e?r(e):(o+a)/2;return[i(s+(o-s)*n),i(s+(a-s)*n)]}function E(t,e,n){return A(t,e,n,m,d)}function x(t,e,n){var r=Math.sign(t[0]);return A(t,e,n,y(r),g(r))}function _(t,e,n,r){return A(t,e,n,w(r),w(1/r))}function C(t,e,n,r){return A(t,e,n,v(r),b(r))}var T=function(t){return null!=t?s(t)?t:[t]:[]},O=function(t){return"function"==typeof t},S=function(t,e){var n,o,s,u,c,f,h,d,p,m=[],g=(t=T(t)).map((function(t,e){return null==t?null:(m.push(e),O(t)?t:a(t).map(l).join("]["))})),y=m.length-1,v=T(e),b="var u,v;return ";if(y<0)return null;for(o=0;o<=y;++o)s=g[n=m[o]],O(s)?(u="(u=this."+(f="f"+n)+"(a))",c="(v=this."+f+"(b))",(h=h||{})[f]=s):(u="(u=a["+s+"])",c="(v=b["+s+"])"),f="((v=v instanceof Date?+v:v),(u=u instanceof Date?+u:u))","descending"!==v[n]?(p=1,d=-1):(p=-1,d=1),b+="("+u+"<"+c+"||u==null)&&v!=null?"+d+":(u>v||v==null)&&u!=null?"+p+":"+f+"!==u&&v===v?"+d+":v!==v&&u===u?"+p+(n<y?":":":0");return s=Function("a","b",b+";"),h&&(s=s.bind(h)),t=t.reduce((function(t,e){return O(e)?(i(e)||[]).forEach((function(e){t[e]=1})):null!=e&&(t[e+""]=1),t}),{}),r(s,Object.keys(t))},M=function(t){return O(t)?t:function(){return t}},k=function(t){for(var e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r])t[n]=e[n];return t};const D=Object.prototype.hasOwnProperty;var F=function(t,e){return D.call(t,e)},N={},I=function(t){var e,n,r={};function i(t){return F(r,t)&&r[t]!==N}return e={size:0,empty:0,object:r,has:i,get:function(t){return i(t)?r[t]:void 0},set:function(t,n){return i(t)||(++e.size,r[t]===N&&--e.empty),r[t]=n,this},delete:function(t){return i(t)&&(--e.size,++e.empty,r[t]=N),this},clear:function(){e.size=e.empty=0,e.object=r={}},test:function(t){return arguments.length?(n=t,e):n},clean:function(){var t,i,o={},a=0;for(t in r)(i=r[t])===N||n&&n(i)||(o[t]=i,++a);e.size=a,e.empty=0,e.object=r=o}},t&&Object.keys(t).forEach((function(n){e.set(n,t[n])})),e},R=function(t){return"boolean"==typeof t},B=function(t){return"number"==typeof t},L=function(t,e){const n=t[0],r=p(t),i=+e;return i?1===i?r:n+i*(r-n):n},P=function(t){return t&&p(t)-t[0]||0},z=function(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t)&&!!t};function U(t){return B(t)?t:function(t){return"[object Date]"===Object.prototype.toString.call(t)}(t)?t:Date.parse(t)}var W=function(t,e){return e=e||U,null==t||""===t?null:e(t)},j=function(t){return null==t||""===t?null:t+""},H=function(t){for(var e={},n=0,r=t.length;n<r;++n)e[t[n]]=!0;return e};n.d(e,"a",(function(){return i})),n.d(e,"i",(function(){return d})),n.d(e,"y",(function(){return E})),n.d(e,"z",(function(){return x})),n.d(e,"A",(function(){return _})),n.d(e,"B",(function(){return C})),n.d(e,"b",(function(){return S})),n.d(e,"c",(function(){return M})),n.d(e,"d",(function(){return o})),n.d(e,"e",(function(){return k})),n.d(e,"f",(function(){return I})),n.d(e,"g",(function(){return f})),n.d(e,"h",(function(){return F})),n.d(e,"j",(function(){return s})),n.d(e,"k",(function(){return R})),n.d(e,"l",(function(){return O})),n.d(e,"m",(function(){return B})),n.d(e,"n",(function(){return u})),n.d(e,"o",(function(){return c})),n.d(e,"p",(function(){return L})),n.d(e,"q",(function(){return p})),n.d(e,"r",(function(){return P})),n.d(e,"s",(function(){return l})),n.d(e,"t",(function(){return z})),n.d(e,"u",(function(){return W})),n.d(e,"v",(function(){return m})),n.d(e,"x",(function(){return j})),n.d(e,"w",(function(){return H}))},,,,,function(t,e){t.exports=function(t){return[...t].reduce((t,[e,n])=>(t[e]=n,t),{})}},function(t,e){t.exports="precision lowp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n}"},function(t,e,n){"use strict";(function(t,r){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),r.forEach((function(e){a(t,e,n[e])}))}return t}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}n.d(e,"a",(function(){return Et}));var c=function(){},l={},f={},h={mark:c,measure:c};try{"undefined"!=typeof window&&(l=window),"undefined"!=typeof document&&(f=document),"undefined"!=typeof MutationObserver&&MutationObserver,"undefined"!=typeof performance&&(h=performance)}catch(t){}var d=(l.navigator||{}).userAgent,p=void 0===d?"":d,m=l,g=f,y=h,v=(m.document,!!g.documentElement&&!!g.head&&"function"==typeof g.addEventListener&&"function"==typeof g.createElement),b=(~p.indexOf("MSIE")||p.indexOf("Trident/"),function(){try{}catch(t){return!1}}(),[1,2,3,4,5,6,7,8,9,10]),w=b.concat([11,12,13,14,15,16,17,18,19,20]),A={GROUP:"group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},E=(["xs","sm","lg","fw","ul","li","border","pull-left","pull-right","spin","pulse","rotate-90","rotate-180","rotate-270","flip-horizontal","flip-vertical","flip-both","stack","stack-1x","stack-2x","inverse","layers","layers-text","layers-counter",A.GROUP,A.SWAP_OPACITY,A.PRIMARY,A.SECONDARY].concat(b.map((function(t){return"".concat(t,"x")}))).concat(w.map((function(t){return"w-".concat(t)}))),m.FontAwesomeConfig||{});if(g&&"function"==typeof g.querySelector){[["data-family-prefix","familyPrefix"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach((function(t){var e=u(t,2),n=e[0],r=e[1],i=function(t){return""===t||"false"!==t&&("true"===t||t)}(function(t){var e=g.querySelector("script["+t+"]");if(e)return e.getAttribute(t)}(n));null!=i&&(E[r]=i)}))}var x=s({},{familyPrefix:"fa",replacementClass:"svg-inline--fa",autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0},E);x.autoReplaceSvg||(x.observeMutations=!1);var _=s({},x);m.FontAwesomeConfig=_;var C=m||{};C.___FONT_AWESOME___||(C.___FONT_AWESOME___={}),C.___FONT_AWESOME___.styles||(C.___FONT_AWESOME___.styles={}),C.___FONT_AWESOME___.hooks||(C.___FONT_AWESOME___.hooks={}),C.___FONT_AWESOME___.shims||(C.___FONT_AWESOME___.shims=[]);var T=C.___FONT_AWESOME___,O=[];v&&((g.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(g.readyState)||g.addEventListener("DOMContentLoaded",(function t(){g.removeEventListener("DOMContentLoaded",t),1,O.map((function(t){return t()}))})));var S,M=function(){},k=void 0!==t&&void 0!==t.process&&"function"==typeof t.process.emit,D=void 0===r?setTimeout:r,F=[];function N(){for(var t=0;t<F.length;t++)F[t][0](F[t][1]);F=[],S=!1}function I(t,e){F.push([t,e]),S||(S=!0,D(N,0))}function R(t){var e=t.owner,n=e._state,r=e._data,i=t[n],o=t.then;if("function"==typeof i){n="fulfilled";try{r=i(r)}catch(t){z(o,t)}}B(o,r)||("fulfilled"===n&&L(o,r),"rejected"===n&&z(o,r))}function B(t,e){var n;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(e&&("function"==typeof e||"object"===i(e))){var r=e.then;if("function"==typeof r)return r.call(e,(function(r){n||(n=!0,e===r?P(t,r):L(t,r))}),(function(e){n||(n=!0,z(t,e))})),!0}}catch(e){return n||z(t,e),!0}return!1}function L(t,e){t!==e&&B(t,e)||P(t,e)}function P(t,e){"pending"===t._state&&(t._state="settled",t._data=e,I(W,t))}function z(t,e){"pending"===t._state&&(t._state="settled",t._data=e,I(j,t))}function U(t){t._then=t._then.forEach(R)}function W(t){t._state="fulfilled",U(t)}function j(e){e._state="rejected",U(e),!e._handled&&k&&t.process.emit("unhandledRejection",e._data,e)}function H(e){t.process.emit("rejectionHandled",e)}function Y(t){if("function"!=typeof t)throw new TypeError("Promise resolver "+t+" is not a function");if(this instanceof Y==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._then=[],function(t,e){function n(t){z(e,t)}try{t((function(t){L(e,t)}),n)}catch(t){n(t)}}(t,this)}Y.prototype={constructor:Y,_state:"pending",_then:null,_data:void 0,_handled:!1,then:function(t,e){var n={owner:this,then:new this.constructor(M),fulfilled:t,rejected:e};return!e&&!t||this._handled||(this._handled=!0,"rejected"===this._state&&k&&I(H,this)),"fulfilled"===this._state||"rejected"===this._state?I(R,n):this._then.push(n),n.then},catch:function(t){return this.then(null,t)}},Y.all=function(t){if(!Array.isArray(t))throw new TypeError("You must pass an array to Promise.all().");return new Y((function(e,n){var r=[],i=0;function o(t){return i++,function(n){r[t]=n,--i||e(r)}}for(var a,s=0;s<t.length;s++)(a=t[s])&&"function"==typeof a.then?a.then(o(s),n):r[s]=a;i||e(r)}))},Y.race=function(t){if(!Array.isArray(t))throw new TypeError("You must pass an array to Promise.race().");return new Y((function(e,n){for(var r,i=0;i<t.length;i++)(r=t[i])&&"function"==typeof r.then?r.then(e,n):e(r)}))},Y.resolve=function(t){return t&&"object"===i(t)&&t.constructor===Y?t:new Y((function(e){e(t)}))},Y.reject=function(t){return new Y((function(e,n){n(t)}))};var $={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function q(t){if(t&&v){var e=g.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=t;for(var n=g.head.childNodes,r=null,i=n.length-1;i>-1;i--){var o=n[i],a=(o.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(a)>-1&&(r=o)}return g.head.insertBefore(e,r),t}}function X(){for(var t=12,e="";t-- >0;)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return e}function V(t){return"".concat(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function G(t){return Object.keys(t||{}).reduce((function(e,n){return e+"".concat(n,": ").concat(t[n],";")}),"")}function K(t){return t.size!==$.size||t.x!==$.x||t.y!==$.y||t.rotate!==$.rotate||t.flipX||t.flipY}function Z(t){var e=t.transform,n=t.containerWidth,r=t.iconWidth,i={transform:"translate(".concat(n/2," 256)")},o="translate(".concat(32*e.x,", ").concat(32*e.y,") "),a="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),s="rotate(".concat(e.rotate," 0 0)");return{outer:i,inner:{transform:"".concat(o," ").concat(a," ").concat(s)},path:{transform:"translate(".concat(r/2*-1," -256)")}}}var J={x:0,y:0,width:"100%",height:"100%"};function Q(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t.attributes&&(t.attributes.fill||e)&&(t.attributes.fill="black"),t}function tt(t){var e=t.icons,n=e.main,r=e.mask,i=t.prefix,o=t.iconName,a=t.transform,u=t.symbol,c=t.title,l=t.extra,f=t.watchable,h=void 0!==f&&f,d=r.found?r:n,p=d.width,m=d.height,g="fa-w-".concat(Math.ceil(p/m*16)),y=[_.replacementClass,o?"".concat(_.familyPrefix,"-").concat(o):"",g].filter((function(t){return-1===l.classes.indexOf(t)})).concat(l.classes).join(" "),v={children:[],attributes:s({},l.attributes,{"data-prefix":i,"data-icon":o,class:y,role:l.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(p," ").concat(m)})};h&&(v.attributes["data-fa-i2svg"]=""),c&&v.children.push({tag:"title",attributes:{id:v.attributes["aria-labelledby"]||"title-".concat(X())},children:[c]});var b=s({},v,{prefix:i,iconName:o,main:n,mask:r,transform:a,symbol:u,styles:l.styles}),w=r.found&&n.found?function(t){var e,n=t.children,r=t.attributes,i=t.main,o=t.mask,a=t.transform,u=i.width,c=i.icon,l=o.width,f=o.icon,h=Z({transform:a,containerWidth:l,iconWidth:u}),d={tag:"rect",attributes:s({},J,{fill:"white"})},p=c.children?{children:c.children.map(Q)}:{},m={tag:"g",attributes:s({},h.inner),children:[Q(s({tag:c.tag,attributes:s({},c.attributes,h.path)},p))]},g={tag:"g",attributes:s({},h.outer),children:[m]},y="mask-".concat(X()),v="clip-".concat(X()),b={tag:"mask",attributes:s({},J,{id:y,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[d,g]},w={tag:"defs",children:[{tag:"clipPath",attributes:{id:v},children:(e=f,"g"===e.tag?e.children:[e])},b]};return n.push(w,{tag:"rect",attributes:s({fill:"currentColor","clip-path":"url(#".concat(v,")"),mask:"url(#".concat(y,")")},J)}),{children:n,attributes:r}}(b):function(t){var e=t.children,n=t.attributes,r=t.main,i=t.transform,o=G(t.styles);if(o.length>0&&(n.style=o),K(i)){var a=Z({transform:i,containerWidth:r.width,iconWidth:r.width});e.push({tag:"g",attributes:s({},a.outer),children:[{tag:"g",attributes:s({},a.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:s({},r.icon.attributes,a.path)}]}]})}else e.push(r.icon);return{children:e,attributes:n}}(b),A=w.children,E=w.attributes;return b.children=A,b.attributes=E,u?function(t){var e=t.prefix,n=t.iconName,r=t.children,i=t.attributes,o=t.symbol;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:s({},i,{id:!0===o?"".concat(e,"-").concat(_.familyPrefix,"-").concat(n):o}),children:r}]}]}(b):function(t){var e=t.children,n=t.main,r=t.mask,i=t.attributes,o=t.styles,a=t.transform;if(K(a)&&n.found&&!r.found){var u={x:n.width/n.height/2,y:.5};i.style=G(s({},o,{"transform-origin":"".concat(u.x+a.x/16,"em ").concat(u.y+a.y/16,"em")}))}return[{tag:"svg",attributes:i,children:e}]}(b)}var et=function(){},nt=(_.measurePerformance&&y&&y.mark&&y.measure,function(t,e,n,r){var i,o,a,s=Object.keys(t),u=s.length,c=void 0!==r?function(t,e){return function(n,r,i,o){return t.call(e,n,r,i,o)}}(e,r):e;for(void 0===n?(i=1,a=t[s[0]]):(i=0,a=n);i<u;i++)a=c(a,t[o=s[i]],o,t);return a});function rt(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.skipHooks,i=void 0!==r&&r,o=Object.keys(e).reduce((function(t,n){var r=e[n];return!!r.icon?t[r.iconName]=r.icon:t[n]=r,t}),{});"function"!=typeof T.hooks.addPack||i?T.styles[t]=s({},T.styles[t]||{},o):T.hooks.addPack(t,o),"fas"===t&&rt("fa",e)}var it=T.styles,ot=T.shims,at=function(){var t=function(t){return nt(it,(function(e,n,r){return e[r]=nt(n,t,{}),e}),{})};t((function(t,e,n){return e[3]&&(t[e[3]]=n),t})),t((function(t,e,n){var r=e[2];return t[n]=n,r.forEach((function(e){t[e]=n})),t}));var e="far"in it;nt(ot,(function(t,n){var r=n[0],i=n[1],o=n[2];return"far"!==i||e||(i="fas"),t[r]={prefix:i,iconName:o},t}),{})};at();T.styles;function st(t,e,n){if(t&&t[e]&&t[e][n])return{prefix:e,iconName:n,icon:t[e][n]}}function ut(t){var e=t.tag,n=t.attributes,r=void 0===n?{}:n,i=t.children,o=void 0===i?[]:i;return"string"==typeof t?V(t):"<".concat(e," ").concat(function(t){return Object.keys(t||{}).reduce((function(e,n){return e+"".concat(n,'="').concat(V(t[n]),'" ')}),"").trim()}(r),">").concat(o.map(ut).join(""),"</").concat(e,">")}function ct(t){this.name="MissingIcon",this.message=t||"Icon unavailable",this.stack=(new Error).stack}ct.prototype=Object.create(Error.prototype),ct.prototype.constructor=ct;var lt={fill:"currentColor"},ft={attributeType:"XML",repeatCount:"indefinite",dur:"2s"},ht={tag:"path",attributes:s({},lt,{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})},dt=s({},ft,{attributeName:"opacity"});s({},lt,{cx:"256",cy:"364",r:"28"}),s({},ft,{attributeName:"r",values:"28;14;28;28;14;28;"}),s({},dt,{values:"1;0;1;1;0;1;"}),s({},lt,{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),s({},dt,{values:"1;0;0;0;0;1;"}),s({},lt,{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),s({},dt,{values:"0;0;1;1;0;0;"}),T.styles;function pt(t){var e=t[0],n=t[1],r=u(t.slice(4),1)[0];return{found:!0,width:e,height:n,icon:Array.isArray(r)?{tag:"g",attributes:{class:"".concat(_.familyPrefix,"-").concat(A.GROUP)},children:[{tag:"path",attributes:{class:"".concat(_.familyPrefix,"-").concat(A.SECONDARY),fill:"currentColor",d:r[0]}},{tag:"path",attributes:{class:"".concat(_.familyPrefix,"-").concat(A.PRIMARY),fill:"currentColor",d:r[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:r}}}}T.styles;function mt(){var t="svg-inline--fa",e=_.familyPrefix,n=_.replacementClass,r='svg:not(:root).svg-inline--fa {\n  overflow: visible;\n}\n\n.svg-inline--fa {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.225em;\n}\n.svg-inline--fa.fa-w-1 {\n  width: 0.0625em;\n}\n.svg-inline--fa.fa-w-2 {\n  width: 0.125em;\n}\n.svg-inline--fa.fa-w-3 {\n  width: 0.1875em;\n}\n.svg-inline--fa.fa-w-4 {\n  width: 0.25em;\n}\n.svg-inline--fa.fa-w-5 {\n  width: 0.3125em;\n}\n.svg-inline--fa.fa-w-6 {\n  width: 0.375em;\n}\n.svg-inline--fa.fa-w-7 {\n  width: 0.4375em;\n}\n.svg-inline--fa.fa-w-8 {\n  width: 0.5em;\n}\n.svg-inline--fa.fa-w-9 {\n  width: 0.5625em;\n}\n.svg-inline--fa.fa-w-10 {\n  width: 0.625em;\n}\n.svg-inline--fa.fa-w-11 {\n  width: 0.6875em;\n}\n.svg-inline--fa.fa-w-12 {\n  width: 0.75em;\n}\n.svg-inline--fa.fa-w-13 {\n  width: 0.8125em;\n}\n.svg-inline--fa.fa-w-14 {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-15 {\n  width: 0.9375em;\n}\n.svg-inline--fa.fa-w-16 {\n  width: 1em;\n}\n.svg-inline--fa.fa-w-17 {\n  width: 1.0625em;\n}\n.svg-inline--fa.fa-w-18 {\n  width: 1.125em;\n}\n.svg-inline--fa.fa-w-19 {\n  width: 1.1875em;\n}\n.svg-inline--fa.fa-w-20 {\n  width: 1.25em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-border {\n  height: 1.5em;\n}\n.svg-inline--fa.fa-li {\n  width: 2em;\n}\n.svg-inline--fa.fa-fw {\n  width: 1.25em;\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: #ff253a;\n  border-radius: 1em;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  color: #fff;\n  height: 1.5em;\n  line-height: 1;\n  max-width: 5em;\n  min-width: 1.5em;\n  overflow: hidden;\n  padding: 0.25em;\n  right: 0;\n  text-overflow: ellipsis;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: 0;\n  right: 0;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: 0;\n  left: 0;\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  right: 0;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: 0;\n  right: auto;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-lg {\n  font-size: 1.3333333333em;\n  line-height: 0.75em;\n  vertical-align: -0.0667em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: 2.5em;\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: -2em;\n  position: absolute;\n  text-align: center;\n  width: 2em;\n  line-height: inherit;\n}\n\n.fa-border {\n  border: solid 0.08em #eee;\n  border-radius: 0.1em;\n  padding: 0.2em 0.25em 0.15em;\n}\n\n.fa-pull-left {\n  float: left;\n}\n\n.fa-pull-right {\n  float: right;\n}\n\n.fa.fa-pull-left,\n.fas.fa-pull-left,\n.far.fa-pull-left,\n.fal.fa-pull-left,\n.fab.fa-pull-left {\n  margin-right: 0.3em;\n}\n.fa.fa-pull-right,\n.fas.fa-pull-right,\n.far.fa-pull-right,\n.fal.fa-pull-right,\n.fab.fa-pull-right {\n  margin-left: 0.3em;\n}\n\n.fa-spin {\n  -webkit-animation: fa-spin 2s infinite linear;\n          animation: fa-spin 2s infinite linear;\n}\n\n.fa-pulse {\n  -webkit-animation: fa-spin 1s infinite steps(8);\n          animation: fa-spin 1s infinite steps(8);\n}\n\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both, .fa-flip-horizontal.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n:root .fa-rotate-90,\n:root .fa-rotate-180,\n:root .fa-rotate-270,\n:root .fa-flip-horizontal,\n:root .fa-flip-vertical,\n:root .fa-flip-both {\n  -webkit-filter: none;\n          filter: none;\n}\n\n.fa-stack {\n  display: inline-block;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: #fff;\n}\n\n.sr-only {\n  border: 0;\n  clip: rect(0, 0, 0, 0);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n.sr-only-focusable:active, .sr-only-focusable:focus {\n  clip: auto;\n  height: auto;\n  margin: 0;\n  overflow: visible;\n  position: static;\n  width: auto;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse {\n  color: #fff;\n}';if("fa"!==e||n!==t){var i=new RegExp("\\.".concat("fa","\\-"),"g"),o=new RegExp("\\--".concat("fa","\\-"),"g"),a=new RegExp("\\.".concat(t),"g");r=r.replace(i,".".concat(e,"-")).replace(o,"--".concat(e,"-")).replace(a,".".concat(n))}return r}function gt(){_.autoAddCss&&!At&&(q(mt()),At=!0)}function yt(t,e){return Object.defineProperty(t,"abstract",{get:e}),Object.defineProperty(t,"html",{get:function(){return t.abstract.map((function(t){return ut(t)}))}}),Object.defineProperty(t,"node",{get:function(){if(v){var e=g.createElement("div");return e.innerHTML=t.html,e.children}}}),t}function vt(t){var e=t.prefix,n=void 0===e?"fa":e,r=t.iconName;if(r)return st(wt.definitions,n,r)||st(T.styles,n,r)}var bt,wt=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.definitions={}}var e,n,r;return e=t,(n=[{key:"add",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n.reduce(this._pullDefinitions,{});Object.keys(i).forEach((function(e){t.definitions[e]=s({},t.definitions[e]||{},i[e]),rt(e,i[e]),at()}))}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(t,e){var n=e.prefix&&e.iconName&&e.icon?{0:e}:e;return Object.keys(n).map((function(e){var r=n[e],i=r.prefix,o=r.iconName,a=r.icon;t[i]||(t[i]={}),t[i][o]=a})),t}}])&&o(e.prototype,n),r&&o(e,r),t}()),At=!1,Et=(bt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.transform,r=void 0===n?$:n,i=e.symbol,o=void 0!==i&&i,a=e.mask,u=void 0===a?null:a,c=e.title,l=void 0===c?null:c,f=e.classes,h=void 0===f?[]:f,d=e.attributes,p=void 0===d?{}:d,m=e.styles,g=void 0===m?{}:m;if(t){var y=t.prefix,v=t.iconName,b=t.icon;return yt(s({type:"icon"},t),(function(){return gt(),_.autoA11y&&(l?p["aria-labelledby"]="".concat(_.replacementClass,"-title-").concat(X()):(p["aria-hidden"]="true",p.focusable="false")),tt({icons:{main:pt(b),mask:u?pt(u.icon):{found:!1,width:null,height:null,icon:{}}},prefix:y,iconName:v,transform:s({},$,r),symbol:o,title:l,extra:{attributes:p,styles:g,classes:h}})}))}},function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(t||{}).icon?t:vt(t||{}),r=e.mask;return r&&(r=(r||{}).icon?r:vt(r||{})),bt(n,s({},e,{mask:r}))})}).call(this,n(8),n(28).setImmediate)},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return i}));var r=n(0);function i(e,n){const i=n&&n.property?Object(r.g)(n.property):r.i;return!Object(r.n)(e)||(o=e,"function"==typeof t&&Object(r.l)(t.isBuffer)&&t.isBuffer(o))?i(JSON.parse(e)):function(t,e){return e&&e.copy?JSON.parse(JSON.stringify(t)):t}(i(e));var o}i.responseType="json"}).call(this,n(22).Buffer)},function(t,e,n){"use strict";var r=Object.prototype.hasOwnProperty,i="~";function o(){}function a(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function s(t,e,n,r,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new a(n,r||t,o),u=i?i+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],s]:t._events[u].push(s):(t._events[u]=s,t._eventsCount++),t}function u(t,e){0==--t._eventsCount?t._events=new o:delete t._events[e]}function c(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(i=!1)),c.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)r.call(t,e)&&n.push(i?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},c.prototype.listeners=function(t){var e=i?i+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,o=n.length,a=new Array(o);r<o;r++)a[r]=n[r].fn;return a},c.prototype.listenerCount=function(t){var e=i?i+t:t,n=this._events[e];return n?n.fn?1:n.length:0},c.prototype.emit=function(t,e,n,r,o,a){var s=i?i+t:t;if(!this._events[s])return!1;var u,c,l=this._events[s],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,n),!0;case 4:return l.fn.call(l.context,e,n,r),!0;case 5:return l.fn.call(l.context,e,n,r,o),!0;case 6:return l.fn.call(l.context,e,n,r,o,a),!0}for(c=1,u=new Array(f-1);c<f;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var h,d=l.length;for(c=0;c<d;c++)switch(l[c].once&&this.removeListener(t,l[c].fn,void 0,!0),f){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,e);break;case 3:l[c].fn.call(l[c].context,e,n);break;case 4:l[c].fn.call(l[c].context,e,n,r);break;default:if(!u)for(h=1,u=new Array(f-1);h<f;h++)u[h-1]=arguments[h];l[c].fn.apply(l[c].context,u)}}return!0},c.prototype.on=function(t,e,n){return s(this,t,e,n,!1)},c.prototype.once=function(t,e,n){return s(this,t,e,n,!0)},c.prototype.removeListener=function(t,e,n,r){var o=i?i+t:t;if(!this._events[o])return this;if(!e)return u(this,o),this;var a=this._events[o];if(a.fn)a.fn!==e||r&&!a.once||n&&a.context!==n||u(this,o);else{for(var s=0,c=[],l=a.length;s<l;s++)(a[s].fn!==e||r&&!a[s].once||n&&a[s].context!==n)&&c.push(a[s]);c.length?this._events[o]=1===c.length?c[0]:c:u(this,o)}return this},c.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&u(this,e)):(this._events=new o,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=i,c.EventEmitter=c,t.exports=c},function(t,e){t.exports='precision mediump float;\n\n\n// Adapted from luma.gl - https://github.com/uber/luma.gl\n\n// Copyright (c) 2015 - 2017 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the "Software"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nuniform float ONE;\n\n/*\nAbout LUMA_FP64_CODE_ELIMINATION_WORKAROUND\n\nThe purpose of this workaround is to prevent shader compilers from\noptimizing away necessary arithmetic operations by swapping their sequences\nor transform the equation to some \'equivalent\' from.\n\nThe method is to multiply an artifical variable, ONE, which will be known to\nthe compiler to be 1 only at runtime. The whole expression is then represented\nas a polynomial with respective to ONE. In the coefficients of all terms, only one a\nand one b should appear\n\nerr = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE\n*/\n\n// Divide float number to high and low floats to extend fraction bits\nvec2 split(float a) {\n  const float SPLIT = 4097.0;\n  float t = a * SPLIT;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float a_hi = t * ONE - (t - a);\n  float a_lo = a * ONE - a_hi;\n#else\n  float a_hi = t - (t - a);\n  float a_lo = a - a_hi;\n#endif\n  return vec2(a_hi, a_lo);\n}\n\n// Divide float number again when high float uses too many fraction bits\nvec2 split2(vec2 a) {\n  vec2 b = split(a.x);\n  b.y += a.y;\n  return b;\n}\n\n// Special sum operation when a > b\nvec2 quickTwoSum(float a, float b) {\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float sum = (a + b) * ONE;\n  float err = b - (sum - a) * ONE;\n#else\n  float sum = a + b;\n  float err = b - (sum - a);\n#endif\n  return vec2(sum, err);\n}\n\n// General sum operation\nvec2 twoSum(float a, float b) {\n  float s = (a + b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE + (b - v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) + (b - v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSub(float a, float b) {\n  float s = (a - b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE - (b + v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) - (b + v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSqr(float a) {\n  float prod = a * a;\n  vec2 a_fp64 = split(a);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float err = ((a_fp64.x * a_fp64.x - prod) * ONE + 2.0 * a_fp64.x *\n    a_fp64.y * ONE * ONE) + a_fp64.y * a_fp64.y * ONE * ONE * ONE;\n#else\n  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;\n#endif\n  return vec2(prod, err);\n}\n\nvec2 twoProd(float a, float b) {\n  float prod = a * b;\n  vec2 a_fp64 = split(a);\n  vec2 b_fp64 = split(b);\n  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +\n    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;\n  return vec2(prod, err);\n}\n\nvec2 sum_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSum(a.x, b.x);\n  t = twoSum(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 sub_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSub(a.x, b.x);\n  t = twoSub(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 mul_fp64(vec2 a, vec2 b) {\n  vec2 prod = twoProd(a.x, b.x);\n  // y component is for the error\n  prod.y += a.x * b.y;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  prod.y += a.y * b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  return prod;\n}\n\nvec2 div_fp64(vec2 a, vec2 b) {\n  float xn = 1.0 / b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  vec2 yn = mul_fp64(a, vec2(xn, 0));\n#else\n  vec2 yn = a * xn;\n#endif\n  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;\n  vec2 prod = twoProd(xn, diff);\n  return sum_fp64(yn, prod);\n}\n\nvec2 sqrt_fp64(vec2 a) {\n  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n\n  float x = 1.0 / sqrt(a.x);\n  float yn = a.x * x;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  vec2 yn_sqr = twoSqr(yn) * ONE;\n#else\n  vec2 yn_sqr = twoSqr(yn);\n#endif\n  float diff = sub_fp64(a, yn_sqr).x;\n  vec2 prod = twoProd(x * 0.5, diff);\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  return sum_fp64(split(yn), prod);\n#else\n  return sum_fp64(vec2(yn, 0.0), prod);\n#endif\n}\n\n/**\n * When to switch to fp64\n * Note: this hack works with integer genomic coordinates but likely breaks with everything else\n */\nconst float precisionThreshold = 1.0 / (1024.0 * 1024.0 * 8.0);\n\n/**\n * X coordinate of the vertex as fp64 (emulated 64bit floating point)\n */\nattribute highp vec2 x;\n\nuniform highp vec2 uXScale;\nuniform highp vec2 uXTranslate;\n\n/**\n * Post-transformation translation of the vertex on the X axis\n */\nuniform float uXOffset;\n\n/**\n * Does viewport transformation and returns the X coordinate on a normalized [0, 1] scale\n */\n\nfloat normalizeX() {\n    // https://stackoverflow.com/a/47543127\n    const float FLT_MAX =  3.402823466e+38;\n\n    float normalizedX;\n\n    if (x.x <= -FLT_MAX) {\n        // Clamp almost negative infinite to zero (the left edge of the viewport)\n        normalizedX = 0.0;\n\n    } else if (x.x >= FLT_MAX) {\n        // Clamp almost positive infinite to zero (the right edge of the viewport)\n        normalizedX = 1.0;\n\n    } else if (uXScale.x > precisionThreshold) {\n        // Use emulated 64bit floating points\n        normalizedX = sum_fp64(mul_fp64(x, uXScale), uXTranslate).x;\n\n    } else {\n        // 32bit floats provide enough precision are enough\n        normalizedX = x.x * uXScale.x + uXTranslate.x;\n    }\n\n    return normalizedX + uXOffset;\n}\n\nuniform highp float uYScale;\nuniform highp float uYTranslate;\n\nuniform float uYOffset;\n\nattribute highp float y;\n\n/**\n * Does viewport (track) transformation and returns the Y coordinate on normalized [0, 1] scale\n */\nfloat normalizeY() {\n    // https://stackoverflow.com/a/47543127\n    const float FLT_MAX =  3.402823466e+38;\n\n    if (y <= -FLT_MAX) {\n        return 0.0;\n    } else if (y >= FLT_MAX) {\n        return 1.0;\n    } else {\n        return y * uYScale + uYTranslate + uYOffset;\n    }\n}\n/**\n * Width of the rectangle.\n *\n * Negative if the leftmost vertex,\n * positive if rightmost vertex,\n * zero if in the middle.\n */\nattribute float width;\n\n/** Minimum width of the displayed rectangle in normalized [0, 1] coordinates */\nuniform float uMinWidth;\n\n/** Minimum rect opacity when the rect is narrower than the minimum width */\nuniform float uMinOpacity;\n\n\nfloat applyMinWidth(inout float normalizedX) {\n    float opacity = 1.0;\n\n    if (width != 0.0) {\n        float normalizedWidth = width * uXScale.x;\n        if (abs(normalizedWidth) < uMinWidth) {\n            // The rectangle is too narrow, stretch it to make it more visible\n            normalizedX += (uMinWidth * sign(width) - normalizedWidth) / 2.0;\n            opacity = max(abs(normalizedWidth) / uMinWidth, uMinOpacity);\n        }\n    }\n\n    return opacity;\n}\n\n\n/**\n * Location and height of the band on the Y axis on a normalized [0, 1] scale.\n * Top as the first element, height as the second element.\n */\nuniform vec2 yPosLeft;\nuniform vec2 yPosRight;\n\nuniform float transitionOffset;\n\nvec2 transit(float normalizedX, float y) {\n    float top, height;\n\n    if (yPosLeft == yPosRight) {\n        // Left and right are the same, no bending\n        top = yPosLeft[0];\n        height = yPosLeft[1];\n\n    } else {\n        float fraction = smoothstep(0.0, 0.7 + transitionOffset, (normalizedX - transitionOffset) * 2.0);\n        vec2 interpolated = mix(yPosLeft, yPosRight, fraction);\n        top = interpolated[0];\n        height = interpolated[1];\n    }\n\n    return vec2(top + y * height, height);\n}\n\nattribute vec3 color;\nattribute lowp float opacity;\n\n/**\n * Height of the rectangle.\n *\n * Negative if the top vertex, positive if the bottom vertex.\n */\nattribute float height;\n\n/** Minimum height of the displayed rectangle in normalized [0, 1] coordinates */\nuniform float uMinHeight;\n\nvarying vec4 vColor;\n\n\nfloat applyMinHeight(float normalizedY) {\n    if (height != 0.0) {\n        float normalizedHeight = height * uYScale * yPosLeft[1]; // TODO: Fix: Broken inside transition!\n        if (abs(normalizedHeight) < uMinHeight) {\n            normalizedY += (uMinHeight * sign(height) - normalizedHeight) / 2.0;\n        }\n    }\n\n    return normalizedY;\n}\n\nvoid main(void) {\n    float normalizedX = normalizeX();\n    float normalizedY = normalizeY();\n    \n    float opa = opacity * applyMinWidth(normalizedX);\n\n    float translatedY = transit(normalizedX, 1.0 - normalizedY)[0];\n\n    translatedY = applyMinHeight(translatedY);\n\n    vec2 ndc = vec2(normalizedX, 1.0 - translatedY) * 2.0 - 1.0;\n\n    gl_Position = vec4(ndc, 0.0, 1.0);\n    vColor = vec4(color * opa, opa);\n}\n'},,,,function(t,e){t.exports='precision mediump float;\n\n\n// Adapted from luma.gl - https://github.com/uber/luma.gl\n\n// Copyright (c) 2015 - 2017 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the "Software"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nuniform float ONE;\n\n/*\nAbout LUMA_FP64_CODE_ELIMINATION_WORKAROUND\n\nThe purpose of this workaround is to prevent shader compilers from\noptimizing away necessary arithmetic operations by swapping their sequences\nor transform the equation to some \'equivalent\' from.\n\nThe method is to multiply an artifical variable, ONE, which will be known to\nthe compiler to be 1 only at runtime. The whole expression is then represented\nas a polynomial with respective to ONE. In the coefficients of all terms, only one a\nand one b should appear\n\nerr = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE\n*/\n\n// Divide float number to high and low floats to extend fraction bits\nvec2 split(float a) {\n  const float SPLIT = 4097.0;\n  float t = a * SPLIT;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float a_hi = t * ONE - (t - a);\n  float a_lo = a * ONE - a_hi;\n#else\n  float a_hi = t - (t - a);\n  float a_lo = a - a_hi;\n#endif\n  return vec2(a_hi, a_lo);\n}\n\n// Divide float number again when high float uses too many fraction bits\nvec2 split2(vec2 a) {\n  vec2 b = split(a.x);\n  b.y += a.y;\n  return b;\n}\n\n// Special sum operation when a > b\nvec2 quickTwoSum(float a, float b) {\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float sum = (a + b) * ONE;\n  float err = b - (sum - a) * ONE;\n#else\n  float sum = a + b;\n  float err = b - (sum - a);\n#endif\n  return vec2(sum, err);\n}\n\n// General sum operation\nvec2 twoSum(float a, float b) {\n  float s = (a + b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE + (b - v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) + (b - v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSub(float a, float b) {\n  float s = (a - b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE - (b + v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) - (b + v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSqr(float a) {\n  float prod = a * a;\n  vec2 a_fp64 = split(a);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float err = ((a_fp64.x * a_fp64.x - prod) * ONE + 2.0 * a_fp64.x *\n    a_fp64.y * ONE * ONE) + a_fp64.y * a_fp64.y * ONE * ONE * ONE;\n#else\n  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;\n#endif\n  return vec2(prod, err);\n}\n\nvec2 twoProd(float a, float b) {\n  float prod = a * b;\n  vec2 a_fp64 = split(a);\n  vec2 b_fp64 = split(b);\n  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +\n    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;\n  return vec2(prod, err);\n}\n\nvec2 sum_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSum(a.x, b.x);\n  t = twoSum(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 sub_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSub(a.x, b.x);\n  t = twoSub(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 mul_fp64(vec2 a, vec2 b) {\n  vec2 prod = twoProd(a.x, b.x);\n  // y component is for the error\n  prod.y += a.x * b.y;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  prod.y += a.y * b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  return prod;\n}\n\nvec2 div_fp64(vec2 a, vec2 b) {\n  float xn = 1.0 / b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  vec2 yn = mul_fp64(a, vec2(xn, 0));\n#else\n  vec2 yn = a * xn;\n#endif\n  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;\n  vec2 prod = twoProd(xn, diff);\n  return sum_fp64(yn, prod);\n}\n\nvec2 sqrt_fp64(vec2 a) {\n  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n\n  float x = 1.0 / sqrt(a.x);\n  float yn = a.x * x;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  vec2 yn_sqr = twoSqr(yn) * ONE;\n#else\n  vec2 yn_sqr = twoSqr(yn);\n#endif\n  float diff = sub_fp64(a, yn_sqr).x;\n  vec2 prod = twoProd(x * 0.5, diff);\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  return sum_fp64(split(yn), prod);\n#else\n  return sum_fp64(vec2(yn, 0.0), prod);\n#endif\n}\n\n/**\n * When to switch to fp64\n * Note: this hack works with integer genomic coordinates but likely breaks with everything else\n */\nconst float precisionThreshold = 1.0 / (1024.0 * 1024.0 * 8.0);\n\n/**\n * X coordinate of the vertex as fp64 (emulated 64bit floating point)\n */\nattribute highp vec2 x;\n\nuniform highp vec2 uXScale;\nuniform highp vec2 uXTranslate;\n\n/**\n * Post-transformation translation of the vertex on the X axis\n */\nuniform float uXOffset;\n\n/**\n * Does viewport transformation and returns the X coordinate on a normalized [0, 1] scale\n */\n\nfloat normalizeX() {\n    // https://stackoverflow.com/a/47543127\n    const float FLT_MAX =  3.402823466e+38;\n\n    float normalizedX;\n\n    if (x.x <= -FLT_MAX) {\n        // Clamp almost negative infinite to zero (the left edge of the viewport)\n        normalizedX = 0.0;\n\n    } else if (x.x >= FLT_MAX) {\n        // Clamp almost positive infinite to zero (the right edge of the viewport)\n        normalizedX = 1.0;\n\n    } else if (uXScale.x > precisionThreshold) {\n        // Use emulated 64bit floating points\n        normalizedX = sum_fp64(mul_fp64(x, uXScale), uXTranslate).x;\n\n    } else {\n        // 32bit floats provide enough precision are enough\n        normalizedX = x.x * uXScale.x + uXTranslate.x;\n    }\n\n    return normalizedX + uXOffset;\n}\n\nuniform highp float uYScale;\nuniform highp float uYTranslate;\n\nuniform float uYOffset;\n\nattribute highp float y;\n\n/**\n * Does viewport (track) transformation and returns the Y coordinate on normalized [0, 1] scale\n */\nfloat normalizeY() {\n    // https://stackoverflow.com/a/47543127\n    const float FLT_MAX =  3.402823466e+38;\n\n    if (y <= -FLT_MAX) {\n        return 0.0;\n    } else if (y >= FLT_MAX) {\n        return 1.0;\n    } else {\n        return y * uYScale + uYTranslate + uYOffset;\n    }\n}\n\n/**\n * Location and height of the band on the Y axis on a normalized [0, 1] scale.\n * Top as the first element, height as the second element.\n */\nuniform vec2 yPosLeft;\nuniform vec2 yPosRight;\n\nuniform float transitionOffset;\n\nvec2 transit(float normalizedX, float y) {\n    float top, height;\n\n    if (yPosLeft == yPosRight) {\n        // Left and right are the same, no bending\n        top = yPosLeft[0];\n        height = yPosLeft[1];\n\n    } else {\n        float fraction = smoothstep(0.0, 0.7 + transitionOffset, (normalizedX - transitionOffset) * 2.0);\n        vec2 interpolated = mix(yPosLeft, yPosRight, fraction);\n        top = interpolated[0];\n        height = interpolated[1];\n    }\n\n    return vec2(top + y * height, height);\n}\n\nattribute lowp vec3 color;\nattribute lowp float opacity;\nattribute float size; // Diameter or width/height\nattribute lowp float shape;\nattribute lowp float strokeWidth;\nattribute float zoomThreshold;\nattribute lowp float gradientStrength;\n\nuniform float uViewportHeight;\nuniform lowp float uDevicePixelRatio;\n\n/** Maximum size of the largest point as the fraction of the height of the (faceted) view */\nuniform lowp float uMaxRelativePointDiameter;\n/** Minimum width/height in pixels of the largest point */\nuniform lowp float uMinAbsolutePointDiameter;\n\n/** Scale factor for geometric zoom */\nuniform float uScaleFactor;\n\n/** The size of the largest point in the data */\nuniform float uMaxPointSize;\n\nuniform float zoomLevel;\nuniform float fractionToShow;\n\nvarying float vSize;\nvarying lowp vec4 vColor;\nvarying lowp float vShape;\nvarying lowp float vStrokeWidth;\nvarying lowp float vGradientStrength;\n\n\nfloat computeThresholdFactor() {\n    float margin = zoomLevel * 0.005;\n    return 1.0 - smoothstep(zoomThreshold, zoomThreshold + margin, 1.0 - zoomLevel * fractionToShow);\n}\n\n/**\n * Computes a scaling factor for the points.\n * To some extent, this could be done in JavaScript and passed as uniform.\n * It would consume more cpu cycles, though.\n */\nfloat scaleDown(float bandHeight) {\n    float maxPointDiameter = sqrt(uMaxPointSize);\n    // TODO: Optimize: we first divide by DPR here and later multiply by it\n    float factor = bandHeight * uMaxRelativePointDiameter / uDevicePixelRatio;\n\n    // Points should not be visible on zero-height bands. Using smoothstep to hide them.\n    float minimum = smoothstep(0.0, 0.5, bandHeight) * uMinAbsolutePointDiameter / uDevicePixelRatio;\n\n    return max(minimum, min(maxPointDiameter, factor)) / maxPointDiameter;\n}\n\nvoid main(void) {\n\n    float normalizedX = normalizeX();\n\n    vec2 translated = transit(normalizedX, (1.0 - normalizeY()));\n    float translatedY = translated[0];\n    float height = translated[1];\n\n    vec2 ndc = vec2(normalizedX, 1.0 - translatedY) * 2.0 - 1.0;\n\n    gl_Position = vec4(ndc, 0.0, 1.0);\n\n    float thresholdFactor = computeThresholdFactor();\n\n    vSize = sqrt(size) *\n        uScaleFactor *\n        scaleDown(height * uViewportHeight) *\n        thresholdFactor *\n        uDevicePixelRatio;\n\n    // Clamp minimum size and adjust opacity instead. Yields more pleasing result,\n    // no flickering etc.\n    float opa;\n    const float sizeLimit = 2.0;\n    if (vSize < sizeLimit) {\n        // We do some "cheap" gamma correction here. It breaks on dark background, though.\n        // First we take a square of the size and then apply "gamma" of 1.5.\n        opa = opacity * pow(vSize / sizeLimit, 2.5);\n        vSize = sizeLimit;\n    } else {\n        opa = opacity;\n    }\n\n    gl_PointSize = vSize;\n\n    vColor = vec4(color, opa * thresholdFactor);\n    vShape = shape;\n    vStrokeWidth = strokeWidth;\n    vGradientStrength = gradientStrength;\n}\n'},function(t,e){t.exports="precision mediump float;\n\nconst lowp vec3 white = vec3(1.0);\nconst lowp vec3 black = vec3(0.0);\n\nuniform lowp float uDevicePixelRatio;\n\nvarying lowp vec4 vColor;\nvarying float vSize;\nvarying lowp float vShape;\nvarying lowp float vStrokeWidth;\nvarying lowp float vGradientStrength;\n\nconst float CIRCLE = 0.0;\nconst float SQUARE = 1.0;\nconst float TRIANGLE_UP = 2.0;\nconst float CROSS = 3.0;\nconst float DIAMOND = 4.0;\nconst float TRIANGLE_DOWN = 5.0;\nconst float TRIANGLE_RIGHT = 6.0;\nconst float TRIANGLE_LEFT = 7.0;\n\n/** Normalized point coord */\nvec2 npc() {\n    return gl_PointCoord * 2.0 - 1.0;\n}\n\nfloat circle() {\n    return length(npc()) - 1.0;\n}\n\nfloat square() {\n    vec2 pos = abs(npc());\n    return max(pos.x, pos.y) - 1.0;\n}\n\n// Triangle, cross, and diamond are based on:\n// http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm\n\nfloat sdEquilateralTriangle(bool flip, bool swap) {\n    vec2 p = npc();\n    if (swap) {\n        p.xy = p.yx;\n    }\n    if (flip) {\n        p.y = -p.y;\n    }\n    p.y += 0.25;\n\n    const float k = sqrt(3.0);\n    p.x = abs(p.x) - 1.0;\n    p.y = p.y + 1.0 / k;\n    if (p.x + k * p.y > 0.) {\n        p = vec2(p.x - k * p.y, -k * p.x - p.y) / 2.;\n    }\n    p.x -= clamp(p.x, -2.0, 0.0);\n    return -length(p) * sign(p.y);\n}\n\n\nfloat sdCross() {\n    const float r = 0.0;\n    const vec2 b = vec2(1.0, 0.4);\n\n    vec2 p = abs(npc());\n    p = (p.y > p.x) ? p.yx : p.xy;\n    vec2  q = p - b;\n    float k = max(q.y, q.x);\n    vec2  w = (k > 0.0) ? q : vec2(b.y - p.x, -k);\n    return sign(k) * length(max(w, 0.0)) + r;\n}\n\nfloat ndot(vec2 a, vec2 b) {\n    return a.x * b.x - a.y * b.y;\n}\n\nfloat sdRhombus() {\n    const vec2 b = vec2(1.0);\n\n    vec2 q = abs(npc());\n    float h = clamp((-2.0 * ndot(q, b) + ndot(b, b)) / dot(b, b), -1.0, 1.0);\n    float d = length(q - 0.5 * b * vec2(1.0 - h, 1.0 + h));\n    return d * sign(q.x * b.y + q.y * b.x - b.x * b.y);\n}\n\nvoid main() {\n    float dist;\n    \n    // We could also use textures here. Could even be faster, because we have plenty of branching here.\n    if (vShape == CIRCLE) {\n        dist = circle();\n\n    } else if (vShape == SQUARE) {\n        dist = square();\n\n    } else if (vShape == TRIANGLE_UP) {\n        dist = sdEquilateralTriangle(true, false);\n\n    } else if (vShape == CROSS) {\n        dist = sdCross();\n\n    } else if (vShape == DIAMOND) {\n        dist = sdRhombus();\n\n    } else if (vShape == TRIANGLE_DOWN) {\n        dist = sdEquilateralTriangle(false, false);\n\n    } else if (vShape == TRIANGLE_RIGHT) {\n        dist = sdEquilateralTriangle(false, true);\n\n    } else if (vShape == TRIANGLE_LEFT) {\n        dist = sdEquilateralTriangle(true, true);\n\n    } else {\n        dist = 0.0;\n    }\n\n    if (dist > 0.3)\n        discard;\n\n    lowp vec3 strokeColor = mix(vColor.rgb, black, 0.3); \n    // Stuble radial gradient\n    lowp vec3 fillColor = mix(vColor.rgb, white, -dist * vGradientStrength);\n\n    // Could use fwidth here, but GL_OES_standard_derivatives is not always available\n    float pixelWidth = 2.0 / vSize;\n\n    if (vStrokeWidth > 0.0) {\n        float strokeWidth = vStrokeWidth * uDevicePixelRatio * pixelWidth; // TODO: Move computation to vertex shader\n\n        lowp float strokeFraction = smoothstep(-strokeWidth, -strokeWidth - pixelWidth, dist);\n        lowp float alpha = smoothstep(0., -pixelWidth, dist) * vColor.a;\n\n        gl_FragColor = vec4(mix(strokeColor, fillColor, strokeFraction) * alpha, alpha);\n\n    } else {\n        lowp float alpha = smoothstep(0., -pixelWidth, dist) * vColor.a;\n\n        gl_FragColor = vec4(fillColor * alpha, alpha);\n    }\n}\n\n"},function(t,e){t.exports='precision mediump float;\n\n\n// Adapted from luma.gl - https://github.com/uber/luma.gl\n\n// Copyright (c) 2015 - 2017 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the "Software"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nuniform float ONE;\n\n/*\nAbout LUMA_FP64_CODE_ELIMINATION_WORKAROUND\n\nThe purpose of this workaround is to prevent shader compilers from\noptimizing away necessary arithmetic operations by swapping their sequences\nor transform the equation to some \'equivalent\' from.\n\nThe method is to multiply an artifical variable, ONE, which will be known to\nthe compiler to be 1 only at runtime. The whole expression is then represented\nas a polynomial with respective to ONE. In the coefficients of all terms, only one a\nand one b should appear\n\nerr = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE\n*/\n\n// Divide float number to high and low floats to extend fraction bits\nvec2 split(float a) {\n  const float SPLIT = 4097.0;\n  float t = a * SPLIT;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float a_hi = t * ONE - (t - a);\n  float a_lo = a * ONE - a_hi;\n#else\n  float a_hi = t - (t - a);\n  float a_lo = a - a_hi;\n#endif\n  return vec2(a_hi, a_lo);\n}\n\n// Divide float number again when high float uses too many fraction bits\nvec2 split2(vec2 a) {\n  vec2 b = split(a.x);\n  b.y += a.y;\n  return b;\n}\n\n// Special sum operation when a > b\nvec2 quickTwoSum(float a, float b) {\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float sum = (a + b) * ONE;\n  float err = b - (sum - a) * ONE;\n#else\n  float sum = a + b;\n  float err = b - (sum - a);\n#endif\n  return vec2(sum, err);\n}\n\n// General sum operation\nvec2 twoSum(float a, float b) {\n  float s = (a + b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE + (b - v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) + (b - v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSub(float a, float b) {\n  float s = (a - b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE - (b + v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) - (b + v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSqr(float a) {\n  float prod = a * a;\n  vec2 a_fp64 = split(a);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float err = ((a_fp64.x * a_fp64.x - prod) * ONE + 2.0 * a_fp64.x *\n    a_fp64.y * ONE * ONE) + a_fp64.y * a_fp64.y * ONE * ONE * ONE;\n#else\n  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;\n#endif\n  return vec2(prod, err);\n}\n\nvec2 twoProd(float a, float b) {\n  float prod = a * b;\n  vec2 a_fp64 = split(a);\n  vec2 b_fp64 = split(b);\n  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +\n    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;\n  return vec2(prod, err);\n}\n\nvec2 sum_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSum(a.x, b.x);\n  t = twoSum(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 sub_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSub(a.x, b.x);\n  t = twoSub(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 mul_fp64(vec2 a, vec2 b) {\n  vec2 prod = twoProd(a.x, b.x);\n  // y component is for the error\n  prod.y += a.x * b.y;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  prod.y += a.y * b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  return prod;\n}\n\nvec2 div_fp64(vec2 a, vec2 b) {\n  float xn = 1.0 / b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  vec2 yn = mul_fp64(a, vec2(xn, 0));\n#else\n  vec2 yn = a * xn;\n#endif\n  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;\n  vec2 prod = twoProd(xn, diff);\n  return sum_fp64(yn, prod);\n}\n\nvec2 sqrt_fp64(vec2 a) {\n  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n\n  float x = 1.0 / sqrt(a.x);\n  float yn = a.x * x;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  vec2 yn_sqr = twoSqr(yn) * ONE;\n#else\n  vec2 yn_sqr = twoSqr(yn);\n#endif\n  float diff = sub_fp64(a, yn_sqr).x;\n  vec2 prod = twoProd(x * 0.5, diff);\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  return sum_fp64(split(yn), prod);\n#else\n  return sum_fp64(vec2(yn, 0.0), prod);\n#endif\n}\n\n/**\n * When to switch to fp64\n * Note: this hack works with integer genomic coordinates but likely breaks with everything else\n */\nconst float precisionThreshold = 1.0 / (1024.0 * 1024.0 * 8.0);\n\n/**\n * X coordinate of the vertex as fp64 (emulated 64bit floating point)\n */\nattribute highp vec2 x;\n\nuniform highp vec2 uXScale;\nuniform highp vec2 uXTranslate;\n\n/**\n * Post-transformation translation of the vertex on the X axis\n */\nuniform float uXOffset;\n\n/**\n * Does viewport transformation and returns the X coordinate on a normalized [0, 1] scale\n */\n\nfloat normalizeX() {\n    // https://stackoverflow.com/a/47543127\n    const float FLT_MAX =  3.402823466e+38;\n\n    float normalizedX;\n\n    if (x.x <= -FLT_MAX) {\n        // Clamp almost negative infinite to zero (the left edge of the viewport)\n        normalizedX = 0.0;\n\n    } else if (x.x >= FLT_MAX) {\n        // Clamp almost positive infinite to zero (the right edge of the viewport)\n        normalizedX = 1.0;\n\n    } else if (uXScale.x > precisionThreshold) {\n        // Use emulated 64bit floating points\n        normalizedX = sum_fp64(mul_fp64(x, uXScale), uXTranslate).x;\n\n    } else {\n        // 32bit floats provide enough precision are enough\n        normalizedX = x.x * uXScale.x + uXTranslate.x;\n    }\n\n    return normalizedX + uXOffset;\n}\n\nattribute float y;\nattribute float yEdge;\n\nuniform mat4 uTMatrix;\n\nvarying float vYPos;\n\nvoid main(void) {\n    float normalizedX = normalizeX();\n\n    gl_Position = uTMatrix * vec4(normalizedX, y, 0.0, 1.0);\n\n    vYPos = yEdge;\n}'},function(t,e){t.exports="/*\n * This shader renders the gene backbone (mid-line) and arrows that indicate\n * the reading direction (strand).\n */\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying float vYPos;\n\nuniform float uResolution; //  = 15.0; // TODO: Pass as a uniform\n\nconst float arrowSpacing = 2.0;\nconst float arrowWidth = 0.5;\nconst float arrowOpacity = 0.6;\n\nconst float direction = -1.0;\n\n\nvoid main() {\n    float backboneWidth = 1.0 / uResolution;\n    float arrowThickness = 0.9 / (arrowSpacing * uResolution);\n\n    vec2 st = gl_FragCoord.xy / uResolution;\n\n    //float c = arrowOpacity * step(abs(vYPos - 0.5) * 2.0, arrowWidth) *\n    //    step(mod(st.x + abs(vYPos - 0.5) * direction, arrowSpacing) / arrowSpacing, arrowThickness);\n    float c = 0.0;\n    \n    c += step(abs(vYPos - 0.5) * 2.0, backboneWidth);\n    \n    c = min(c, 1.0);\n\n    gl_FragColor = vec4(vec3(0.0), c);\n}"},function(t,e){t.exports='\nprecision mediump float;\n\n\n// Adapted from luma.gl - https://github.com/uber/luma.gl\n\n// Copyright (c) 2015 - 2017 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the "Software"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nuniform float ONE;\n\n/*\nAbout LUMA_FP64_CODE_ELIMINATION_WORKAROUND\n\nThe purpose of this workaround is to prevent shader compilers from\noptimizing away necessary arithmetic operations by swapping their sequences\nor transform the equation to some \'equivalent\' from.\n\nThe method is to multiply an artifical variable, ONE, which will be known to\nthe compiler to be 1 only at runtime. The whole expression is then represented\nas a polynomial with respective to ONE. In the coefficients of all terms, only one a\nand one b should appear\n\nerr = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE\n*/\n\n// Divide float number to high and low floats to extend fraction bits\nvec2 split(float a) {\n  const float SPLIT = 4097.0;\n  float t = a * SPLIT;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float a_hi = t * ONE - (t - a);\n  float a_lo = a * ONE - a_hi;\n#else\n  float a_hi = t - (t - a);\n  float a_lo = a - a_hi;\n#endif\n  return vec2(a_hi, a_lo);\n}\n\n// Divide float number again when high float uses too many fraction bits\nvec2 split2(vec2 a) {\n  vec2 b = split(a.x);\n  b.y += a.y;\n  return b;\n}\n\n// Special sum operation when a > b\nvec2 quickTwoSum(float a, float b) {\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float sum = (a + b) * ONE;\n  float err = b - (sum - a) * ONE;\n#else\n  float sum = a + b;\n  float err = b - (sum - a);\n#endif\n  return vec2(sum, err);\n}\n\n// General sum operation\nvec2 twoSum(float a, float b) {\n  float s = (a + b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE + (b - v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) + (b - v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSub(float a, float b) {\n  float s = (a - b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE - (b + v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) - (b + v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSqr(float a) {\n  float prod = a * a;\n  vec2 a_fp64 = split(a);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float err = ((a_fp64.x * a_fp64.x - prod) * ONE + 2.0 * a_fp64.x *\n    a_fp64.y * ONE * ONE) + a_fp64.y * a_fp64.y * ONE * ONE * ONE;\n#else\n  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;\n#endif\n  return vec2(prod, err);\n}\n\nvec2 twoProd(float a, float b) {\n  float prod = a * b;\n  vec2 a_fp64 = split(a);\n  vec2 b_fp64 = split(b);\n  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +\n    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;\n  return vec2(prod, err);\n}\n\nvec2 sum_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSum(a.x, b.x);\n  t = twoSum(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 sub_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSub(a.x, b.x);\n  t = twoSub(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 mul_fp64(vec2 a, vec2 b) {\n  vec2 prod = twoProd(a.x, b.x);\n  // y component is for the error\n  prod.y += a.x * b.y;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  prod.y += a.y * b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  return prod;\n}\n\nvec2 div_fp64(vec2 a, vec2 b) {\n  float xn = 1.0 / b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  vec2 yn = mul_fp64(a, vec2(xn, 0));\n#else\n  vec2 yn = a * xn;\n#endif\n  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;\n  vec2 prod = twoProd(xn, diff);\n  return sum_fp64(yn, prod);\n}\n\nvec2 sqrt_fp64(vec2 a) {\n  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n\n  float x = 1.0 / sqrt(a.x);\n  float yn = a.x * x;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  vec2 yn_sqr = twoSqr(yn) * ONE;\n#else\n  vec2 yn_sqr = twoSqr(yn);\n#endif\n  float diff = sub_fp64(a, yn_sqr).x;\n  vec2 prod = twoProd(x * 0.5, diff);\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  return sum_fp64(split(yn), prod);\n#else\n  return sum_fp64(vec2(yn, 0.0), prod);\n#endif\n}\n\n/**\n * When to switch to fp64\n * Note: this hack works with integer genomic coordinates but likely breaks with everything else\n */\nconst float precisionThreshold = 1.0 / (1024.0 * 1024.0 * 8.0);\n\n/**\n * X coordinate of the vertex as fp64 (emulated 64bit floating point)\n */\nattribute highp vec2 x;\n\nuniform highp vec2 uXScale;\nuniform highp vec2 uXTranslate;\n\n/**\n * Post-transformation translation of the vertex on the X axis\n */\nuniform float uXOffset;\n\n/**\n * Does viewport transformation and returns the X coordinate on a normalized [0, 1] scale\n */\n\nfloat normalizeX() {\n    // https://stackoverflow.com/a/47543127\n    const float FLT_MAX =  3.402823466e+38;\n\n    float normalizedX;\n\n    if (x.x <= -FLT_MAX) {\n        // Clamp almost negative infinite to zero (the left edge of the viewport)\n        normalizedX = 0.0;\n\n    } else if (x.x >= FLT_MAX) {\n        // Clamp almost positive infinite to zero (the right edge of the viewport)\n        normalizedX = 1.0;\n\n    } else if (uXScale.x > precisionThreshold) {\n        // Use emulated 64bit floating points\n        normalizedX = sum_fp64(mul_fp64(x, uXScale), uXTranslate).x;\n\n    } else {\n        // 32bit floats provide enough precision are enough\n        normalizedX = x.x * uXScale.x + uXTranslate.x;\n    }\n\n    return normalizedX + uXOffset;\n}\n\nuniform highp float uYScale;\nuniform highp float uYTranslate;\n\nuniform float uYOffset;\n\nattribute highp float y;\n\n/**\n * Does viewport (track) transformation and returns the Y coordinate on normalized [0, 1] scale\n */\nfloat normalizeY() {\n    // https://stackoverflow.com/a/47543127\n    const float FLT_MAX =  3.402823466e+38;\n\n    if (y <= -FLT_MAX) {\n        return 0.0;\n    } else if (y >= FLT_MAX) {\n        return 1.0;\n    } else {\n        return y * uYScale + uYTranslate + uYOffset;\n    }\n}\n/**\n * Width of the rectangle.\n *\n * Negative if the leftmost vertex,\n * positive if rightmost vertex,\n * zero if in the middle.\n */\nattribute float width;\n\n/** Minimum width of the displayed rectangle in normalized [0, 1] coordinates */\nuniform float uMinWidth;\n\n/** Minimum rect opacity when the rect is narrower than the minimum width */\nuniform float uMinOpacity;\n\n\nfloat applyMinWidth(inout float normalizedX) {\n    float opacity = 1.0;\n\n    if (width != 0.0) {\n        float normalizedWidth = width * uXScale.x;\n        if (abs(normalizedWidth) < uMinWidth) {\n            // The rectangle is too narrow, stretch it to make it more visible\n            normalizedX += (uMinWidth * sign(width) - normalizedWidth) / 2.0;\n            opacity = max(abs(normalizedWidth) / uMinWidth, uMinOpacity);\n        }\n    }\n\n    return opacity;\n}\n\n\n//attribute float y;\n\nuniform mat4 uTMatrix;\n\n/** Minimum exon width when rendering */\nuniform vec3 uColor;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n    \n    float normalizedX = normalizeX();\n    float opacity = applyMinWidth(normalizedX);\n\n    gl_Position = uTMatrix * vec4(normalizedX, y, 0.0, 1.0);\n\n    vColor = vec4(uColor, opacity);\n}'},,function(t,e,n){},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n(23),i=n(24),o=n(25);function a(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(a()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return f(this,t)}return c(this,t,e,n)}function c(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=h(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(e,n),i=(t=s(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(u.isBuffer(e)){var n=0|d(e.length);return 0===(t=s(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?s(t,0):h(t,e);if("Buffer"===e.type&&o(e.data))return h(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function f(t,e){if(l(e),t=s(t,e<0?0:0|d(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function h(t,e){var n=e.length<0?0:0|d(e.length);t=s(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function d(t){if(t>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function p(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return W(t).length;default:if(r)return U(t).length;e=(""+e).toLowerCase(),r=!0}}function m(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return M(this,e,n);case"utf8":case"utf-8":return T(this,e,n);case"ascii":return O(this,e,n);case"latin1":case"binary":return S(this,e,n);case"base64":return C(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function g(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function y(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:v(t,e,n,r,i);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):v(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(t,e,n,r,i){var o,a=1,s=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;a=2,s/=2,u/=2,n/=2}function c(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(i){var l=-1;for(o=n;o<s;o++)if(c(t,o)===c(e,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(n+u>s&&(n=s-u),o=n;o>=0;o--){for(var f=!0,h=0;h<u;h++)if(c(t,o+h)!==c(e,h)){f=!1;break}if(f)return o}return-1}function b(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[n+a]=s}return a}function w(t,e,n,r){return j(U(e,t.length-n),t,n,r)}function A(t,e,n,r){return j(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function E(t,e,n,r){return A(t,e,n,r)}function x(t,e,n,r){return j(W(e),t,n,r)}function _(t,e,n,r){return j(function(t,e){for(var n,r,i,o=[],a=0;a<t.length&&!((e-=2)<0);++a)n=t.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function C(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function T(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,a,s,u,c=t[i],l=null,f=c>239?4:c>223?3:c>191?2:1;if(i+f<=n)switch(f){case 1:c<128&&(l=c);break;case 2:128==(192&(o=t[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&(u=(15&c)<<12|(63&o)<<6|63&a)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(u=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,f=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=f}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=4096));return n}(r)}e.Buffer=u,e.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=a(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return c(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,n){return function(t,e,n,r){return l(e),e<=0?s(t,e):void 0!==n?"string"==typeof r?s(t,e).fill(n,r):s(t,e).fill(n):s(t,e)}(null,t,e,n)},u.allocUnsafe=function(t){return f(null,t)},u.allocUnsafeSlow=function(t){return f(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var a=t[n];if(!u.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?T(this,0,t):m.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,i){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(e>>>=0),s=Math.min(o,a),c=this.slice(r,i),l=t.slice(e,n),f=0;f<s;++f)if(c[f]!==l[f]){o=c[f],a=l[f];break}return o<a?-1:a<o?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return y(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return y(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return b(this,t,e,n);case"utf8":case"utf-8":return w(this,t,e,n);case"ascii":return A(this,t,e,n);case"latin1":case"binary":return E(this,t,e,n);case"base64":return x(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function O(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function S(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function M(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=z(t[o]);return i}function k(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function D(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function F(t,e,n,r,i,o){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function N(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function I(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function R(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(t,e,n,r,o){return o||R(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function L(t,e,n,r,o){return o||R(t,0,n,8),i.write(t,e,n,r,52,8),n+8}u.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var i=e-t;n=new u(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},u.prototype.readUInt8=function(t,e){return e||D(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||D(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||D(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||D(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||D(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},u.prototype.readInt8=function(t,e){return e||D(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||D(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||D(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return e||D(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||D(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||D(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||D(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||D(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||D(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||F(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||F(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):N(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):N(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):I(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):I(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);F(this,t,e,n,i-1,-i)}var o=0,a=1,s=0;for(this[e]=255&t;++o<n&&(a*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);F(this,t,e,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[e+o]=255&t;--o>=0&&(a*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):N(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):N(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):I(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):I(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return B(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return B(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return L(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return L(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var a=u.isBuffer(t)?t:U(new u(t,r).toString()),s=a.length;for(o=0;o<n-e;++o)this[o+e]=a[o%s]}return this};var P=/[^+\/0-9A-Za-z-_]/g;function z(t){return t<16?"0"+t.toString(16):t.toString(16)}function U(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],a=0;a<r;++a){if((n=t.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function W(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(P,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function j(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(8))},function(t,e,n){"use strict";e.byteLength=function(t){var e=c(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,n,r=c(t),a=r[0],s=r[1],u=new o(function(t,e,n){return 3*(e+n)/4-n}(0,a,s)),l=0,f=s>0?a-4:a;for(n=0;n<f;n+=4)e=i[t.charCodeAt(n)]<<18|i[t.charCodeAt(n+1)]<<12|i[t.charCodeAt(n+2)]<<6|i[t.charCodeAt(n+3)],u[l++]=e>>16&255,u[l++]=e>>8&255,u[l++]=255&e;2===s&&(e=i[t.charCodeAt(n)]<<2|i[t.charCodeAt(n+1)]>>4,u[l++]=255&e);1===s&&(e=i[t.charCodeAt(n)]<<10|i[t.charCodeAt(n+1)]<<4|i[t.charCodeAt(n+2)]>>2,u[l++]=e>>8&255,u[l++]=255&e);return u},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],a=0,s=n-i;a<s;a+=16383)o.push(l(t,a,a+16383>s?s:a+16383));1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=a.length;s<u;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function l(t,e,n){for(var i,o,a=[],s=e;s<n;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,f=n?i-1:0,h=n?-1:1,d=t[e+f];for(f+=h,o=d&(1<<-l)-1,d>>=-l,l+=s;l>0;o=256*o+t[e+f],f+=h,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+t[e+f],f+=h,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,r),o-=c}return(d?-1:1)*a*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),(e+=a+f>=1?h/u:h*Math.pow(2,1-f))*u>=2&&(a++,u/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(e*u-1)*Math.pow(2,i),a+=f):(s=e*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;t[n+d]=255&s,d+=p,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;t[n+d]=255&a,d+=p,a/=256,c-=8);t[n+d-p]|=128*m}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){},function(t,e,n){},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(29),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(8))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,i,o,a,s,u=1,c={},l=!1,f=t.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(t);h=h&&h.setTimeout?h:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick((function(){p(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){p(t.data)},r=function(t){o.port2.postMessage(t)}):f&&"onreadystatechange"in f.createElement("script")?(i=f.documentElement,r=function(t){var e=f.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,i.removeChild(e),e=null},i.appendChild(e)}):r=function(t){setTimeout(p,0,t)}:(a="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(a)&&p(+e.data.slice(a.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),r=function(e){t.postMessage(a+e,"*")}),h.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return c[u]=i,r(u),u++},h.clearImmediate=d}function d(t){delete c[t]}function p(t){if(l)setTimeout(p,0,t);else{var e=c[t];if(e){l=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{d(t),l=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(8),n(30))},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var u,c=[],l=!1,f=-1;function h(){l&&u&&(l=!1,u.length?c=u.concat(c):f=-1,c.length&&d())}function d(){if(!l){var t=s(h);l=!0;for(var e=c.length;e;){for(u=c,c=[];++f<e;)u&&u[f].run();f=-1,e=c.length}u=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function m(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new p(t,e)),1!==c.length||l||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"interpolate",(function(){return Mr})),n.d(r,"interpolateArray",(function(){return Ar})),n.d(r,"interpolateBasis",(function(){return ur})),n.d(r,"interpolateBasisClosed",(function(){return cr})),n.d(r,"interpolateDate",(function(){return xr})),n.d(r,"interpolateDiscrete",(function(){return Ic})),n.d(r,"interpolateHue",(function(){return Rc})),n.d(r,"interpolateNumber",(function(){return _r})),n.d(r,"interpolateNumberArray",(function(){return br})),n.d(r,"interpolateObject",(function(){return Cr})),n.d(r,"interpolateRound",(function(){return kr})),n.d(r,"interpolateString",(function(){return Sr})),n.d(r,"interpolateTransformCss",(function(){return Uc})),n.d(r,"interpolateTransformSvg",(function(){return Wc})),n.d(r,"interpolateZoom",(function(){return ui})),n.d(r,"interpolateRgb",(function(){return mr})),n.d(r,"interpolateRgbBasis",(function(){return yr})),n.d(r,"interpolateRgbBasisClosed",(function(){return vr})),n.d(r,"interpolateHsl",(function(){return Hc})),n.d(r,"interpolateHslLong",(function(){return Yc})),n.d(r,"interpolateLab",(function(){return il})),n.d(r,"interpolateHcl",(function(){return al})),n.d(r,"interpolateHclLong",(function(){return sl})),n.d(r,"interpolateCubehelix",(function(){return wl})),n.d(r,"interpolateCubehelixLong",(function(){return Al})),n.d(r,"piecewise",(function(){return bc})),n.d(r,"quantize",(function(){return El}));
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const i=new WeakMap,o=t=>(...e)=>{const n=t(...e);return i.set(n,!0),n},a=t=>"function"==typeof t&&i.has(t),s=void 0!==window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,u=(t,e,n=null)=>{for(;e!==n;){const n=e.nextSibling;t.removeChild(e),e=n}},c={},l={},f=`{{lit-${String(Math.random()).slice(2)}}}`,h=`\x3c!--${f}--\x3e`,d=new RegExp(`${f}|${h}`);class p{constructor(t,e){this.parts=[],this.element=e;const n=[],r=[],i=document.createTreeWalker(e.content,133,null,!1);let o=0,a=-1,s=0;const{strings:u,values:{length:c}}=t;for(;s<c;){const t=i.nextNode();if(null!==t){if(a++,1===t.nodeType){if(t.hasAttributes()){const e=t.attributes,{length:n}=e;let r=0;for(let t=0;t<n;t++)m(e[t].name,"$lit$")&&r++;for(;r-- >0;){const e=u[s],n=v.exec(e)[2],r=n.toLowerCase()+"$lit$",i=t.getAttribute(r);t.removeAttribute(r);const o=i.split(d);this.parts.push({type:"attribute",index:a,name:n,strings:o}),s+=o.length-1}}"TEMPLATE"===t.tagName&&(r.push(t),i.currentNode=t.content)}else if(3===t.nodeType){const e=t.data;if(e.indexOf(f)>=0){const r=t.parentNode,i=e.split(d),o=i.length-1;for(let e=0;e<o;e++){let n,o=i[e];if(""===o)n=y();else{const t=v.exec(o);null!==t&&m(t[2],"$lit$")&&(o=o.slice(0,t.index)+t[1]+t[2].slice(0,-"$lit$".length)+t[3]),n=document.createTextNode(o)}r.insertBefore(n,t),this.parts.push({type:"node",index:++a})}""===i[o]?(r.insertBefore(y(),t),n.push(t)):t.data=i[o],s+=o}}else if(8===t.nodeType)if(t.data===f){const e=t.parentNode;null!==t.previousSibling&&a!==o||(a++,e.insertBefore(y(),t)),o=a,this.parts.push({type:"node",index:a}),null===t.nextSibling?t.data="":(n.push(t),a--),s++}else{let e=-1;for(;-1!==(e=t.data.indexOf(f,e+1));)this.parts.push({type:"node",index:-1}),s++}}else i.currentNode=r.pop()}for(const t of n)t.parentNode.removeChild(t)}}const m=(t,e)=>{const n=t.length-e.length;return n>=0&&t.slice(n)===e},g=t=>-1!==t.index,y=()=>document.createComment(""),v=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
class b{constructor(t,e,n){this.__parts=[],this.template=t,this.processor=e,this.options=n}update(t){let e=0;for(const n of this.__parts)void 0!==n&&n.setValue(t[e]),e++;for(const t of this.__parts)void 0!==t&&t.commit()}_clone(){const t=s?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),e=[],n=this.template.parts,r=document.createTreeWalker(t,133,null,!1);let i,o=0,a=0,u=r.nextNode();for(;o<n.length;)if(i=n[o],g(i)){for(;a<i.index;)a++,"TEMPLATE"===u.nodeName&&(e.push(u),r.currentNode=u.content),null===(u=r.nextNode())&&(r.currentNode=e.pop(),u=r.nextNode());if("node"===i.type){const t=this.processor.handleTextExpression(this.options);t.insertAfterNode(u.previousSibling),this.__parts.push(t)}else this.__parts.push(...this.processor.handleAttributeExpressions(u,i.name,i.strings,this.options));o++}else this.__parts.push(void 0),o++;return s&&(document.adoptNode(t),customElements.upgrade(t)),t}}
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const w=` ${f} `;class A{constructor(t,e,n,r){this.strings=t,this.values=e,this.type=n,this.processor=r}getHTML(){const t=this.strings.length-1;let e="",n=!1;for(let r=0;r<t;r++){const t=this.strings[r],i=t.lastIndexOf("\x3c!--");n=(i>-1||n)&&-1===t.indexOf("--\x3e",i+1);const o=v.exec(t);e+=null===o?t+(n?w:h):t.substr(0,o.index)+o[1]+o[2]+"$lit$"+o[3]+f}return e+=this.strings[t],e}getTemplateElement(){const t=document.createElement("template");return t.innerHTML=this.getHTML(),t}}
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const E=t=>null===t||!("object"==typeof t||"function"==typeof t),x=t=>Array.isArray(t)||!(!t||!t[Symbol.iterator]);class _{constructor(t,e,n){this.dirty=!0,this.element=t,this.name=e,this.strings=n,this.parts=[];for(let t=0;t<n.length-1;t++)this.parts[t]=this._createPart()}_createPart(){return new C(this)}_getValue(){const t=this.strings,e=t.length-1;let n="";for(let r=0;r<e;r++){n+=t[r];const e=this.parts[r];if(void 0!==e){const t=e.value;if(E(t)||!x(t))n+="string"==typeof t?t:String(t);else for(const e of t)n+="string"==typeof e?e:String(e)}}return n+=t[e],n}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class C{constructor(t){this.value=void 0,this.committer=t}setValue(t){t===c||E(t)&&t===this.value||(this.value=t,a(t)||(this.committer.dirty=!0))}commit(){for(;a(this.value);){const t=this.value;this.value=c,t(this)}this.value!==c&&this.committer.commit()}}class T{constructor(t){this.value=void 0,this.__pendingValue=void 0,this.options=t}appendInto(t){this.startNode=t.appendChild(y()),this.endNode=t.appendChild(y())}insertAfterNode(t){this.startNode=t,this.endNode=t.nextSibling}appendIntoPart(t){t.__insert(this.startNode=y()),t.__insert(this.endNode=y())}insertAfterPart(t){t.__insert(this.startNode=y()),this.endNode=t.endNode,t.endNode=this.startNode}setValue(t){this.__pendingValue=t}commit(){for(;a(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=c,t(this)}const t=this.__pendingValue;t!==c&&(E(t)?t!==this.value&&this.__commitText(t):t instanceof A?this.__commitTemplateResult(t):t instanceof Node?this.__commitNode(t):x(t)?this.__commitIterable(t):t===l?(this.value=l,this.clear()):this.__commitText(t))}__insert(t){this.endNode.parentNode.insertBefore(t,this.endNode)}__commitNode(t){this.value!==t&&(this.clear(),this.__insert(t),this.value=t)}__commitText(t){const e=this.startNode.nextSibling,n="string"==typeof(t=null==t?"":t)?t:String(t);e===this.endNode.previousSibling&&3===e.nodeType?e.data=n:this.__commitNode(document.createTextNode(n)),this.value=t}__commitTemplateResult(t){const e=this.options.templateFactory(t);if(this.value instanceof b&&this.value.template===e)this.value.update(t.values);else{const n=new b(e,t.processor,this.options),r=n._clone();n.update(t.values),this.__commitNode(r),this.value=n}}__commitIterable(t){Array.isArray(this.value)||(this.value=[],this.clear());const e=this.value;let n,r=0;for(const i of t)n=e[r],void 0===n&&(n=new T(this.options),e.push(n),0===r?n.appendIntoPart(this):n.insertAfterPart(e[r-1])),n.setValue(i),n.commit(),r++;r<e.length&&(e.length=r,this.clear(n&&n.endNode))}clear(t=this.startNode){u(this.startNode.parentNode,t.nextSibling,this.endNode)}}class O{constructor(t,e,n){if(this.value=void 0,this.__pendingValue=void 0,2!==n.length||""!==n[0]||""!==n[1])throw new Error("Boolean attributes can only contain a single expression");this.element=t,this.name=e,this.strings=n}setValue(t){this.__pendingValue=t}commit(){for(;a(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=c,t(this)}if(this.__pendingValue===c)return;const t=!!this.__pendingValue;this.value!==t&&(t?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=t),this.__pendingValue=c}}class S extends _{constructor(t,e,n){super(t,e,n),this.single=2===n.length&&""===n[0]&&""===n[1]}_createPart(){return new M(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class M extends C{}let k=!1;try{const t={get capture(){return k=!0,!1}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){}class D{constructor(t,e,n){this.value=void 0,this.__pendingValue=void 0,this.element=t,this.eventName=e,this.eventContext=n,this.__boundHandleEvent=t=>this.handleEvent(t)}setValue(t){this.__pendingValue=t}commit(){for(;a(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=c,t(this)}if(this.__pendingValue===c)return;const t=this.__pendingValue,e=this.value,n=null==t||null!=e&&(t.capture!==e.capture||t.once!==e.once||t.passive!==e.passive),r=null!=t&&(null==e||n);n&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),r&&(this.__options=F(t),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=t,this.__pendingValue=c}handleEvent(t){"function"==typeof this.value?this.value.call(this.eventContext||this.element,t):this.value.handleEvent(t)}}const F=t=>t&&(k?{capture:t.capture,passive:t.passive,once:t.once}:t.capture)
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */;const N=new class{handleAttributeExpressions(t,e,n,r){const i=e[0];if("."===i){return new S(t,e.slice(1),n).parts}return"@"===i?[new D(t,e.slice(1),r.eventContext)]:"?"===i?[new O(t,e.slice(1),n)]:new _(t,e,n).parts}handleTextExpression(t){return new T(t)}};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */function I(t){let e=R.get(t.type);void 0===e&&(e={stringsArray:new WeakMap,keyString:new Map},R.set(t.type,e));let n=e.stringsArray.get(t.strings);if(void 0!==n)return n;const r=t.strings.join(f);return n=e.keyString.get(r),void 0===n&&(n=new p(t,t.getTemplateElement()),e.keyString.set(r,n)),e.stringsArray.set(t.strings,n),n}const R=new Map,B=new WeakMap,L=(t,e,n)=>{let r=B.get(e);void 0===r&&(u(e,e.firstChild),B.set(e,r=new T(Object.assign({templateFactory:I},n))),r.appendInto(e)),r.setValue(t),r.commit()};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.1.2");const P=(t,...e)=>new A(t,e,"html",N),z=new WeakMap,U=o(t=>e=>{if(!(e instanceof C)||e instanceof M||"class"!==e.committer.name||e.committer.parts.length>1)throw new Error("The `classMap` directive must be used in the `class` attribute and must be the only part in the attribute.");const{committer:n}=e,{element:r}=n;z.has(e)||(r.className=n.strings.join(" "));const{classList:i}=r,o=z.get(e);for(const e in o)e in t||i.remove(e);for(const e in t){const n=t[e];if(!o||n!==o[e]){i[n?"add":"remove"](e)}}z.set(e,t)});var W={},j={};function H(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function Y(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function $(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function q(t){var e,n=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),o=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+$(-e,6):e>9999?"+"+$(e,6):$(e,4))+"-"+$(t.getUTCMonth()+1,2)+"-"+$(t.getUTCDate(),2)+(o?"T"+$(n,2)+":"+$(r,2)+":"+$(i,2)+"."+$(o,3)+"Z":i?"T"+$(n,2)+":"+$(r,2)+":"+$(i,2)+"Z":r||n?"T"+$(n,2)+":"+$(r,2)+"Z":"")}var X=function(t,e){var n=new RegExp('["'+t+"\n\r]"),r=t.charCodeAt(0);function i(t,n){var i,o=[],a=t.length,s=0,u=0,c=a<=0,l=!1,f=!0,h=e?e.comment:void 0;function d(){if(c)return j;if(l)return l=!1,f=!0,W;if(f&&h){for(;;){let e=0;for(;e<h.length&&h.charAt(e)===t.charAt(e+s);)e++;if(e!==h.length)break;for(s+=e;s<a&&10!==(n=t.charCodeAt(s++));)if(13===n){10===t.charCodeAt(s)&&++s;break}}if(s>=a)return j}f=!1;var e,n,i=s;if(34===t.charCodeAt(i)){for(;s++<a&&34!==t.charCodeAt(s)||34===t.charCodeAt(++s););return(e=s)>=a?c=!0:10===(n=t.charCodeAt(s++))?l=!0:13===n&&(l=!0,10===t.charCodeAt(s)&&++s),t.slice(i+1,e-1).replace(/""/g,'"')}for(;s<a;){if(10===(n=t.charCodeAt(e=s++)))l=!0;else if(13===n)l=!0,10===t.charCodeAt(s)&&++s;else if(n!==r)continue;return t.slice(i,e)}return c=!0,t.slice(i,a)}for(10===t.charCodeAt(a-1)&&--a,13===t.charCodeAt(a-1)&&--a;(i=d())!==j;){for(var p=[];i!==W&&i!==j;)p.push(i),i=d();n&&null==(p=n(p,u++))||o.push(p)}return o}function o(e,n){return e.map((function(e){return n.map((function(t){return s(e[t])})).join(t)}))}function a(e){return e.map(s).join(t)}function s(t){return null==t?"":t instanceof Date?q(t):n.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,r,o=i(t,(function(t,i){if(n)return n(t,i-1);r=t,n=e?function(t,e){var n=H(t);return function(r,i){return e(n(r),i,t)}}(t,e):H(t)}));return o.columns=r||[],o},parseRows:i,format:function(e,n){return null==n&&(n=Y(e)),[n.map(s).join(t)].concat(o(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=Y(t)),o(t,e).join("\n")},formatRows:function(t){return t.map(a).join("\n")},formatRow:a,formatValue:s}},V=n(0);const G=/^([A-Za-z]+:)?\/\//,K=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Z=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g;async function J(t,e){const n=await this.sanitize(t,e),r=n.href;return n.localFile?this.file(r):this.http(r,e)}async function Q(t,e){e=Object(V.e)({},this.options,e);const n=this.fileAccess,r={href:null};let i,o,a;const s=K.test(t.replace(Z,""));null!=t&&"string"==typeof t&&s||Object(V.d)("Sanitize failure, invalid URI: "+Object(V.s)(t));const u=G.test(t);return(a=e.baseURL)&&!u&&(t.startsWith("/")||"/"===a[a.length-1]||(t="/"+t),t=a+t),o=(i=t.startsWith("file://"))||"file"===e.mode||"http"!==e.mode&&!u&&n,i?t=t.slice("file://".length):t.startsWith("//")&&("file"===e.defaultProtocol?(t=t.slice(2),o=!0):t=(e.defaultProtocol||"http")+":"+t),Object.defineProperty(r,"localFile",{value:!!o}),r.href=t,e.target&&(r.target=e.target+""),e.rel&&(r.rel=e.rel+""),r}function tt(t){return t?function(e){return new Promise((function(n,r){t.readFile(e,(function(t,e){t?r(t):n(e)}))}))}:et}async function et(){Object(V.d)("No file system access.")}function nt(t){return t?async function(e,n){const r=Object(V.e)({},this.options.http,n),i=n&&n.response,o=await t(e,r);return o.ok?Object(V.l)(o[i])?o[i]():o.text():Object(V.d)(o.status+""+o.statusText)}:rt}async function rt(){Object(V.d)("No HTTP fetch method available.")}var it={boolean:V.t,integer:V.v,number:V.v,date:V.u,string:V.x,unknown:V.i},ot=[function(t){return"true"===t||"false"===t||!0===t||!1===t},function(t){return ut(t)&&Number.isInteger(+t)},ut,function(t){return!Number.isNaN(Date.parse(t))}],at=["boolean","integer","number","date"];function st(t,e){if(!t||!t.length)return"unknown";var n,r,i,o,a=0,s=t.length,u=ot.length,c=ot.map((function(t,e){return e+1}));for(r=0,s=t.length;r<s;++r)for(n=e?t[r][e]:t[r],i=0;i<u;++i)if(c[i]&&(null!=(o=n)&&o==o)&&!ot[i](n)&&(c[i]=0,++a===ot.length))return"string";return a=c.reduce((function(t,e){return 0===t?e:t}),0)-1,at[a]}function ut(t){return!(Number.isNaN(+t)||t instanceof Date)}function ct(t){const e=function(e,n){const r={delimiter:t};return lt(e,n?Object(V.e)(n,r):r)};return e.responseType="text",e}function lt(t,e){return e.header&&(t=e.header.map(V.s).join(e.delimiter)+"\n"+t),X(e.delimiter).parse(t+"")}lt.responseType="text";var ft=n(9),ht=function(t){return t},dt=function(t){if(null==t)return ht;var e,n,r=t.scale[0],i=t.scale[1],o=t.translate[0],a=t.translate[1];return function(t,s){s||(e=n=0);var u=2,c=t.length,l=new Array(c);for(l[0]=(e+=t[0])*r+o,l[1]=(n+=t[1])*i+a;u<c;)l[u]=t[u],++u;return l}},pt=function(t,e){return"string"==typeof e&&(e=t.objects[e]),"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map((function(e){return mt(t,e)}))}:mt(t,e)};function mt(t,e){var n=e.id,r=e.bbox,i=null==e.properties?{}:e.properties,o=gt(t,e);return null==n&&null==r?{type:"Feature",properties:i,geometry:o}:null==r?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function gt(t,e){var n=dt(t.transform),r=t.arcs;function i(t,e){e.length&&e.pop();for(var i=r[t<0?~t:t],o=0,a=i.length;o<a;++o)e.push(n(i[o],o));t<0&&function(t,e){for(var n,r=t.length,i=r-e;i<--r;)n=t[i],t[i++]=t[r],t[r]=n}(e,a)}function o(t){return n(t)}function a(t){for(var e=[],n=0,r=t.length;n<r;++n)i(t[n],e);return e.length<2&&e.push(e[0]),e}function s(t){for(var e=a(t);e.length<4;)e.push(e[0]);return e}function u(t){return t.map(s)}return function t(e){var n,r=e.type;switch(r){case"GeometryCollection":return{type:r,geometries:e.geometries.map(t)};case"Point":n=o(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(o);break;case"LineString":n=a(e.arcs);break;case"MultiLineString":n=e.arcs.map(a);break;case"Polygon":n=u(e.arcs);break;case"MultiPolygon":n=e.arcs.map(u);break;default:return null}return{type:r,coordinates:n}}(e)}var yt=function(t,e){var n={},r={},i={},o=[],a=-1;function s(t,e){for(var r in t){var i=t[r];delete e[i.start],delete i.start,delete i.end,i.forEach((function(t){n[t<0?~t:t]=1})),o.push(i)}}return e.forEach((function(n,r){var i,o=t.arcs[n<0?~n:n];o.length<3&&!o[1][0]&&!o[1][1]&&(i=e[++a],e[a]=n,e[r]=i)})),e.forEach((function(e){var n,o,a=function(e){var n,r=t.arcs[e<0?~e:e],i=r[0];t.transform?(n=[0,0],r.forEach((function(t){n[0]+=t[0],n[1]+=t[1]}))):n=r[r.length-1];return e<0?[n,i]:[i,n]}(e),s=a[0],u=a[1];if(n=i[s])if(delete i[n.end],n.push(e),n.end=u,o=r[u]){delete r[o.start];var c=o===n?n:n.concat(o);r[c.start=n.start]=i[c.end=o.end]=c}else r[n.start]=i[n.end]=n;else if(n=r[u])if(delete r[n.start],n.unshift(e),n.start=s,o=i[s]){delete i[o.end];var l=o===n?n:o.concat(n);r[l.start=o.start]=i[l.end=n.end]=l}else r[n.start]=i[n.end]=n;else r[(n=[e]).start=s]=i[n.end=u]=n})),s(i,r),s(r,i),e.forEach((function(t){n[t<0?~t:t]||o.push([t])})),o},vt=function(t){return gt(t,bt.apply(this,arguments))};function bt(t,e,n){var r,i,o;if(arguments.length>1)r=wt(t,e,n);else for(i=0,r=new Array(o=t.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:yt(t,r)}}function wt(t,e,n){var r,i=[],o=[];function a(t){var e=t<0?~t:t;(o[e]||(o[e]=[])).push({i:t,g:r})}function s(t){t.forEach(a)}function u(t){t.forEach(s)}return function t(e){switch(r=e,e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"LineString":s(e.arcs);break;case"MultiLineString":case"Polygon":u(e.arcs);break;case"MultiPolygon":!function(t){t.forEach(u)}(e.arcs)}}(e),o.forEach(null==n?function(t){i.push(t[0].i)}:function(t){n(t[0].g,t[t.length-1].g)&&i.push(t[0].i)}),i}const At={interior:(t,e)=>t!==e,exterior:(t,e)=>t===e};function Et(t,e){let n,r,i,o;return t=Object(ft.a)(t,e),e&&e.feature?(n=pt,i=e.feature):e&&e.mesh?(n=vt,i=e.mesh,o=At[e.filter]):Object(V.d)("Missing TopoJSON feature or mesh parameter."),r=(r=t.objects[i])?n(t,r,o):Object(V.d)("Invalid TopoJSON object: "+i),r&&r.features||[r]}Et.responseType="json";const xt={dsv:lt,csv:ct(","),tsv:ct("\t"),json:ft.a,topojson:Et};function _t(t,e){return arguments.length>1?(xt[t]=e,this):Object(V.h)(xt,t)?xt[t]:null}var Ct=new Date,Tt=new Date;function Ot(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,o){var a,s=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return s;do{s.push(a=new Date(+n)),e(n,o),t(n)}while(a<n&&n<r);return s},i.filter=function(n){return Ot((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(i.count=function(e,r){return Ct.setTime(+e),Tt.setTime(+r),t(Ct),t(Tt),Math.floor(n(Ct,Tt))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t==0}:function(e){return i.count(0,e)%t==0}):i:null}),i}function St(t){return Ot((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/6048e5}))}var Mt=St(0),kt=St(1),Dt=St(2),Ft=St(3),Nt=St(4),It=St(5),Rt=St(6),Bt=(Mt.range,kt.range,Dt.range,Ft.range,Nt.range,It.range,Rt.range,Ot((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/864e5}),(function(t){return t.getUTCDate()-1}))),Lt=Bt;Bt.range;function Pt(t){return Ot((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/6048e5}))}var zt=Pt(0),Ut=Pt(1),Wt=Pt(2),jt=Pt(3),Ht=Pt(4),Yt=Pt(5),$t=Pt(6),qt=(zt.range,Ut.range,Wt.range,jt.range,Ht.range,Yt.range,$t.range,Ot((function(t){t.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5}),(function(t){return t.getDate()-1}))),Xt=qt,Vt=(qt.range,Ot((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()})));Vt.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Ot((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};var Gt=Vt,Kt=(Vt.range,Ot((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()})));Kt.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Ot((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};var Zt=Kt;Kt.range;function Jt(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Qt(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function te(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}var ee,ne,re,ie,oe,ae={"-":"",_:" ",0:"0"},se=/^\s*\d+/,ue=/^%/,ce=/[\\^$*+?|[\]().{}]/g;function le(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function fe(t){return t.replace(ce,"\\$&")}function he(t){return new RegExp("^(?:"+t.map(fe).join("|")+")","i")}function de(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function pe(t,e,n){var r=se.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function me(t,e,n){var r=se.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function ge(t,e,n){var r=se.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function ye(t,e,n){var r=se.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function ve(t,e,n){var r=se.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function be(t,e,n){var r=se.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function we(t,e,n){var r=se.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Ae(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Ee(t,e,n){var r=se.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function xe(t,e,n){var r=se.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function _e(t,e,n){var r=se.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Ce(t,e,n){var r=se.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function Te(t,e,n){var r=se.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Oe(t,e,n){var r=se.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Se(t,e,n){var r=se.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Me(t,e,n){var r=se.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function ke(t,e,n){var r=se.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function De(t,e,n){var r=ue.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Fe(t,e,n){var r=se.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Ne(t,e,n){var r=se.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function Ie(t,e){return le(t.getDate(),e,2)}function Re(t,e){return le(t.getHours(),e,2)}function Be(t,e){return le(t.getHours()%12||12,e,2)}function Le(t,e){return le(1+Xt.count(Gt(t),t),e,3)}function Pe(t,e){return le(t.getMilliseconds(),e,3)}function ze(t,e){return Pe(t,e)+"000"}function Ue(t,e){return le(t.getMonth()+1,e,2)}function We(t,e){return le(t.getMinutes(),e,2)}function je(t,e){return le(t.getSeconds(),e,2)}function He(t){var e=t.getDay();return 0===e?7:e}function Ye(t,e){return le(zt.count(Gt(t)-1,t),e,2)}function $e(t,e){var n=t.getDay();return t=n>=4||0===n?Ht(t):Ht.ceil(t),le(Ht.count(Gt(t),t)+(4===Gt(t).getDay()),e,2)}function qe(t){return t.getDay()}function Xe(t,e){return le(Ut.count(Gt(t)-1,t),e,2)}function Ve(t,e){return le(t.getFullYear()%100,e,2)}function Ge(t,e){return le(t.getFullYear()%1e4,e,4)}function Ke(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+le(e/60|0,"0",2)+le(e%60,"0",2)}function Ze(t,e){return le(t.getUTCDate(),e,2)}function Je(t,e){return le(t.getUTCHours(),e,2)}function Qe(t,e){return le(t.getUTCHours()%12||12,e,2)}function tn(t,e){return le(1+Lt.count(Zt(t),t),e,3)}function en(t,e){return le(t.getUTCMilliseconds(),e,3)}function nn(t,e){return en(t,e)+"000"}function rn(t,e){return le(t.getUTCMonth()+1,e,2)}function on(t,e){return le(t.getUTCMinutes(),e,2)}function an(t,e){return le(t.getUTCSeconds(),e,2)}function sn(t){var e=t.getUTCDay();return 0===e?7:e}function un(t,e){return le(Mt.count(Zt(t)-1,t),e,2)}function cn(t,e){var n=t.getUTCDay();return t=n>=4||0===n?Nt(t):Nt.ceil(t),le(Nt.count(Zt(t),t)+(4===Zt(t).getUTCDay()),e,2)}function ln(t){return t.getUTCDay()}function fn(t,e){return le(kt.count(Zt(t)-1,t),e,2)}function hn(t,e){return le(t.getUTCFullYear()%100,e,2)}function dn(t,e){return le(t.getUTCFullYear()%1e4,e,4)}function pn(){return"+0000"}function mn(){return"%"}function gn(t){return+t}function yn(t){return Math.floor(+t/1e3)}ee=function(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,s=t.months,u=t.shortMonths,c=he(i),l=de(i),f=he(o),h=de(o),d=he(a),p=de(a),m=he(s),g=de(s),y=he(u),v=de(u),b={a:function(t){return a[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return u[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:Ie,e:Ie,f:ze,H:Re,I:Be,j:Le,L:Pe,m:Ue,M:We,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:gn,s:yn,S:je,u:He,U:Ye,V:$e,w:qe,W:Xe,x:null,X:null,y:Ve,Y:Ge,Z:Ke,"%":mn},w={a:function(t){return a[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return u[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:Ze,e:Ze,f:nn,H:Je,I:Qe,j:tn,L:en,m:rn,M:on,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:gn,s:yn,S:an,u:sn,U:un,V:cn,w:ln,W:fn,x:null,X:null,y:hn,Y:dn,Z:pn,"%":mn},A={a:function(t,e,n){var r=d.exec(e.slice(n));return r?(t.w=p[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.w=h[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=y.exec(e.slice(n));return r?(t.m=v[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=m.exec(e.slice(n));return r?(t.m=g[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,n,r){return _(t,e,n,r)},d:_e,e:_e,f:ke,H:Te,I:Te,j:Ce,L:Me,m:xe,M:Oe,p:function(t,e,n){var r=c.exec(e.slice(n));return r?(t.p=l[r[0].toLowerCase()],n+r[0].length):-1},q:Ee,Q:Fe,s:Ne,S:Se,u:me,U:ge,V:ye,w:pe,W:ve,x:function(t,e,r){return _(t,n,e,r)},X:function(t,e,n){return _(t,r,e,n)},y:we,Y:be,Z:Ae,"%":De};function E(t,e){return function(n){var r,i,o,a=[],s=-1,u=0,c=t.length;for(n instanceof Date||(n=new Date(+n));++s<c;)37===t.charCodeAt(s)&&(a.push(t.slice(u,s)),null!=(i=ae[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(o=e[r])&&(r=o(n,i)),a.push(r),u=s+1);return a.push(t.slice(u,s)),a.join("")}}function x(t,e){return function(n){var r,i,o=te(1900,void 0,1);if(_(o,t,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(!e||"Z"in o||(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=Qt(te(o.y,0,1))).getUTCDay(),r=i>4||0===i?kt.ceil(r):kt(r),r=Lt.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=Jt(te(o.y,0,1))).getDay(),r=i>4||0===i?Ut.ceil(r):Ut(r),r=Xt.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?Qt(te(o.y,0,1)).getUTCDay():Jt(te(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,Qt(o)):Jt(o)}}function _(t,e,n,r){for(var i,o,a=0,s=e.length,u=n.length;a<s;){if(r>=u)return-1;if(37===(i=e.charCodeAt(a++))){if(i=e.charAt(a++),!(o=A[i in ae?e.charAt(a++):i])||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return(b.x=E(n,b),b.X=E(r,b),b.c=E(e,b),w.x=E(n,w),w.X=E(r,w),w.c=E(e,w),{format:function(t){var e=E(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=x(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=E(t+="",w);return e.toString=function(){return t},e},utcParse:function(t){var e=x(t+="",!0);return e.toString=function(){return t},e}})}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),ne=ee.format,re=ee.parse,ie=ee.utcFormat,oe=ee.utcParse;var vn=function(t,e,n){const r=_t((e=e||{}).type||"json");return r||Object(V.d)("Unknown data format type: "+e.type),t=r(t,e),e.parse&&function(t,e,n){if(!t.length)return;n=n||re;var r,i,o,a,s,u,c,l=t.columns||Object.keys(t[0]);"auto"===e&&(e=function(t,e){return e.reduce((function(e,n){return e[n]=st(t,n),e}),{})}(t,l));for(l=Object.keys(e),r=l.map((function(t){var r,i,o=e[t];if(o&&(0===o.indexOf("date:")||0===o.indexOf("utc:")))return("'"===(i=(r=o.split(/:(.+)?/,2))[1])[0]&&"'"===i[i.length-1]||'"'===i[0]&&'"'===i[i.length-1])&&(i=i.slice(1,-1)),"utc"===r[0]?oe(i):n(i);if(!it[o])throw Error("Illegal format pattern: "+t+":"+o);return it[o]})),a=0,u=t.length,c=l.length;a<u;++a)for(i=t[a],s=0;s<c;++s)o=l[s],i[o]=r[s](i[o])}(t,e.parse,n),Object(V.h)(t,"columns")&&delete t.columns,t};var bn=function(t,e){return function(n){return{options:n||{},sanitize:Q,load:J,fileAccess:!!e,file:tt(e),http:nt(t)}}}("undefined"!=typeof fetch&&fetch,null);Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function t(){var e=isNaN(arguments[0])?1:Number(arguments[0]);return e?Array.prototype.reduce.call(this,(function(n,r){return Array.isArray(r)?n.push.apply(n,t.call(r,e-1)):n.push(r),n}),[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(t){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var wn=Math.sqrt(50),An=Math.sqrt(10),En=Math.sqrt(2),xn=function(t,e,n){var r,i,o,a,s=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(a=_n(t,e,n))||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),e=Math.floor(e/a),o=new Array(i=Math.ceil(e-t+1));++s<i;)o[s]=(t+s)*a;else for(t=Math.floor(t*a),e=Math.ceil(e*a),o=new Array(i=Math.ceil(t-e+1));++s<i;)o[s]=(t-s)/a;return r&&o.reverse(),o};function _n(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=wn?10:o>=An?5:o>=En?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=wn?10:o>=An?5:o>=En?2:1)}function Cn(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=wn?i*=10:o>=An?i*=5:o>=En&&(i*=2),e<t?-i:i}var Tn=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},On=function(t){var e;return 1===t.length&&(e=t,t=function(t,n){return Tn(e(t),n)}),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}};var Sn=On(Tn),Mn=Sn.right,kn=(Sn.left,Mn),Dn=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function Fn(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Nn(){}var In="\\s*([+-]?\\d+)\\s*",Rn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Bn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ln=/^#([0-9a-f]{3,8})$/,Pn=new RegExp("^rgb\\("+[In,In,In]+"\\)$"),zn=new RegExp("^rgb\\("+[Bn,Bn,Bn]+"\\)$"),Un=new RegExp("^rgba\\("+[In,In,In,Rn]+"\\)$"),Wn=new RegExp("^rgba\\("+[Bn,Bn,Bn,Rn]+"\\)$"),jn=new RegExp("^hsl\\("+[Rn,Bn,Bn]+"\\)$"),Hn=new RegExp("^hsla\\("+[Rn,Bn,Bn,Rn]+"\\)$"),Yn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function $n(){return this.rgb().formatHex()}function qn(){return this.rgb().formatRgb()}function Xn(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Ln.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Vn(e):3===n?new Jn(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?new Jn(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?new Jn(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Pn.exec(t))?new Jn(e[1],e[2],e[3],1):(e=zn.exec(t))?new Jn(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Un.exec(t))?Gn(e[1],e[2],e[3],e[4]):(e=Wn.exec(t))?Gn(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=jn.exec(t))?nr(e[1],e[2]/100,e[3]/100,1):(e=Hn.exec(t))?nr(e[1],e[2]/100,e[3]/100,e[4]):Yn.hasOwnProperty(t)?Vn(Yn[t]):"transparent"===t?new Jn(NaN,NaN,NaN,0):null}function Vn(t){return new Jn(t>>16&255,t>>8&255,255&t,1)}function Gn(t,e,n,r){return r<=0&&(t=e=n=NaN),new Jn(t,e,n,r)}function Kn(t){return t instanceof Nn||(t=Xn(t)),t?new Jn((t=t.rgb()).r,t.g,t.b,t.opacity):new Jn}function Zn(t,e,n,r){return 1===arguments.length?Kn(t):new Jn(t,e,n,null==r?1:r)}function Jn(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Qn(){return"#"+er(this.r)+er(this.g)+er(this.b)}function tr(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function er(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function nr(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new or(t,e,n,r)}function rr(t){if(t instanceof or)return new or(t.h,t.s,t.l,t.opacity);if(t instanceof Nn||(t=Xn(t)),!t)return new or;if(t instanceof or)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new or(a,s,u,t.opacity)}function ir(t,e,n,r){return 1===arguments.length?rr(t):new or(t,e,n,null==r?1:r)}function or(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function ar(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function sr(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}Dn(Nn,Xn,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:$n,formatHex:$n,formatHsl:function(){return rr(this).formatHsl()},formatRgb:qn,toString:qn}),Dn(Jn,Zn,Fn(Nn,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Jn(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Jn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Qn,formatHex:Qn,formatRgb:tr,toString:tr})),Dn(or,ir,Fn(Nn,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new or(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new or(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Jn(ar(t>=240?t-240:t+120,i,r),ar(t,i,r),ar(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var ur=function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,s=r<e-1?t[r+2]:2*o-i;return sr((n-r/e)*e,a,i,o,s)}},cr=function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],o=t[r%e],a=t[(r+1)%e],s=t[(r+2)%e];return sr((n-r/e)*e,i,o,a,s)}},lr=function(t){return function(){return t}};function fr(t,e){return function(n){return t+n*e}}function hr(t,e){var n=e-t;return n?fr(t,n>180||n<-180?n-360*Math.round(n/360):n):lr(isNaN(t)?e:t)}function dr(t){return 1==(t=+t)?pr:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):lr(isNaN(e)?n:e)}}function pr(t,e){var n=e-t;return n?fr(t,n):lr(isNaN(t)?e:t)}var mr=function t(e){var n=dr(e);function r(t,e){var r=n((t=Zn(t)).r,(e=Zn(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=pr(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function gr(t){return function(e){var n,r,i=e.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=Zn(e[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=t(o),a=t(a),s=t(s),r.opacity=1,function(t){return r.r=o(t),r.g=a(t),r.b=s(t),r+""}}}var yr=gr(ur),vr=gr(cr),br=function(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(n=0;n<r;++n)i[n]=t[n]*(1-o)+e[n]*o;return i}};function wr(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}var Ar=function(t,e){return(wr(e)?br:Er)(t,e)};function Er(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=Mr(t[n],e[n]);for(;n<r;++n)a[n]=e[n];return function(t){for(n=0;n<i;++n)a[n]=o[n](t);return a}}var xr=function(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}},_r=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},Cr=function(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=Mr(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}},Tr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Or=new RegExp(Tr.source,"g");var Sr=function(t,e){var n,r,i,o=Tr.lastIndex=Or.lastIndex=0,a=-1,s=[],u=[];for(t+="",e+="";(n=Tr.exec(t))&&(r=Or.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:_r(n,r)})),o=Or.lastIndex;return o<e.length&&(i=e.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?function(t){return function(e){return t(e)+""}}(u[0].x):function(t){return function(){return t}}(e):(e=u.length,function(t){for(var n,r=0;r<e;++r)s[(n=u[r]).i]=n.x(t);return s.join("")})},Mr=function(t,e){var n,r=typeof e;return null==e||"boolean"===r?lr(e):("number"===r?_r:"string"===r?(n=Xn(e))?(e=n,mr):Sr:e instanceof Xn?mr:e instanceof Date?xr:wr(e)?br:Array.isArray(e)?Er:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Cr:_r)(t,e)},kr=function(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}},Dr=function(t){return+t},Fr=[0,1];function Nr(t){return t}function Ir(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function Rr(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=Ir(i,r),o=n(a,o)):(r=Ir(r,i),o=n(o,a)),function(t){return o(r(t))}}function Br(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=Ir(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(e){var n=kn(t,e,1,r)-1;return o[n](i[n](e))}}function Lr(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Pr(){var t,e,n,r,i,o,a=Fr,s=Fr,u=Mr,c=Nr;function l(){var t,e,n,u=Math.min(a.length,s.length);return c!==Nr&&(t=a[0],e=a[u-1],t>e&&(n=t,t=e,e=n),c=function(n){return Math.max(t,Math.min(e,n))}),r=u>2?Br:Rr,i=o=null,f}function f(e){return isNaN(e=+e)?n:(i||(i=r(a.map(t),s,u)))(t(c(e)))}return f.invert=function(n){return c(e((o||(o=r(s,a.map(t),_r)))(n)))},f.domain=function(t){return arguments.length?(a=Array.from(t,Dr),l()):a.slice()},f.range=function(t){return arguments.length?(s=Array.from(t),l()):s.slice()},f.rangeRound=function(t){return s=Array.from(t),u=kr,l()},f.clamp=function(t){return arguments.length?(c=!!t||Nr,l()):c!==Nr},f.interpolate=function(t){return arguments.length?(u=t,l()):u},f.unknown=function(t){return arguments.length?(n=t,f):n},function(n,r){return t=n,e=r,l()}}function zr(){return Pr()(Nr,Nr)}function Ur(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function Wr(t,e){switch(arguments.length){case 0:break;case 1:"function"==typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"==typeof e?this.interpolator(e):this.range(e)}return this}var jr=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Hr(t){if(!(e=jr.exec(t)))throw new Error("invalid format: "+t);var e;return new Yr({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Yr(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}Hr.prototype=Yr.prototype,Yr.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var $r,qr,Xr,Vr,Gr=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]},Kr=function(t){return(t=Gr(Math.abs(t)))?t[1]:NaN},Zr=function(t,e){var n=Gr(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},Jr={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return Zr(100*t,e)},r:Zr,s:function(t,e){var n=Gr(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-($r=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Gr(t,Math.max(0,e+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},Qr=function(t){return t},ti=Array.prototype.map,ei=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"],ni=function(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?Qr:(e=ti.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],a=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(t.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?Qr:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(ti.call(t.numerals,String)),u=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"-":t.minus+"",l=void 0===t.nan?"NaN":t.nan+"";function f(t){var e=(t=Hr(t)).fill,n=t.align,f=t.sign,h=t.symbol,d=t.zero,p=t.width,m=t.comma,g=t.precision,y=t.trim,v=t.type;"n"===v?(m=!0,v="g"):Jr[v]||(void 0===g&&(g=12),y=!0,v="g"),(d||"0"===e&&"="===n)&&(d=!0,e="0",n="=");var b="$"===h?i:"#"===h&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",w="$"===h?o:/[%p]/.test(v)?u:"",A=Jr[v],E=/[defgprs%]/.test(v);function x(t){var i,o,u,h=b,x=w;if("c"===v)x=A(t)+x,t="";else{var _=(t=+t)<0;if(t=isNaN(t)?l:A(Math.abs(t),g),y&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),_&&0==+t&&(_=!1),h=(_?"("===f?f:c:"-"===f||"("===f?"":f)+h,x=("s"===v?ei[8+$r/3]:"")+x+(_&&"("===f?")":""),E)for(i=-1,o=t.length;++i<o;)if(48>(u=t.charCodeAt(i))||u>57){x=(46===u?a+t.slice(i+1):t.slice(i))+x,t=t.slice(0,i);break}}m&&!d&&(t=r(t,1/0));var C=h.length+t.length+x.length,T=C<p?new Array(p-C+1).join(e):"";switch(m&&d&&(t=r(T+t,T.length?p-x.length:1/0),T=""),n){case"<":t=h+t+x+T;break;case"=":t=h+T+t+x;break;case"^":t=T.slice(0,C=T.length>>1)+h+t+x+T.slice(C);break;default:t=T+h+t+x}return s(t)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),x.toString=function(){return t+""},x}return{format:f,formatPrefix:function(t,e){var n=f(((t=Hr(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Kr(e)/3))),i=Math.pow(10,-r),o=ei[8+r/3];return function(t){return n(i*t)+o}}}};!function(t){qr=ni(t),Xr=qr.format,Vr=qr.formatPrefix}({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});var ri=function(t,e,n,r){var i,o=Cn(t,e,n);switch((r=Hr(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Kr(e)/3)))-Kr(Math.abs(t)))}(o,a))||(r.precision=i),Vr(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Kr(e)-Kr(t))+1}(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-Kr(Math.abs(t)))}(o))||(r.precision=i-2*("%"===r.type))}return Xr(r)};function ii(t){var e=t.domain;return t.ticks=function(t){var n=e();return xn(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return ri(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i=e(),o=0,a=i.length-1,s=i[o],u=i[a];return u<s&&(r=s,s=u,u=r,r=o,o=a,a=r),(r=_n(s,u,n))>0?r=_n(s=Math.floor(s/r)*r,u=Math.ceil(u/r)*r,n):r<0&&(r=_n(s=Math.ceil(s*r)/r,u=Math.floor(u*r)/r,n)),r>0?(i[o]=Math.floor(s/r)*r,i[a]=Math.ceil(u/r)*r,e(i)):r<0&&(i[o]=Math.ceil(s*r)/r,i[a]=Math.floor(u*r)/r,e(i)),t},t}function oi(){var t=zr();return t.copy=function(){return Lr(t,oi())},Ur.apply(t,arguments),ii(t)}var ai=Math.SQRT2;function si(t){return((t=Math.exp(t))+1/t)/2}var ui=function(t,e){var n,r,i=t[0],o=t[1],a=t[2],s=e[0],u=e[1],c=e[2],l=s-i,f=u-o,h=l*l+f*f;if(h<1e-12)r=Math.log(c/a)/ai,n=function(t){return[i+t*l,o+t*f,a*Math.exp(ai*t*r)]};else{var d=Math.sqrt(h),p=(c*c-a*a+4*h)/(2*a*2*d),m=(c*c-a*a-4*h)/(2*c*2*d),g=Math.log(Math.sqrt(p*p+1)-p),y=Math.log(Math.sqrt(m*m+1)-m);r=(y-g)/ai,n=function(t){var e,n=t*r,s=si(g),u=a/(2*d)*(s*(e=ai*n+g,((e=Math.exp(2*e))-1)/(e+1))-function(t){return((t=Math.exp(t))-1/t)/2}(g));return[i+u*l,o+u*f,a*s/si(ai*n+g)]}}return n.duration=1e3*r,n},ci=n(10),li=n.n(ci);class fi{constructor(t,e){if("number"!=typeof t||isNaN(t))throw new Error(`Lower value "${t}" is not a number!`);if("number"!=typeof e||isNaN(e))throw new Error(`Upper value "${e}" is not a number!`);if(e<t)throw new Error(`Upper value is less that lower value! Lower: ${t}, upper: ${e}`);this.lower=t,this.upper=e}static fromArray(t){return new fi(t[0],t[1])}equals(t){return t instanceof fi&&this.lower==t.lower&&this.upper==t.upper}contains(t){return this.lower<=t&&t<this.upper}encloses(t){return this.lower<=t.lower&&t.upper<=this.upper}empty(){return this.lower==this.upper}width(){return this.upper-this.lower}centre(){return(this.lower+this.upper)/2}connectedWith(t){return this.upper>=t.lower&&t.upper>=this.lower}interpolate(t){return this.lower+t*this.width()}intersect(t){if(!this.connectedWith(t))return null;const e=new fi(Math.max(this.lower,t.lower),Math.min(this.upper,t.upper));return e.width()>0?e:null}span(t){return null==t?this:t instanceof fi?this.encloses(t)?this:new fi(Math.min(this.lower,t.lower),Math.max(this.upper,t.upper)):this.contains(t)?this:new fi(Math.min(this.lower,t),Math.max(this.upper,t))}transform(t){return t?new fi(t(this.lower),t(this.upper)):this}mix(t,e){const n=(t,n)=>t*(1-e)+n*e;return new fi(n(this.lower,t.lower),n(this.upper,t.upper))}pad(t){return new fi(this.lower-t,this.upper+t)}copy(){return new fi(this.lower,this.upper)}withLower(t){return new fi(t,this.upper)}withUpper(t){return new fi(this.lower,t)}toString(){return`[${this.lower}, ${this.upper})`}toArray(){return[this.lower,this.upper]}}var hi=function(t,e){var n=t.getBoundingClientRect();return[e.clientX-n.left-t.clientLeft,e.clientY-n.top-t.clientTop]};class di{constructor(){this.mouseX=0,this.mouseY=0,this.deltaX=0,this.deltaY=0,this.stopped=!1,this.gesturing=!1,this.mouseEvent=void 0}stop(){this.stopped=!0}isPinching(){return this.gesturing||this.mouseEvent&&this.mouseEvent.ctrlKey}}class pi{constructor(t){this.listeners=[t],this.mouseDown=!1,this.lastPoint=null,this.zoomInertia=new gi}_dispatch(t){for(let e=this.listeners.length-1;e>=0&&!t.stopped;e--)this.listeners[e](t)}pushListener(t){return this.listeners.push(t),this.listeners[this.listeners.length-2]}popListener(){if(this.listeners.length>1)return this.zoomInertia.cancel(),this.listeners.pop();throw new Error("Cannot pop the initial listener!")}attachZoomEvents(t,e){["mousedown","wheel","dragstart","gesturechange"].forEach(n=>t.addEventListener(n,n=>{const r=e?e(hi(t,n)):hi(t,n);this._handleMouseEvent(n,r,t)},!1)),["gesturestart","gesturechange","gestureend"].forEach(n=>t.addEventListener(n,n=>{const r=e?e(hi(t,n)):hi(t,n);this._handleGestureEvent(n,r,t)},!1))}_handleMouseEvent(t,e,n){const r=e[0],i=e[1],o=new di;if(o.mouseX=r,o.mouseY=i,o.mouseEvent=t,"dragstart"==t.type)return!1;if("wheel"==t.type){t.stopPropagation(),t.preventDefault();const e=-(t.deltaMode?120:1);if(Math.abs(t.deltaX)>Math.abs(t.deltaY))o.deltaX=t.deltaX*e,this._dispatch(o);else{const n=t.ctrlKey?5:1,r=t=>{o.deltaY=t,o.stopped=!1,this._dispatch(o)};this.zoomInertia.setMomentum(t.deltaY*e*n,r)}}else if("mousedown"==t.type&&0==t.button){this.zoomInertia.cancel(),t.preventDefault();let e=t;const n=t=>{o.deltaX=t.clientX-e.clientX,e=t,this._dispatch(o)},r=t=>{document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",r)};document.addEventListener("mouseup",r,!1),document.addEventListener("mousemove",n,!1)}}_handleGestureEvent(t,e,n){const r=new di;r.mouseX=e[0],r.mouseY=e[1],r.gesturing=!0,t.preventDefault();let i=0;if("gesturestart"==t.type)i=0;else if("gesturechange"==t.type){const e=Math.log2(t.scale);r.deltaY=10*(e-i),i=e,this._dispatch(r)}}}class mi{constructor(t=1,e=0){this.k=t,this.x=e}scale(t){return new mi(this.k*t,this.x)}translate(t){return new mi(this.k,this.x+this.k*t)}invert(t){return(t-this.x)/this.k}rescale(t){return t.copy().domain(t.range().map(this.invert,this).map(t.invert,t))}toString(){return`translate(${this.x}) scale(${this.k})`}}class gi{constructor(){this.damping=1e-4,this.acceleration=.3,this.accelerationThreshold=100,this.maxMomentum=50,this.lowerLimit=.5,this.clear()}clear(){this.momentum=0,this.timestamp=null,this.loop=null,this.callback=null}cancel(){this.loop&&(window.cancelAnimationFrame(this.loop),this.clear())}setMomentum(t,e){t*this.momentum<0?this.momentum=0:Math.abs(t)>this.accelerationThreshold?this.momentum=Object(V.p)([this.momentum,t],this.acceleration):this.momentum=t,this.callback=e,this.loop||this.animate()}animate(t){const e=t-this.timestamp||0;this.timestamp=t;const n=Math.pow(this.damping,e/1e3);this.momentum*=n,this.callback(this.momentum),Math.abs(this.momentum)>this.lowerLimit?this.loop=window.requestAnimationFrame(this.animate.bind(this)):this.clear()}}n(26);class yi{constructor(t){this.container=t,this.element=document.createElement("div"),this.element.className="tooltip",this.element.style.visibility="hidden",this.container.appendChild(this.element)}handleMouseMove(t){this.mouseCoords=hi(this.container,t),"visible"==this.element.style.visibility&&this.updatePlacement()}updatePlacement(){const[t,e]=this.mouseCoords;let n=t+20;n>this.container.clientWidth-this.element.offsetWidth&&(n=t-20-this.element.offsetWidth),this.element.style.left=n+"px",this.element.style.top=Math.min(e+20,this.container.clientHeight-this.element.offsetHeight)+"px"}setContent(t){if(!t)return this.element.innerHTML="",void(this.element.style.visibility="hidden");"string"==typeof t?this.element.innerHTML=t:t instanceof HTMLElement?(this.element.innerHTML="",this.element.appendChild(t)):this.element.innerText="Unknown type",this.updatePlacement(),this.element.style.visibility="visible"}}function vi(t){return new Promise(e=>{const n=performance.now(),r=n+(t.duration||1e3),i=r-n,o="number"==typeof t.from?t.from:0,a="number"==typeof t.to?t.to:1,s=t.easingFunction||Ei,u=a-o,c=function(l){t.onUpdate(s(l-n,o,u,i)),l<r?window.requestAnimationFrame(c):(t.onUpdate(a),e())};window.requestAnimationFrame(c)})}function bi(t){return e=>t(e,0,1,1)}function wi(t,e,n,r){return n*t/r+e}function Ai(t,e,n,r){return n*(t/=r)*t+e}function Ei(t,e,n,r){return(t/=r/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e}function xi(t,e,n,r){return-n/2*(Math.cos(Math.PI*t/r)-1)+e}var _i=X("\t"),Ci=(_i.parse,_i.parseRows);_i.format,_i.formatBody,_i.formatRows,_i.formatRow,_i.formatValue;class Ti{constructor(t){this.chromosomes=[...t],this.startByIndex=[0],this.startByName=new Map,this.chromosomesByName=new Map;let e=0;for(let t=0;t<this.chromosomes.length;t++){const n=this.chromosomes[t];this.startByIndex.push(e),this.startByName.set(n.name,e),n.continuousStart=e,n.continuousEnd=e+n.size,n.continuousInterval=new fi(e,e+n.size),n.index=t,n.number=t+1,n.odd=!!(1&n.number),this.chromosomesByName.set(n.name,n),e+=n.size}this.totalSize=e,this._lastChrom=void 0,this._lastOffset=0}toContinuous(t,e){let n;if(e=+e,t===this._lastChrom?n=this._lastOffset:("number"==typeof t?t>0&&t<=this.startByIndex.length&&(n=this.startByIndex[t]):(n=this.startByName.get(t),void 0===n&&(n=this.startByName.get("chr"+t))),this._lastChrom=t,this._lastOffset=n),void 0!==n)return n+e}toChromosomal(t){if(t>=this.totalSize)return;const e=kn(this.startByIndex,t)-1;return e>0&&e<=this.chromosomes.length?{chromosome:this.chromosomes[e-1].name,pos:t-this.startByIndex[e]}:void 0}segmentToContinuous(t,e,n){const r=this.startByName.get(t);return new fi(r+e,r+n)}getChromosomes(){return this.chromosomes}getChromosome(t){return this.chromosomesByName.get(t)}}class Oi{async initialize(t){}formatInterval(t){}parseInterval(t){}getExtent(){}}class Si extends Oi{constructor(t){if(super(),this.config=t,!this.config.contigs&&"string"!=typeof this.config.name)throw new Error("No name has been defined for the genome assembly!");this.numberFormat=Xr(",d")}get name(){return this.config.name}async initialize(t){if(this.config.baseUrl?this.baseUrl=/^http(s)?/.test(this.config.baseUrl)?this.config.baseUrl:t.config.baseUrl+"/"+this.config.baseUrl:this.baseUrl="https://genomespy.app/data/genomes/",this.config.contigs)this.chromSizes=this.config.contigs;else try{this.chromSizes=(e=await bn({baseURL:this.baseUrl}).load(`${this.config.name}/${this.name}.chrom.sizes`),Ci(e).filter(t=>/^chr[0-9XY]{1,2}$/.test(t[0])).map(([t,e])=>({name:t,size:parseInt(e)})))}catch(t){throw new Error(`Could not load chrom sizes: ${t.message}`)}var e;this.chromMapper=new Ti(this.chromSizes),t.accessorFactory.register(t=>{if(t.chrom&&t.pos){const e="number"==typeof t.offset?t.offset:0,n=Object(V.g)(t.chrom),r=Object(V.g)(t.pos),i=t=>this.chromMapper.toContinuous(n(t),r(t))+e;return i.constant=!1,i.fields=[Object(V.a)(n),Object(V.a)(r)].flat(),i}}),t.registerNamedDataProvider(t=>{if("chromSizes"==t)return this.chromMapper.getChromosomes()})}formatInterval(t){const e=this.chromMapper.toChromosomal(t.lower+.5),n=this.chromMapper.toChromosomal(t.upper-1);return e.chromosome+":"+this.numberFormat(Math.floor(e.pos+1))+"-"+(e.chromosome!=n.chromosome?n.chromosome+":":"")+this.numberFormat(Math.ceil(n.pos+1))}parseInterval(t){const e=t.match(/^(chr[0-9XY]+):([0-9,]+)-(?:(chr[0-9XY]+):)?([0-9,]+)$/);if(e){const t=e[1],n=e[3]||t,r=parseInt(e[2].replace(/,/g,"")),i=parseInt(e[4].replace(/,/g,""));return new fi(this.chromMapper.toContinuous(t,r-1),this.chromMapper.toContinuous(n,i))}return null}getExtent(){return new fi(0,this.chromMapper.totalSize)}}class Mi{constructor(t,e){this.config=e||{},this.genomeSpy=t}async initialize(t){this.trackContainer=t}getMinAxisWidth(){return 0}getXDomain(){}getHeight(){return this.trackContainer.clientHeight}createCanvas(){const t=document.createElement("canvas");return t.style.position="absolute",this.trackContainer.appendChild(t),t}adjustCanvas(t,e,n){const r=window.devicePixelRatio||1,i=t=>`${t}px`;t.style.left=i(e.lower),t.style.width=i(e.width()),t.style.height=i(n),t.width=e.width()*r,t.height=(n||this.getHeight())*r}get2d(t){const e=window.devicePixelRatio||1,n=t.getContext("2d");return n.setTransform(1,0,0,1,0,0),n.scale(e,e),n}search(t){return null}searchHelp(){return""}}var ki,Di,Fi,Ni,Ii;function Ri(t){this.type=t}Ri.prototype.visit=function(t){var e,n,r;if(t(this))return 1;for(n=0,r=(e=function(t){switch(t.type){case"ArrayExpression":return t.elements;case"BinaryExpression":case"LogicalExpression":return[t.left,t.right];case"CallExpression":var e=t.arguments.slice();return e.unshift(t.callee),e;case"ConditionalExpression":return[t.test,t.consequent,t.alternate];case"MemberExpression":return[t.object,t.property];case"ObjectExpression":return t.properties;case"Property":return[t.key,t.value];case"UnaryExpression":return[t.argument];case"Identifier":case"Literal":case"RawCode":default:return[]}}(this)).length;n<r;++n)if(e[n].visit(t))return 1};(ki={})[1]="Boolean",ki[2]="<end>",ki[3]="Identifier",ki[4]="Keyword",ki[5]="Null",ki[6]="Numeric",ki[7]="Punctuator",ki[8]="String",ki[9]="RegularExpression";var Bi="ILLEGAL",Li=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),Pi=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function zi(t,e){if(!t)throw new Error("ASSERT: "+e)}function Ui(t){return t>=48&&t<=57}function Wi(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function ji(t){return"01234567".indexOf(t)>=0}function Hi(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function Yi(t){return 10===t||13===t||8232===t||8233===t}function $i(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||t>=128&&Li.test(String.fromCharCode(t))}function qi(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||t>=128&&Pi.test(String.fromCharCode(t))}var Xi={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function Vi(){for(var t;Fi<Ni&&(Hi(t=Di.charCodeAt(Fi))||Yi(t));)++Fi}function Gi(t){var e,n,r,i=0;for(n="u"===t?4:2,e=0;e<n;++e)Fi<Ni&&Wi(Di[Fi])?(r=Di[Fi++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):fo({},"Unexpected token %0",Bi);return String.fromCharCode(i)}function Ki(){var t,e,n,r;for(e=0,"}"===(t=Di[Fi])&&fo({},"Unexpected token %0",Bi);Fi<Ni&&Wi(t=Di[Fi++]);)e=16*e+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||"}"!==t)&&fo({},"Unexpected token %0",Bi),e<=65535?String.fromCharCode(e):(n=55296+(e-65536>>10),r=56320+(e-65536&1023),String.fromCharCode(n,r))}function Zi(){var t,e;for(t=Di.charCodeAt(Fi++),e=String.fromCharCode(t),92===t&&(117!==Di.charCodeAt(Fi)&&fo({},"Unexpected token %0",Bi),++Fi,(t=Gi("u"))&&"\\"!==t&&$i(t.charCodeAt(0))||fo({},"Unexpected token %0",Bi),e=t);Fi<Ni&&qi(t=Di.charCodeAt(Fi));)++Fi,e+=String.fromCharCode(t),92===t&&(e=e.substr(0,e.length-1),117!==Di.charCodeAt(Fi)&&fo({},"Unexpected token %0",Bi),++Fi,(t=Gi("u"))&&"\\"!==t&&qi(t.charCodeAt(0))||fo({},"Unexpected token %0",Bi),e+=t);return e}function Ji(){var t,e;return t=Fi,{type:1===(e=92===Di.charCodeAt(Fi)?Zi():function(){var t,e;for(t=Fi++;Fi<Ni;){if(92===(e=Di.charCodeAt(Fi)))return Fi=t,Zi();if(!qi(e))break;++Fi}return Di.slice(t,Fi)}()).length?3:Xi.hasOwnProperty(e)?4:"null"===e?5:"true"===e||"false"===e?1:3,value:e,start:t,end:Fi}}function Qi(){var t,e,n,r,i=Fi,o=Di.charCodeAt(Fi),a=Di[Fi];switch(o){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++Fi,{type:7,value:String.fromCharCode(o),start:i,end:Fi};default:if(61===(t=Di.charCodeAt(Fi+1)))switch(o){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return Fi+=2,{type:7,value:String.fromCharCode(o)+String.fromCharCode(t),start:i,end:Fi};case 33:case 61:return Fi+=2,61===Di.charCodeAt(Fi)&&++Fi,{type:7,value:Di.slice(i,Fi),start:i,end:Fi}}}return">>>="===(r=Di.substr(Fi,4))?{type:7,value:r,start:i,end:Fi+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:7,value:n,start:i,end:Fi+=3}:a===(e=n.substr(0,2))[1]&&"+-<>&|".indexOf(a)>=0||"=>"===e?{type:7,value:e,start:i,end:Fi+=2}:"<>=!+-*%&|^/".indexOf(a)>=0?{type:7,value:a,start:i,end:++Fi}:void fo({},"Unexpected token %0",Bi)}function to(){var t,e,n;if(zi(Ui((n=Di[Fi]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),e=Fi,t="","."!==n){if(t=Di[Fi++],n=Di[Fi],"0"===t){if("x"===n||"X"===n)return++Fi,function(t){for(var e="";Fi<Ni&&Wi(Di[Fi]);)e+=Di[Fi++];return 0===e.length&&fo({},"Unexpected token %0",Bi),$i(Di.charCodeAt(Fi))&&fo({},"Unexpected token %0",Bi),{type:6,value:parseInt("0x"+e,16),start:t,end:Fi}}(e);if(ji(n))return function(t){for(var e="0"+Di[Fi++];Fi<Ni&&ji(Di[Fi]);)e+=Di[Fi++];return($i(Di.charCodeAt(Fi))||Ui(Di.charCodeAt(Fi)))&&fo({},"Unexpected token %0",Bi),{type:6,value:parseInt(e,8),octal:!0,start:t,end:Fi}}(e);n&&Ui(n.charCodeAt(0))&&fo({},"Unexpected token %0",Bi)}for(;Ui(Di.charCodeAt(Fi));)t+=Di[Fi++];n=Di[Fi]}if("."===n){for(t+=Di[Fi++];Ui(Di.charCodeAt(Fi));)t+=Di[Fi++];n=Di[Fi]}if("e"===n||"E"===n)if(t+=Di[Fi++],"+"!==(n=Di[Fi])&&"-"!==n||(t+=Di[Fi++]),Ui(Di.charCodeAt(Fi)))for(;Ui(Di.charCodeAt(Fi));)t+=Di[Fi++];else fo({},"Unexpected token %0",Bi);return $i(Di.charCodeAt(Fi))&&fo({},"Unexpected token %0",Bi),{type:6,value:parseFloat(t),start:e,end:Fi}}function eo(){var t,e,n,r;return Ii=null,Vi(),t=Fi,e=function(){var t,e,n,r;for(zi("/"===(t=Di[Fi]),"Regular expression literal must start with a slash"),e=Di[Fi++],n=!1,r=!1;Fi<Ni;)if(e+=t=Di[Fi++],"\\"===t)Yi((t=Di[Fi++]).charCodeAt(0))&&fo({},"Invalid regular expression: missing /"),e+=t;else if(Yi(t.charCodeAt(0)))fo({},"Invalid regular expression: missing /");else if(n)"]"===t&&(n=!1);else{if("/"===t){r=!0;break}"["===t&&(n=!0)}return r||fo({},"Invalid regular expression: missing /"),{value:e.substr(1,e.length-2),literal:e}}(),n=function(){var t,e,n;for(e="",n="";Fi<Ni&&qi((t=Di[Fi]).charCodeAt(0));)++Fi,"\\"===t&&Fi<Ni?fo({},"Unexpected token %0",Bi):(n+=t,e+=t);return n.search(/[^gimuy]/g)>=0&&fo({},"Invalid regular expression",n),{value:n,literal:e}}(),r=function(t,e){var n=t;e.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(function(t,e){if(parseInt(e,16)<=1114111)return"x";fo({},"Invalid regular expression")})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(t){fo({},"Invalid regular expression")}try{return new RegExp(t,e)}catch(t){return null}}(e.value,n.value),{literal:e.literal+n.literal,value:r,regex:{pattern:e.value,flags:n.value},start:t,end:Fi}}function no(){var t;return Vi(),Fi>=Ni?{type:2,start:Fi,end:Fi}:$i(t=Di.charCodeAt(Fi))?Ji():40===t||41===t||59===t?Qi():39===t||34===t?function(){var t,e,n,r,i="",o=!1;for(zi("'"===(t=Di[Fi])||'"'===t,"String literal must starts with a quote"),e=Fi,++Fi;Fi<Ni;){if((n=Di[Fi++])===t){t="";break}if("\\"===n)if((n=Di[Fi++])&&Yi(n.charCodeAt(0)))"\r"===n&&"\n"===Di[Fi]&&++Fi;else switch(n){case"u":case"x":"{"===Di[Fi]?(++Fi,i+=Ki()):i+=Gi(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:ji(n)?(0!==(r="01234567".indexOf(n))&&(o=!0),Fi<Ni&&ji(Di[Fi])&&(o=!0,r=8*r+"01234567".indexOf(Di[Fi++]),"0123".indexOf(n)>=0&&Fi<Ni&&ji(Di[Fi])&&(r=8*r+"01234567".indexOf(Di[Fi++]))),i+=String.fromCharCode(r)):i+=n}else{if(Yi(n.charCodeAt(0)))break;i+=n}}return""!==t&&fo({},"Unexpected token %0",Bi),{type:8,value:i,octal:o,start:e,end:Fi}}():46===t?Ui(Di.charCodeAt(Fi+1))?to():Qi():Ui(t)?to():Qi()}function ro(){var t;return Fi=(t=Ii).end,Ii=no(),Fi=t.end,t}function io(){var t;t=Fi,Ii=no(),Fi=t}function oo(t,e,n){var r=new Ri("||"===t||"&&"===t?"LogicalExpression":"BinaryExpression");return r.operator=t,r.left=e,r.right=n,r}function ao(t,e){var n=new Ri("CallExpression");return n.callee=t,n.arguments=e,n}function so(t){var e=new Ri("Identifier");return e.name=t,e}function uo(t){var e=new Ri("Literal");return e.value=t.value,e.raw=Di.slice(t.start,t.end),t.regex&&("//"===e.raw&&(e.raw="/(?:)/"),e.regex=t.regex),e}function co(t,e,n){var r=new Ri("MemberExpression");return r.computed="["===t,r.object=e,r.property=n,r.computed||(n.member=!0),r}function lo(t,e,n){var r=new Ri("Property");return r.key=e,r.value=n,r.kind=t,r}function fo(t,e){var n,r=Array.prototype.slice.call(arguments,2),i=e.replace(/%(\d)/g,(function(t,e){return zi(e<r.length,"Message reference must be in range"),r[e]}));throw(n=new Error(i)).index=Fi,n.description=i,n}function ho(t){2===t.type&&fo(t,"Unexpected end of input"),6===t.type&&fo(t,"Unexpected number"),8===t.type&&fo(t,"Unexpected string"),3===t.type&&fo(t,"Unexpected identifier"),4===t.type&&fo(t,"Unexpected reserved word"),fo(t,"Unexpected token %0",t.value)}function po(t){var e=ro();7===e.type&&e.value===t||ho(e)}function mo(t){return 7===Ii.type&&Ii.value===t}function go(t){return 4===Ii.type&&Ii.value===t}function yo(){var t=[];for(Fi=Ii.start,po("[");!mo("]");)mo(",")?(ro(),t.push(null)):(t.push(Mo()),mo("]")||po(","));return ro(),function(t){var e=new Ri("ArrayExpression");return e.elements=t,e}(t)}function vo(){var t;return Fi=Ii.start,8===(t=ro()).type||6===t.type?(t.octal&&fo(t,"Octal literals are not allowed in strict mode."),uo(t)):so(t.value)}function bo(){var t,e,n;return Fi=Ii.start,3===(t=Ii).type?(n=vo(),po(":"),lo("init",n,Mo())):2!==t.type&&7!==t.type?(e=vo(),po(":"),lo("init",e,Mo())):void ho(t)}function wo(){var t,e,n=[],r={},i=String;for(Fi=Ii.start,po("{");!mo("}");)e="$"+("Identifier"===(t=bo()).key.type?t.key.name:i(t.key.value)),Object.prototype.hasOwnProperty.call(r,e)?fo({},"Duplicate data property in object literal not allowed in strict mode"):r[e]=!0,n.push(t),mo("}")||po(",");return po("}"),function(t){var e=new Ri("ObjectExpression");return e.properties=t,e}(n)}var Ao={if:1,this:1};function Eo(){var t,e,n;if(mo("("))return function(){var t;return po("("),t=ko(),po(")"),t}();if(mo("["))return yo();if(mo("{"))return wo();if(t=Ii.type,Fi=Ii.start,3===t||Ao[Ii.value])n=so(ro().value);else if(8===t||6===t)Ii.octal&&fo(Ii,"Octal literals are not allowed in strict mode."),n=uo(ro());else{if(4===t)throw new Error("Disabled.");1===t?((e=ro()).value="true"===e.value,n=uo(e)):5===t?((e=ro()).value=null,n=uo(e)):mo("/")||mo("/=")?(n=uo(eo()),io()):ho(ro())}return n}function xo(){var t=[];if(po("("),!mo(")"))for(;Fi<Ni&&(t.push(Mo()),!mo(")"));)po(",");return po(")"),t}function _o(){return po("."),Fi=Ii.start,function(t){return 3===t.type||4===t.type||1===t.type||5===t.type}(t=ro())||ho(t),so(t.value);var t}function Co(){var t;return po("["),t=ko(),po("]"),t}function To(){var t=function(){var t;for(t=Eo();;)if(mo("."))t=co(".",t,_o());else if(mo("("))t=ao(t,xo());else{if(!mo("["))break;t=co("[",t,Co())}return t}();if(7===Ii.type&&(mo("++")||mo("--")))throw new Error("Disabled.");return t}function Oo(){var t,e,n,r,i;if(7!==Ii.type&&4!==Ii.type)e=To();else{if(mo("++")||mo("--"))throw new Error("Disabled.");if(mo("+")||mo("-")||mo("~")||mo("!"))t=ro(),e=Oo(),n=t.value,r=e,(i=new Ri("UnaryExpression")).operator=n,i.argument=r,i.prefix=!0,e=i;else{if(go("delete")||go("void")||go("typeof"))throw new Error("Disabled.");e=To()}}return e}function So(t){var e=0;if(7!==t.type&&4!==t.type)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11}return e}function Mo(){var t,e;return t=function(){var t,e,n,r,i,o,a,s,u,c;if(t=Ii,u=Oo(),0===(i=So(r=Ii)))return u;for(r.prec=i,ro(),e=[t,Ii],o=[u,r,a=Oo()];(i=So(Ii))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)a=o.pop(),s=o.pop().value,u=o.pop(),e.pop(),n=oo(s,u,a),o.push(n);(r=ro()).prec=i,o.push(r),e.push(Ii),n=Oo(),o.push(n)}for(n=o[c=o.length-1],e.pop();c>1;)e.pop(),n=oo(o[c-1].value,o[c-2],n),c-=2;return n}(),mo("?")&&(ro(),e=Mo(),po(":"),t=function(t,e,n){var r=new Ri("ConditionalExpression");return r.test=t,r.consequent=e,r.alternate=n,r}(t,e,Mo())),t}function ko(){var t=Mo();if(mo(","))throw new Error("Disabled.");return t}var Do={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"},Fo=function(t){function e(e,n,r){return function(i){return function(e,n,r,i){var o=t(n[0]);return r&&(o=r+"("+o+")",0===r.lastIndexOf("new ",0)&&(o="("+o+")")),o+"."+e+(i<0?"":0===i?"()":"("+n.slice(1).map(t).join(",")+")")}(e,i,n,r)}}var n="new Date";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(e){e.length<3&&Object(V.d)("Missing arguments to clamp function."),e.length>3&&Object(V.d)("Too many arguments to clamp function.");var n=e.map(t);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:e("getDate",n,0),day:e("getDay",n,0),year:e("getFullYear",n,0),month:e("getMonth",n,0),hours:e("getHours",n,0),minutes:e("getMinutes",n,0),seconds:e("getSeconds",n,0),milliseconds:e("getMilliseconds",n,0),time:e("getTime",n,0),timezoneoffset:e("getTimezoneOffset",n,0),utcdate:e("getUTCDate",n,0),utcday:e("getUTCDay",n,0),utcyear:e("getUTCFullYear",n,0),utcmonth:e("getUTCMonth",n,0),utchours:e("getUTCHours",n,0),utcminutes:e("getUTCMinutes",n,0),utcseconds:e("getUTCSeconds",n,0),utcmilliseconds:e("getUTCMilliseconds",n,0),length:e("length",null,-1),join:e("join",null),indexof:e("indexOf",null),lastindexof:e("lastIndexOf",null),slice:e("slice",null),reverse:function(e){return"("+t(e[0])+").slice().reverse()"},parseFloat:"parseFloat",parseInt:"parseInt",upper:e("toUpperCase","String",0),lower:e("toLowerCase","String",0),substring:e("substring","String"),split:e("split","String"),replace:e("replace","String"),trim:e("trim","String",0),regexp:"RegExp",test:e("test","RegExp"),if:function(e){e.length<3&&Object(V.d)("Missing arguments to if function."),e.length>3&&Object(V.d)("Too many arguments to if function.");var n=e.map(t);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}};function No(t,e={}){const n=function(t){var e=(t=t||{}).whitelist?Object(V.w)(t.whitelist):{},n=t.blacklist?Object(V.w)(t.blacklist):{},r=t.constants||Do,i=(t.functions||Fo)(f),o=t.globalvar,a=t.fieldvar,s={},u={},c=0,l=Object(V.l)(o)?o:function(t){return o+'["'+t+'"]'};function f(t){if(Object(V.o)(t))return t;var e=h[t.type];return null==e&&Object(V.d)("Unsupported type: "+t.type),e(t)}var h={Literal:function(t){return t.raw},Identifier:function(t){var i=t.name;return c>0?i:Object(V.h)(n,i)?Object(V.d)("Illegal identifier: "+i):Object(V.h)(r,i)?r[i]:Object(V.h)(e,i)?i:(s[i]=1,l(i))},MemberExpression:function(t){var e=!t.computed,n=f(t.object);e&&(c+=1);var r=f(t.property);return n===a&&(u[function(t){var e=t&&t.length-1;return e&&('"'===t[0]&&'"'===t[e]||"'"===t[0]&&"'"===t[e])?t.slice(1,-1):t}(r)]=1),e&&(c-=1),n+(e?"."+r:"["+r+"]")},CallExpression:function(t){"Identifier"!==t.callee.type&&Object(V.d)("Illegal callee type: "+t.callee.type);var e=t.callee.name,n=t.arguments,r=Object(V.h)(i,e)&&i[e];return r||Object(V.d)("Unrecognized function: "+e),Object(V.l)(r)?r(n):r+"("+n.map(f).join(",")+")"},ArrayExpression:function(t){return"["+t.elements.map(f).join(",")+"]"},BinaryExpression:function(t){return"("+f(t.left)+t.operator+f(t.right)+")"},UnaryExpression:function(t){return"("+t.operator+f(t.argument)+")"},ConditionalExpression:function(t){return"("+f(t.test)+"?"+f(t.consequent)+":"+f(t.alternate)+")"},LogicalExpression:function(t){return"("+f(t.left)+t.operator+f(t.right)+")"},ObjectExpression:function(t){return"{"+t.properties.map(f).join(",")+"}"},Property:function(t){c+=1;var e=f(t.key);return c-=1,e+":"+f(t.value)}};function d(t){var e={code:f(t),globals:Object.keys(s),fields:Object.keys(u)};return s={},u={},e}return d.functions=i,d.constants=r,d}({blacklist:[],whitelist:["datum"],globalvar:"global",fieldvar:"datum"});try{const r=n(function(t){Fi=0,Ni=(Di=t).length,Ii=null,io();var e=ko();if(2!==Ii.type)throw new Error("Unexpect token after expression.");return e}(t)),i=Function("datum","global",`"use strict"; return (${r.code});`),o=t=>i(t,e);return o.fields=r.fields,o}catch(e){throw new Error(`Invalid expression: ${t}, ${e.message}`)}}function Io(t,e){return t.length==e.length&&t.every((t,n)=>e[n]==t)}function Ro(t){return Array.isArray(t)?t:void 0!==t?[t]:[]}function Bo(t,e){const n=t.map(t=>t.length);if(!n.every(t=>t==n[0]))throw new Error("Mismatching number of elements in the fields to be split: "+JSON.stringify(e))}var Lo=function(t){return t};function Po(t,e,n,r){return function t(i,o){if(o>=r.length)return n(i);const a=new Map,s=r[o++];let u=-1;for(const t of i){const e=s(t,++u,i),n=a.get(e);n?n.push(t):a.set(e,[t])}for(const[e,n]of a)a.set(e,t(n,o));return e(a)}(t,0)}function zo(t,e){let n=0;if(void 0===e)for(let e of t)(e=+e)&&(n+=e);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&(n+=i)}return n}var Uo={equalize:function(t,e){const n=Object(V.g)(t.field),r=t.as||t.field,i=function(t,e){const n=function(t,e){const n=[...t.filter(t=>"number"==typeof t&&!isNaN(t))].sort((t,e)=>t-e),r=[];for(let t=0;t<=e;t++)r.push(n[Math.floor((n.length-1)*t/e)]);return r}(t,e),r=n.length;function i(t){const e=Mn(n,t)-1;if(e==r-1)return 1;if(-1==e)return 0;{const i=n[e];return(e+(t-i)/(n[e+1]-i))/(r-1)}}return i.buckets=n,i}(e.map(n),t.buckets||50);return e.map(t=>({...t,[r]:i(n(t))}))},filter:function(t,e){return e.filter(No(t.expr))},flattenDelimited:function(t,e){const n=[],r=Ro(t.field),i=Ro(t.separator),o=Ro(t.as||t.field);if(r.length!==i.length||r.length!==o.length)throw new Error(`Lengths of "separator" (${i.length}), "fields" (${r.length}), and "as" (${o.length}) do not match!`);if(r.length){for(const t of e){if(r.some(e=>!t[e]))continue;const e=r.map((e,n)=>t[e].split(i[n]));Bo(e,t);const a=e[0].length;for(let i=0;i<a;i++){const a={...t};for(let t=0;t<r.length;t++)a[o[t]]=e[t][i];n.push(a)}}return n}},formula:function(t,e){const n=No(t.expr);if(t.inplace){for(const r of e)r[t.as]=n(r);return e}return e.map(e=>({...e,[t.as]:n(e)}))},gather:function(t,e){if(0==e.length)return[];const n=new RegExp(t.columnRegex),r=function(t,e){const n=new RegExp(t.columnRegex),r=Object.keys(e[0]).filter(t=>n.test(t)),i=new Map;for(const o of r){const r=n.exec(o)[1],a=e.map(e=>({[t.asValue]:e[o]}));i.set(r,a)}return i}(t,e),i=e.map(t=>{const e={};for(const r of Object.keys(t))n.test(r)||(e[r]=t[r]);return e}),o=[];for(const[e,n]of r.entries())for(let r=0;r<n.length;r++)o.push({[t.asKey||"sample"]:e,...i[r],...n[r]});return o},regexExtract:function(t,e){const n=new RegExp(t.regex),r="string"==typeof t.as?[t.as]:t.as;return e.map(e=>{const i={...e},o=e[t.field];if("string"==typeof o){const e=o.match(n);if(e){if(e.length-1!=r.length)throw new Error('The number of RegEx groups and the length of "as" do not match!');r.forEach((t,n)=>{i[t]=e[n+1]})}else if(!t.skipInvalidInput)throw new Error(`"${o}" does not match the given regex: ${n.toString()}`)}else if(!t.skipInvalidInput)throw new Error(`Trying to match a non-string field. Encountered type: ${typeof o}`);return i})},simpleFilter:function(t,e){return e.filter(function(t){const e=t.value,n=e=>e[t.field];switch(t.operator){case"eq":return t=>n(t)==e;case"neq":return t=>n(t)!=e;case"lt":return t=>n(t)<e;case"lte":return t=>n(t)<=e;case"gte":return t=>n(t)>=e;case"gt":return t=>n(t)>e;default:throw new Error(`Unknown operator: ${t.operator}`)}}(t))},stack:function(t,e){const n=[],r=t.as||["y0","y1"],i=t.groupby.map(V.g),o=function(t,...e){return Po(t,Array.from,Lo,e)}(e,t=>i.map(e=>e(t)).join()).map(t=>t[1]),a=t.field?Object(V.g)(t.field):t=>1,s=t.sort?Object(V.b)(t.sort.field,t.sort.order):void 0,u="normalize"==t.offset?(t,e)=>t/e:"center"==t.offset?(t,e)=>t-e/2:(t,e)=>t;for(const t of o){s&&t.sort(s);const e=zo(t,a);let i=0;for(const o of t){const t=i+a(o);n.push({...o,[r[0]]:u(i,e),[r[1]]:u(t,e)}),i=t}}return n}};class Wo{constructor(t,e,n,r){this.context=e,this.parent=n,this.name=t.name||r,this.spec=t,this.children=[],this.resolutions={}}getPathString(){const t=[];let e=this;do{t.push(e.name),e=e.parent}while(e);return t.reverse().join("/")}visit(t){try{const e=t(this);if(void 0!==e)return e}catch(t){throw t.view=this,t}for(const e of this.children){const n=e.visit(t);if(void 0!==n)return n}t.afterChildren&&t.afterChildren(this)}getEncoding(){return{...this.parent?this.parent.getEncoding():{},...this.spec.encoding||{}}}getResolution(t){return this.resolutions[t]||this.parent&&this.parent.getResolution(t)||void 0}getBaseUrl(){let t=this;for(;t;){if(t.spec.baseUrl)return t.spec.baseUrl;t=t.parent}}getData(){if(this.data)return this.data;if(this.parent)return this.parent.getData();throw new Error(`No data are available at ${this.getPathString()} or its parents.`)}async loadData(){this.spec.data&&(this.data=await this.context.getDataSource(this.spec.data,this.getBaseUrl()).getData())}transformData(){this.spec.transform&&(this.data=function(t,e){for(const n of t){const t=n.type;if(!t)throw new Error("Type not defined in transformConfig!");if("ungroup"==t)e=e.ungroup();else{const r=Uo[t];if(!r)throw new Error(`Unknown transformer type: ${t}`);e=e.map(t=>r(n,t))}}return e}(this.spec.transform,this.getData()))}}class jo extends Wo{constructor(t,e,n,r){super(t,e,n,r),this.spec=t}}
/* @license twgl.js 4.14.2 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
Available via the MIT license.
see: http://github.com/greggman/twgl.js for details */let Ho=Float32Array;function Yo(t,e,n){const r=new Ho(3);return t&&(r[0]=t),e&&(r[1]=e),n&&(r[2]=n),r}function $o(t,e,n){return(n=n||new Ho(3))[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n}function qo(t,e,n){return(n=n||new Ho(3))[0]=t[0]*e[0],n[1]=t[1]*e[1],n[2]=t[2]*e[2],n}let Xo=Float32Array;function Vo(t){return(t=t||new Xo(16))[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Go(t,e){e=e||new Xo(16);const n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],h=t[10],d=t[11],p=t[12],m=t[13],g=t[14],y=t[15],v=h*y,b=g*d,w=u*y,A=g*c,E=u*d,x=h*c,_=i*y,C=g*o,T=i*d,O=h*o,S=i*c,M=u*o,k=l*m,D=p*f,F=a*m,N=p*s,I=a*f,R=l*s,B=n*m,L=p*r,P=n*f,z=l*r,U=n*s,W=a*r,j=v*s+A*f+E*m-(b*s+w*f+x*m),H=b*r+_*f+O*m-(v*r+C*f+T*m),Y=w*r+C*s+S*m-(A*r+_*s+M*m),$=x*r+T*s+M*f-(E*r+O*s+S*f),q=1/(n*j+a*H+l*Y+p*$);return e[0]=q*j,e[1]=q*H,e[2]=q*Y,e[3]=q*$,e[4]=q*(b*a+w*l+x*p-(v*a+A*l+E*p)),e[5]=q*(v*n+C*l+T*p-(b*n+_*l+O*p)),e[6]=q*(A*n+_*a+M*p-(w*n+C*a+S*p)),e[7]=q*(E*n+O*a+S*l-(x*n+T*a+M*l)),e[8]=q*(k*c+N*d+I*y-(D*c+F*d+R*y)),e[9]=q*(D*o+B*d+z*y-(k*o+L*d+P*y)),e[10]=q*(F*o+L*c+U*y-(N*o+B*c+W*y)),e[11]=q*(R*o+P*c+W*d-(I*o+z*c+U*d)),e[12]=q*(F*h+R*g+D*u-(I*g+k*u+N*h)),e[13]=q*(P*g+k*i+L*h-(B*h+z*g+D*i)),e[14]=q*(B*u+W*g+N*i-(U*g+F*i+L*u)),e[15]=q*(U*h+I*i+z*u-(P*u+W*h+R*i)),e}function Ko(t,e,n){n=n||Yo();const r=e[0],i=e[1],o=e[2],a=r*t[3]+i*t[7]+o*t[11]+t[15];return n[0]=(r*t[0]+i*t[4]+o*t[8]+t[12])/a,n[1]=(r*t[1]+i*t[5]+o*t[9]+t[13])/a,n[2]=(r*t[2]+i*t[6]+o*t[10]+t[14])/a,n}function Zo(t,e,n){n=n||Yo();const r=e[0],i=e[1],o=e[2];return n[0]=r*t[0]+i*t[4]+o*t[8],n[1]=r*t[1]+i*t[5]+o*t[9],n[2]=r*t[2]+i*t[6]+o*t[10],n}const Jo={};{const t=Jo;t[5120]=Int8Array,t[5121]=Uint8Array,t[5122]=Int16Array,t[5123]=Uint16Array,t[5124]=Int32Array,t[5125]=Uint32Array,t[5126]=Float32Array,t[32819]=Uint16Array,t[32820]=Uint16Array,t[33635]=Uint16Array,t[5131]=Uint16Array,t[33640]=Uint32Array,t[35899]=Uint32Array,t[35902]=Uint32Array,t[36269]=Uint32Array,t[34042]=Uint32Array}function Qo(t){if(t instanceof Int8Array)return 5120;if(t instanceof Uint8Array)return 5121;if(t instanceof Uint8ClampedArray)return 5121;if(t instanceof Int16Array)return 5122;if(t instanceof Uint16Array)return 5123;if(t instanceof Int32Array)return 5124;if(t instanceof Uint32Array)return 5125;if(t instanceof Float32Array)return 5126;throw new Error("unsupported typed array type")}function ta(t){if(t===Int8Array)return 5120;if(t===Uint8Array)return 5121;if(t===Uint8ClampedArray)return 5121;if(t===Int16Array)return 5122;if(t===Uint16Array)return 5123;if(t===Int32Array)return 5124;if(t===Uint32Array)return 5125;if(t===Float32Array)return 5126;throw new Error("unsupported typed array type")}const ea="undefined"!=typeof SharedArrayBuffer?function(t){return t&&t.buffer&&(t.buffer instanceof ArrayBuffer||t.buffer instanceof SharedArrayBuffer)}:function(t){return t&&t.buffer&&t.buffer instanceof ArrayBuffer};function na(...t){console.error(...t)}function ra(...t){console.warn(...t)}function ia(t,e){return"undefined"!=typeof WebGLTexture&&e instanceof WebGLTexture}const oa={attribPrefix:""};function aa(t,e,n,r,i){t.bindBuffer(e,n),t.bufferData(e,r,i||35044)}function sa(t,e,n,r){if(i=e,"undefined"!=typeof WebGLBuffer&&i instanceof WebGLBuffer)return e;var i;n=n||34962;const o=t.createBuffer();return aa(t,n,o,e,r),o}function ua(t){return"indices"===t}function ca(t){return t.length?t:t.data}const la=/coord|texture/i,fa=/color|colour/i;function ha(t,e){let n;if(n=la.test(t)?2:fa.test(t)?4:3,e%n>0)throw new Error(`Can not guess numComponents for attribute '${t}'. Tried ${n} but ${e} values is not evenly divisible by ${n}. You should specify it.`);return n}function da(t,e){return t.numComponents||t.size||ha(e,ca(t).length)}function pa(t,e){if(ea(t))return t;if(ea(t.data))return t.data;Array.isArray(t)&&(t={data:t});let n=t.type;return n||(n=ua(e)?Uint16Array:Float32Array),new n(t.data)}function ma(t,e){const n={};return Object.keys(e).forEach((function(r){if(!ua(r)){const o=e[r],a=o.attrib||o.name||o.attribName||oa.attribPrefix+r;if(o.value){if(!Array.isArray(o.value)&&!ea(o.value))throw new Error("array.value is not array or typedarray");n[a]={value:o.value}}else{let e,s,u,c;if(o.buffer&&o.buffer instanceof WebGLBuffer)e=o.buffer,c=o.numComponents||o.size,s=o.type,u=o.normalize;else if("number"==typeof o||"number"==typeof o.data){const n=o.data||o,a=o.type||Float32Array,l=n*a.BYTES_PER_ELEMENT;s=ta(a),u=void 0!==o.normalize?o.normalize:(i=a)===Int8Array||i===Uint8Array,c=o.numComponents||o.size||ha(r,n),e=t.createBuffer(),t.bindBuffer(34962,e),t.bufferData(34962,l,o.drawType||35044)}else{const n=pa(o,r);e=sa(t,n,void 0,o.drawType),s=Qo(n),u=void 0!==o.normalize?o.normalize:function(t){return t instanceof Int8Array||t instanceof Uint8Array}(n),c=da(o,r)}n[a]={buffer:e,numComponents:c,type:s,normalize:u,stride:o.stride||0,offset:o.offset||0,divisor:void 0===o.divisor?void 0:o.divisor,drawType:o.drawType}}}var i})),t.bindBuffer(34962,null),n}const ga=["position","positions","a_position"];function ya(t,e,n){const r=ma(t,e),i=Object.assign({},n||{});i.attribs=Object.assign({},n?n.attribs:{},r);const o=e.indices;if(o){const e=pa(o,"indices");i.indices=sa(t,e,34963),i.numElements=e.length,i.elementType=Qo(e)}else i.numElements||(i.numElements=function(t,e){let n,r;for(r=0;r<ga.length&&(n=ga[r],!(n in e))&&(n=oa.attribPrefix+n,!(n in e));++r);r===ga.length&&(n=Object.keys(e)[0]);const i=e[n];t.bindBuffer(34962,i.buffer);const o=t.getBufferParameter(34962,34660);var a;t.bindBuffer(34962,null);const s=o/(5120===(a=i.type)?1:5121===a?1:5122===a?2:5123===a?2:5124===a?4:5125===a?4:5126===a?4:0),u=i.numComponents||i.size,c=s/u;if(c%1!=0)throw new Error(`numComponents ${u} not correct for length ${length}`);return c}(t,i.attribs));return i}function va(t,e,n){const r="indices"===n?34963:34962;return sa(t,pa(e,n),r)}function ba(t,e){const n={};return Object.keys(e).forEach((function(r){n[r]=va(t,e[r],r)})),e.indices?(n.numElements=e.indices.length,n.elementType=Qo(pa(e.indices))):n.numElements=function(t){let e,n;for(n=0;n<ga.length&&(e=ga[n],!(e in t));++n);n===ga.length&&(e=Object.keys(t)[0]);const r=t[e],i=ca(r).length,o=da(r,e),a=i/o;if(i%o>0)throw new Error(`numComponents ${o} not correct for length ${i}`);return a}(e),n}function wa(t,e){let n=0;return t.push=function(){for(let e=0;e<arguments.length;++e){const r=arguments[e];if(r instanceof Array||ea(r))for(let e=0;e<r.length;++e)t[n++]=r[e];else t[n++]=r}},t.reset=function(t){n=t||0},t.numComponents=e,Object.defineProperty(t,"numElements",{get:function(){return this.length/this.numComponents|0}}),t}function Aa(t,e,n){return wa(new(n||Float32Array)(t*e),t)}function Ea(t,e,n){const r=t.length,i=new Float32Array(3);for(let o=0;o<r;o+=3)n(e,[t[o],t[o+1],t[o+2]],i),t[o]=i[0],t[o+1]=i[1],t[o+2]=i[2]}function xa(t,e,n){n=n||Yo();const r=e[0],i=e[1],o=e[2];return n[0]=r*t[0]+i*t[1]+o*t[2],n[1]=r*t[4]+i*t[5]+o*t[6],n[2]=r*t[8]+i*t[9]+o*t[10],n}function _a(t,e){return Ea(t,e,Zo),t}function Ca(t,e){return Ea(t,Go(e),xa),t}function Ta(t,e){return Ea(t,e,Ko),t}function Oa(t,e){return Object.keys(t).forEach((function(n){const r=t[n];n.indexOf("pos")>=0?Ta(r,e):n.indexOf("tan")>=0||n.indexOf("binorm")>=0?_a(r,e):n.indexOf("norm")>=0&&Ca(r,e)})),t}function Sa(t,e,n){return t=t||2,{position:{numComponents:2,data:[(e=e||0)+-1*(t*=.5),(n=n||0)+-1*t,e+1*t,n+-1*t,e+-1*t,n+1*t,e+1*t,n+1*t]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function Ma(t,e,n,r,i){t=t||1,e=e||1,n=n||1,r=r||1,i=i||Vo();const o=(n+1)*(r+1),a=Aa(3,o),s=Aa(3,o),u=Aa(2,o);for(let i=0;i<=r;i++)for(let o=0;o<=n;o++){const c=o/n,l=i/r;a.push(t*c-.5*t,0,e*l-.5*e),s.push(0,1,0),u.push(c,l)}const c=n+1,l=Aa(3,n*r*2,Uint16Array);for(let t=0;t<r;t++)for(let e=0;e<n;e++)l.push((t+0)*c+e,(t+1)*c+e,(t+0)*c+e+1),l.push((t+1)*c+e,(t+1)*c+e+1,(t+0)*c+e+1);return Oa({position:a,normal:s,texcoord:u,indices:l},i)}function ka(t,e,n,r,i,o,a){if(e<=0||n<=0)throw new Error("subdivisionAxis and subdivisionHeight must be > 0");r=r||0,o=o||0;const s=(i=i||Math.PI)-r,u=(a=a||2*Math.PI)-o,c=(e+1)*(n+1),l=Aa(3,c),f=Aa(3,c),h=Aa(2,c);for(let i=0;i<=n;i++)for(let a=0;a<=e;a++){const c=a/e,d=i/n,p=u*c+o,m=s*d+r,g=Math.sin(p),y=Math.cos(p),v=Math.sin(m),b=y*v,w=Math.cos(m),A=g*v;l.push(t*b,t*w,t*A),f.push(b,w,A),h.push(1-c,d)}const d=e+1,p=Aa(3,e*n*2,Uint16Array);for(let t=0;t<e;t++)for(let e=0;e<n;e++)p.push((e+0)*d+t,(e+0)*d+t+1,(e+1)*d+t),p.push((e+1)*d+t,(e+0)*d+t+1,(e+1)*d+t+1);return{position:l,normal:f,texcoord:h,indices:p}}const Da=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];function Fa(t){const e=(t=t||1)/2,n=[[-e,-e,-e],[+e,-e,-e],[-e,+e,-e],[+e,+e,-e],[-e,-e,+e],[+e,-e,+e],[-e,+e,+e],[+e,+e,+e]],r=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],i=[[1,0],[0,0],[0,1],[1,1]],o=Aa(3,24),a=Aa(3,24),s=Aa(2,24),u=Aa(3,12,Uint16Array);for(let t=0;t<6;++t){const e=Da[t];for(let u=0;u<4;++u){const c=n[e[u]],l=r[t],f=i[u];o.push(c),a.push(l),s.push(f)}const c=4*t;u.push(c+0,c+1,c+2),u.push(c+0,c+2,c+3)}return{position:o,normal:a,texcoord:s,indices:u}}function Na(t,e,n,r,i,o,a){if(r<3)throw new Error("radialSubdivisions must be 3 or greater");if(i<1)throw new Error("verticalSubdivisions must be 1 or greater");const s=void 0===o||o,u=void 0===a||a,c=(s?2:0)+(u?2:0),l=(r+1)*(i+1+c),f=Aa(3,l),h=Aa(3,l),d=Aa(2,l),p=Aa(3,r*(i+c)*2,Uint16Array),m=r+1,g=Math.atan2(t-e,n),y=Math.cos(g),v=Math.sin(g),b=i+(u?2:0);for(let o=s?-2:0;o<=b;++o){let a,s=o/i,u=n*s;o<0?(u=0,s=1,a=t):o>i?(u=n,s=1,a=e):a=t+o/i*(e-t),-2!==o&&o!==i+2||(a=0,s=0),u-=n/2;for(let t=0;t<m;++t){const e=Math.sin(t*Math.PI*2/r),n=Math.cos(t*Math.PI*2/r);f.push(e*a,u,n*a),o<0?h.push(0,-1,0):o>i?h.push(0,1,0):0===a?h.push(0,0,0):h.push(e*y,v,n*y),d.push(t/r,1-s)}}for(let t=0;t<i+c;++t)for(let e=0;e<r;++e)p.push(m*(t+0)+0+e,m*(t+0)+1+e,m*(t+1)+1+e),p.push(m*(t+0)+0+e,m*(t+1)+1+e,m*(t+1)+0+e);return{position:f,normal:h,texcoord:d,indices:p}}function Ia(t,e){e=e||[];const n=[];for(let r=0;r<t.length;r+=4){const i=t[r],o=t.slice(r+1,r+4);o.push.apply(o,e);for(let t=0;t<i;++t)n.push.apply(n,o)}return n}function Ra(){const t=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],e=Ia([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),n=Ia([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),r=t.length/3,i={position:Aa(3,r),texcoord:Aa(2,r),normal:Aa(3,r),color:Aa(4,r,Uint8Array),indices:Aa(3,r/3,Uint16Array)};i.position.push(t),i.texcoord.push([.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0]),i.normal.push(e),i.color.push(n);for(let t=0;t<r;++t)i.indices.push(t);return i}function Ba(t,e,n,r,i,o,a){if(i<=0)throw new Error("subdivisionDown must be > 0");const s=(a=a||1)-(o=o||0),u=2*(i+1)*4,c=Aa(3,u),l=Aa(3,u),f=Aa(2,u);function h(t,e,n){return t+(e-t)*n}function d(e,n,a,u,d,p){for(let m=0;m<=i;m++){const g=n/1,y=m/i,v=2*(g-.5),b=(o+y*s)*Math.PI,w=Math.sin(b),A=Math.cos(b),E=h(t,e,w),x=v*r,_=A*t,C=w*E;c.push(x,_,C);const T=$o(qo([0,w,A],a),u);l.push(T),f.push(g*d+p,y)}}for(let t=0;t<2;t++){const r=2*(t/1-.5);d(e,t,[1,1,1],[0,0,0],1,0),d(e,t,[0,0,0],[r,0,0],0,0),d(n,t,[1,1,1],[0,0,0],1,0),d(n,t,[0,0,0],[r,0,0],0,1)}const p=Aa(3,2*i*4,Uint16Array);function m(t,e){for(let n=0;n<i;++n)p.push(t+n+0,t+n+1,e+n+0),p.push(t+n+1,e+n+1,e+n+0)}const g=i+1;return m(0*g,4*g),m(5*g,7*g),m(6*g,2*g),m(3*g,1*g),{position:c,normal:l,texcoord:f,indices:p}}function La(t,e,n,r,i,o){return Na(t,t,e,n,r,i,o)}function Pa(t,e,n,r,i,o){if(n<3)throw new Error("radialSubdivisions must be 3 or greater");if(r<3)throw new Error("verticalSubdivisions must be 3 or greater");i=i||0;const a=(o=o||2*Math.PI)-i,s=n+1,u=r+1,c=s*u,l=Aa(3,c),f=Aa(3,c),h=Aa(2,c),d=Aa(3,n*r*2,Uint16Array);for(let o=0;o<u;++o){const u=o/r,c=u*Math.PI*2,d=Math.sin(c),p=t+d*e,m=Math.cos(c),g=m*e;for(let t=0;t<s;++t){const e=t/n,r=i+e*a,o=Math.sin(r),s=Math.cos(r),c=o*p,y=s*p,v=o*d,b=s*d;l.push(c,g,y),f.push(v,m,b),h.push(e,1-u)}}for(let t=0;t<r;++t)for(let e=0;e<n;++e){const n=1+e,r=1+t;d.push(s*t+e,s*r+e,s*t+n),d.push(s*r+e,s*r+n,s*t+n)}return{position:l,normal:f,texcoord:h,indices:d}}function za(t,e,n,r,i){if(e<3)throw new Error("divisions must be at least 3");i=i||1,r=r||0;const o=(e+1)*((n=n||1)+1),a=Aa(3,o),s=Aa(3,o),u=Aa(2,o),c=Aa(3,n*e*2,Uint16Array);let l=0;const f=t-r,h=e+1;for(let t=0;t<=n;++t){const o=r+f*Math.pow(t/n,i);for(let r=0;r<=e;++r){const i=2*Math.PI*r/e,f=o*Math.cos(i),d=o*Math.sin(i);if(a.push(f,0,d),s.push(0,1,0),u.push(1-r/e,t/n),t>0&&r!==e){const t=l+(r+1),e=l+r,n=l+r-h,i=l+(r+1)-h;c.push(t,e,n),c.push(t,n,i)}}l+=e+1}return{position:a,normal:s,texcoord:u,indices:c}}function Ua(t){return function(e){const n=t.apply(this,Array.prototype.slice.call(arguments,1));return ba(e,n)}}function Wa(t){return function(e){const n=t.apply(null,Array.prototype.slice.call(arguments,1));return ya(e,n)}}Wa(Ra),Ua(Ra),Wa(Fa),Ua(Fa),Wa(Ma),Ua(Ma),Wa(ka),Ua(ka),Wa(Na),Ua(Na),Wa(Sa),Ua(Sa),Wa(Ba),Ua(Ba),Wa(La),Ua(La),Wa(Pa),Ua(Pa),Wa(za),Ua(za);function ja(t){return!!t.texStorage2D}const Ha=function(){const t={},e={};return function(n,r){return function(n){const r=n.constructor.name;if(!t[r]){for(const t in n)if("number"==typeof n[t]){const r=e[n[t]];e[n[t]]=r?`${r} | ${t}`:t}t[r]=!0}}(n),e[r]||"0x"+r.toString(16)}}();new Uint8Array([128,192,255,255]);const Ya=6407,$a=33319,qa={};{const t=qa;t[6406]={numColorComponents:1},t[6409]={numColorComponents:1},t[6410]={numColorComponents:2},t[Ya]={numColorComponents:3},t[6408]={numColorComponents:4},t[6403]={numColorComponents:1},t[36244]={numColorComponents:1},t[$a]={numColorComponents:2},t[33320]={numColorComponents:2},t[Ya]={numColorComponents:3},t[36248]={numColorComponents:3},t[6408]={numColorComponents:4},t[36249]={numColorComponents:4},t[6402]={numColorComponents:1},t[34041]={numColorComponents:2}}const Xa=na;function Va(t){return"undefined"!=typeof document&&document.getElementById?document.getElementById(t):null}const Ga={};function Ka(t,e){return Ga[e].bindPoint}function Za(t,e){return function(n){t.uniform1i(e,n)}}function Ja(t,e){return function(n){t.uniform1iv(e,n)}}function Qa(t,e){return function(n){t.uniform2iv(e,n)}}function ts(t,e){return function(n){t.uniform3iv(e,n)}}function es(t,e){return function(n){t.uniform4iv(e,n)}}function ns(t,e,n,r){const i=Ka(0,e);return ja(t)?function(e){let o,a;ia(0,e)?(o=e,a=null):(o=e.texture,a=e.sampler),t.uniform1i(r,n),t.activeTexture(33984+n),t.bindTexture(i,o),t.bindSampler(n,a)}:function(e){t.uniform1i(r,n),t.activeTexture(33984+n),t.bindTexture(i,e)}}function rs(t,e,n,r,i){const o=Ka(0,e),a=new Int32Array(i);for(let t=0;t<i;++t)a[t]=n+t;return ja(t)?function(e){t.uniform1iv(r,a),e.forEach((function(e,r){let i,s;t.activeTexture(33984+a[r]),ia(0,e)?(i=e,s=null):(i=e.texture,s=e.sampler),t.bindSampler(n,s),t.bindTexture(o,i)}))}:function(e){t.uniform1iv(r,a),e.forEach((function(e,n){t.activeTexture(33984+a[n]),t.bindTexture(o,e)}))}}function is(t,e){return function(n){if(n.value)switch(t.disableVertexAttribArray(e),n.value.length){case 4:t.vertexAttrib4fv(e,n.value);break;case 3:t.vertexAttrib3fv(e,n.value);break;case 2:t.vertexAttrib2fv(e,n.value);break;case 1:t.vertexAttrib1fv(e,n.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else t.bindBuffer(34962,n.buffer),t.enableVertexAttribArray(e),t.vertexAttribPointer(e,n.numComponents||n.size,n.type||5126,n.normalize||!1,n.stride||0,n.offset||0),void 0!==n.divisor&&t.vertexAttribDivisor(e,n.divisor)}}function os(t,e){return function(n){if(n.value){if(t.disableVertexAttribArray(e),4!==n.value.length)throw new Error("The length of an integer constant value must be 4!");t.vertexAttrib4iv(e,n.value)}else t.bindBuffer(34962,n.buffer),t.enableVertexAttribArray(e),t.vertexAttribIPointer(e,n.numComponents||n.size,n.type||5124,n.stride||0,n.offset||0),void 0!==n.divisor&&t.vertexAttribDivisor(e,n.divisor)}}function as(t,e){return function(n){if(n.value){if(t.disableVertexAttribArray(e),4!==n.value.length)throw new Error("The length of an unsigned integer constant value must be 4!");t.vertexAttrib4uiv(e,n.value)}else t.bindBuffer(34962,n.buffer),t.enableVertexAttribArray(e),t.vertexAttribIPointer(e,n.numComponents||n.size,n.type||5125,n.stride||0,n.offset||0),void 0!==n.divisor&&t.vertexAttribDivisor(e,n.divisor)}}function ss(t,e,n){const r=n.size,i=n.count;return function(n){t.bindBuffer(34962,n.buffer);const o=n.size||n.numComponents||r,a=o/i,s=n.type||5126,u=Ga[s].size*o,c=n.normalize||!1,l=n.offset||0,f=u/i;for(let r=0;r<i;++r)t.enableVertexAttribArray(e+r),t.vertexAttribPointer(e+r,a,s,c,u,l+f*r),void 0!==n.divisor&&t.vertexAttribDivisor(e+r,n.divisor)}}Ga[5126]={Type:Float32Array,size:4,setter:function(t,e){return function(n){t.uniform1f(e,n)}},arraySetter:function(t,e){return function(n){t.uniform1fv(e,n)}}},Ga[35664]={Type:Float32Array,size:8,setter:function(t,e){return function(n){t.uniform2fv(e,n)}}},Ga[35665]={Type:Float32Array,size:12,setter:function(t,e){return function(n){t.uniform3fv(e,n)}}},Ga[35666]={Type:Float32Array,size:16,setter:function(t,e){return function(n){t.uniform4fv(e,n)}}},Ga[5124]={Type:Int32Array,size:4,setter:Za,arraySetter:Ja},Ga[35667]={Type:Int32Array,size:8,setter:Qa},Ga[35668]={Type:Int32Array,size:12,setter:ts},Ga[35669]={Type:Int32Array,size:16,setter:es},Ga[5125]={Type:Uint32Array,size:4,setter:function(t,e){return function(n){t.uniform1ui(e,n)}},arraySetter:function(t,e){return function(n){t.uniform1uiv(e,n)}}},Ga[36294]={Type:Uint32Array,size:8,setter:function(t,e){return function(n){t.uniform2uiv(e,n)}}},Ga[36295]={Type:Uint32Array,size:12,setter:function(t,e){return function(n){t.uniform3uiv(e,n)}}},Ga[36296]={Type:Uint32Array,size:16,setter:function(t,e){return function(n){t.uniform4uiv(e,n)}}},Ga[35670]={Type:Uint32Array,size:4,setter:Za,arraySetter:Ja},Ga[35671]={Type:Uint32Array,size:8,setter:Qa},Ga[35672]={Type:Uint32Array,size:12,setter:ts},Ga[35673]={Type:Uint32Array,size:16,setter:es},Ga[35674]={Type:Float32Array,size:16,setter:function(t,e){return function(n){t.uniformMatrix2fv(e,!1,n)}}},Ga[35675]={Type:Float32Array,size:36,setter:function(t,e){return function(n){t.uniformMatrix3fv(e,!1,n)}}},Ga[35676]={Type:Float32Array,size:64,setter:function(t,e){return function(n){t.uniformMatrix4fv(e,!1,n)}}},Ga[35685]={Type:Float32Array,size:24,setter:function(t,e){return function(n){t.uniformMatrix2x3fv(e,!1,n)}}},Ga[35686]={Type:Float32Array,size:32,setter:function(t,e){return function(n){t.uniformMatrix2x4fv(e,!1,n)}}},Ga[35687]={Type:Float32Array,size:24,setter:function(t,e){return function(n){t.uniformMatrix3x2fv(e,!1,n)}}},Ga[35688]={Type:Float32Array,size:48,setter:function(t,e){return function(n){t.uniformMatrix3x4fv(e,!1,n)}}},Ga[35689]={Type:Float32Array,size:32,setter:function(t,e){return function(n){t.uniformMatrix4x2fv(e,!1,n)}}},Ga[35690]={Type:Float32Array,size:48,setter:function(t,e){return function(n){t.uniformMatrix4x3fv(e,!1,n)}}},Ga[35678]={Type:null,size:0,setter:ns,arraySetter:rs,bindPoint:3553},Ga[35680]={Type:null,size:0,setter:ns,arraySetter:rs,bindPoint:34067},Ga[35679]={Type:null,size:0,setter:ns,arraySetter:rs,bindPoint:32879},Ga[35682]={Type:null,size:0,setter:ns,arraySetter:rs,bindPoint:3553},Ga[36289]={Type:null,size:0,setter:ns,arraySetter:rs,bindPoint:35866},Ga[36292]={Type:null,size:0,setter:ns,arraySetter:rs,bindPoint:35866},Ga[36293]={Type:null,size:0,setter:ns,arraySetter:rs,bindPoint:34067},Ga[36298]={Type:null,size:0,setter:ns,arraySetter:rs,bindPoint:3553},Ga[36299]={Type:null,size:0,setter:ns,arraySetter:rs,bindPoint:32879},Ga[36300]={Type:null,size:0,setter:ns,arraySetter:rs,bindPoint:34067},Ga[36303]={Type:null,size:0,setter:ns,arraySetter:rs,bindPoint:35866},Ga[36306]={Type:null,size:0,setter:ns,arraySetter:rs,bindPoint:3553},Ga[36307]={Type:null,size:0,setter:ns,arraySetter:rs,bindPoint:32879},Ga[36308]={Type:null,size:0,setter:ns,arraySetter:rs,bindPoint:34067},Ga[36311]={Type:null,size:0,setter:ns,arraySetter:rs,bindPoint:35866};const us={};us[5126]={size:4,setter:is},us[35664]={size:8,setter:is},us[35665]={size:12,setter:is},us[35666]={size:16,setter:is},us[5124]={size:4,setter:os},us[35667]={size:8,setter:os},us[35668]={size:12,setter:os},us[35669]={size:16,setter:os},us[5125]={size:4,setter:as},us[36294]={size:8,setter:as},us[36295]={size:12,setter:as},us[36296]={size:16,setter:as},us[35670]={size:4,setter:os},us[35671]={size:8,setter:os},us[35672]={size:12,setter:os},us[35673]={size:16,setter:os},us[35674]={size:4,setter:ss,count:2},us[35675]={size:9,setter:ss,count:3},us[35676]={size:16,setter:ss,count:4};const cs=/^[ \t]*\n/;function ls(t,e,n,r){const i=r||Xa,o=t.createShader(n);let a=0;if(cs.test(e)&&(a=1,e=e.replace(cs,"")),t.shaderSource(o,e),t.compileShader(o),!t.getShaderParameter(o,35713)){const n=t.getShaderInfoLog(o);return i(function(t,e){return e=e||0,++e,t.split("\n").map((function(t,n){return n+e+": "+t})).join("\n")}(e,a)+"\n*** Error compiling shader: "+n),t.deleteShader(o),null}return o}function fs(t,e,n){let r,i;if("function"==typeof e&&(n=e,e=void 0),"function"==typeof t)n=t,t=void 0;else if(t&&!Array.isArray(t)){if(t.errorCallback)return t;const e=t;n=e.errorCallback,t=e.attribLocations,r=e.transformFeedbackVaryings,i=e.transformFeedbackMode}const o={errorCallback:n||Xa,transformFeedbackVaryings:r,transformFeedbackMode:i};if(t){let n={};Array.isArray(t)?t.forEach((function(t,r){n[t]=e?e[r]:r})):n=t,o.attribLocations=n}return o}const hs=["VERTEX_SHADER","FRAGMENT_SHADER"];function ds(t,e){return e.indexOf("frag")>=0?35632:e.indexOf("vert")>=0?35633:void 0}function ps(t,e){e.forEach((function(e){t.deleteShader(e)}))}function ms(t,e,n,r,i){const o=fs(n,r,i),a=[],s=[];for(let n=0;n<e.length;++n){let r=e[n];if("string"==typeof r){const e=Va(r),i=e?e.text:r;let a=t[hs[n]];e&&e.type&&(a=ds(0,e.type)||a),r=ls(t,i,a,o.errorCallback),s.push(r)}u=r,"undefined"!=typeof WebGLShader&&u instanceof WebGLShader&&a.push(r)}var u;if(a.length!==e.length)return o.errorCallback("not enough shaders for program"),ps(t,s),null;const c=t.createProgram();a.forEach((function(e){t.attachShader(c,e)})),o.attribLocations&&Object.keys(o.attribLocations).forEach((function(e){t.bindAttribLocation(c,o.attribLocations[e],e)}));let l=o.transformFeedbackVaryings;if(l&&(l.attribs&&(l=l.attribs),Array.isArray(l)||(l=Object.keys(l)),t.transformFeedbackVaryings(c,l,o.transformFeedbackMode||35981)),t.linkProgram(c),!t.getProgramParameter(c,35714)){const e=t.getProgramInfoLog(c);return o.errorCallback("Error in program linking:"+e),t.deleteProgram(c),ps(t,s),null}return c}function gs(t,e,n,r,i){const o=fs(n,r,i),a=[];for(let n=0;n<e.length;++n){const r=ls(t,e[n],t[hs[n]],o.errorCallback);if(!r)return null;a.push(r)}return ms(t,a,o)}function ys(t){const e=t.name;return e.startsWith("gl_")||e.startsWith("webgl_")}function vs(t,e){let n=0;function r(e,r){const i=t.getUniformLocation(e,r.name),o=r.size>1&&"[0]"===r.name.substr(-3),a=r.type,s=Ga[a];if(!s)throw new Error(`unknown type: 0x${a.toString(16)}`);let u;if(s.bindPoint){const e=n;n+=r.size,u=o?s.arraySetter(t,a,e,i,r.size):s.setter(t,a,e,i,r.size)}else u=s.arraySetter&&o?s.arraySetter(t,i):s.setter(t,i);return u.location=i,u}const i={},o=t.getProgramParameter(e,35718);for(let n=0;n<o;++n){const o=t.getActiveUniform(e,n);if(ys(o))continue;let a=o.name;"[0]"===a.substr(-3)&&(a=a.substr(0,a.length-3));const s=r(e,o);i[a]=s}return i}function bs(t,e){const n={},r=t.getProgramParameter(e,35971);for(let i=0;i<r;++i){const r=t.getTransformFeedbackVarying(e,i);n[r.name]={index:i,type:r.type,size:r.size}}return n}function ws(t,e){const n=t.getProgramParameter(e,35718),r=[],i=[];for(let o=0;o<n;++o){i.push(o),r.push({});const n=t.getActiveUniform(e,o);if(ys(n))break;r[o].name=n.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach((function(n){const o=n[0],a=n[1];t.getActiveUniforms(e,i,t[o]).forEach((function(t,e){r[e][a]=t}))}));const o={},a=t.getProgramParameter(e,35382);for(let n=0;n<a;++n){const r=t.getActiveUniformBlockName(e,n),i={index:n,usedByVertexShader:t.getActiveUniformBlockParameter(e,n,35396),usedByFragmentShader:t.getActiveUniformBlockParameter(e,n,35398),size:t.getActiveUniformBlockParameter(e,n,35392),uniformIndices:t.getActiveUniformBlockParameter(e,n,35395)};i.used=i.usedByVertexShader||i.usedByFragmentShader,o[r]=i}return{blockSpecs:o,uniformData:r}}function As(t,e){const n=t.uniformSetters||t,r=arguments.length;for(let t=1;t<r;++t){const e=arguments[t];if(Array.isArray(e)){const t=e.length;for(let r=0;r<t;++r)As(n,e[r])}else for(const t in e){const r=n[t];r&&r(e[t])}}}function Es(t,e){const n={},r=t.getProgramParameter(e,35721);for(let i=0;i<r;++i){const r=t.getActiveAttrib(e,i);if(ys(r))continue;const o=t.getAttribLocation(e,r.name),a=us[r.type],s=a.setter(t,o,a);s.location=o,n[r.name]=s}return n}function xs(t,e){for(const n in e){const r=t[n];r&&r(e[n])}}function _s(t,e,n){n.vertexArrayObject?t.bindVertexArray(n.vertexArrayObject):(xs(e.attribSetters||e,n.attribs),n.indices&&t.bindBuffer(34963,n.indices))}function Cs(t,e){const n={program:e,uniformSetters:vs(t,e),attribSetters:Es(t,e)};return ja(t)&&(n.uniformBlockSpec=ws(t,e),n.transformFeedbackInfo=bs(t,e)),n}function Ts(t,e,n,r,i){const o=fs(n,r,i);let a=!0;if(e=e.map((function(t){if(t.indexOf("\n")<0){const e=Va(t);e?t=e.text:(o.errorCallback("no element with id: "+t),a=!1)}return t})),!a)return null;const s=gs(t,e,o);return s?Cs(t,s):null}function Os(t,e,n,r,i,o){n=void 0===n?4:n;const a=e.indices,s=e.elementType,u=void 0===r?e.numElements:r;i=void 0===i?0:i,s||a?void 0!==o?t.drawElementsInstanced(n,u,void 0===s?5123:e.elementType,i,o):t.drawElements(n,u,void 0===s?5123:e.elementType,i):void 0!==o?t.drawArraysInstanced(n,i,u,o):t.drawArrays(n,i,u)}const Ss={};Ss[34041]=33306,Ss[6401]=36128,Ss[36168]=36128,Ss[6402]=36096,Ss[33189]=36096;const Ms={};Ms[32854]=!0,Ms[32855]=!0,Ms[36194]=!0,Ms[34041]=!0,Ms[33189]=!0,Ms[6401]=!0,Ms[36168]=!0;const ks={addExtensionsToContext:!0};const Ds=/^(.*?)_/;function Fs(t,e){Ha(t,0);const n=t.getExtension(e);if(n){const r={},i=Ds.exec(e)[1],o="_"+i;for(const e in n){const a=n[e],s="function"==typeof a,u=s?i:o;let c=e;e.endsWith(u)&&(c=e.substring(0,e.length-u.length)),void 0!==t[c]?s||t[c]===a||ra(c,t[c],a,e):s?t[c]=function(t){return function(){return t.apply(n,arguments)}}(a):(t[c]=a,r[c]=a)}r.constructor={name:n.constructor.name},Ha(r,0)}return n}const Ns=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_depth_texture","WEBGL_draw_buffers"];function Is(t){for(let e=0;e<Ns.length;++e)Fs(t,Ns[e])}function Rs(t,e){return function(t,e){const n=["webgl2","webgl","experimental-webgl"];let r=null;for(let i=0;i<n.length;++i)if(r=t.getContext(n[i],e),r){ks.addExtensionsToContext&&Is(r);break}return r}(t,e)}var Bs=n(11),Ls=n.n(Bs),Ps=n(6),zs=n.n(Ps);function Us(t,e=[],n=0){const r=Math.fround(t);return e[n]=r,e[n+1]=isFinite(r)?t-r:0,e}function Ws(t){switch(function(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||7936),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||7937);return{gpuVendor:js(n,r),vendor:n,renderer:r,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t).gpuVendor.toLowerCase()){case"nvidia":return"  #define NVIDIA_GPU\n  // Nvidia optimizes away the calculation necessary for emulated fp64\n  #define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n  ";case"intel":return"  #define INTEL_GPU\n  // Intel optimizes away the calculation necessary for emulated fp64\n  #define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n  // Intel's built-in 'tan' function doesn't have acceptable precision\n  #define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n  // Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n  #define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n  ";case"amd":return"  #define AMD_GPU\n  ";default:return"  #define DEFAULT_GPU\n  // Prevent driver from optimizing away the calculation necessary for emulated fp64\n  #define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n  // Intel's built-in 'tan' function doesn't have acceptable precision\n  #define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n  // Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n  #define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n  "}}function js(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}var Hs=n(5),Ys=n.n(Hs),$s=n(15),qs=n.n($s),Xs=n(16),Vs=n.n(Xs);function Gs(t,e,n,r){let i;if(void 0!==t.value)i=e=>t.value,i.constant=!0,i.accessor=null;else{if(!n)throw new Error(`Missing value or accessor (field, expr, constant) on channel "${r}": ${JSON.stringify(t)}`);if(!e)throw new Error(`Missing scale! "${r}": ${JSON.stringify(t)}`);i=t=>e(n(t)),i.constant=!!n.constant,i.accessor=n}return i.invert=e?t=>e.invert(t):e=>{throw new Error("No scale available, cannot invert: "+JSON.stringify(t))},i}const Ks={x:"x2",y:"y2"};function Zs(t){return Object.values(Ks).includes(t)}function Js(t){for(const e of Object.entries(Ks))if(e[1]===t)return e[0];return t}class Qs{constructor(t){this.unitView=t,this.properties="object"==typeof t.spec.mark?t.spec.mark:{}}getDefaultEncoding(){return{sample:null}}getEncoding(){return{...this.getDefaultEncoding(),...this.unitView.getEncoding()}}getContext(){return this.unitView.context}getType(){return this.unitView.getMarkType()}initializeData(){const t=this.unitView.getData();if(!t)throw new Error("Can not initialize mark, no data available!");const e=this.unitView.getAccessor("sample");this.dataBySample=e?function(t,...e){return Po(t,Lo,Lo,e)}(t.flatData(),e):new Map([["default",t.ungroupAll().data]])}initializeEncoders(){const t=this.getEncoding();this.encoders=function(t,e,n){return Ys()(Object.keys(t).filter(e=>null!==t[e]).map(r=>[r,Gs(t[r],e(Js(r)),n(r),r)]))}(t,t=>{const e=this.unitView.getResolution(t);if(e)return e.getScale()},t=>this.unitView.getAccessor(t))}initializeGraphics(t){this.gl=t,this._shaderDefines=Ws(t)}processShader(t){return this._shaderDefines+"\n"+t}onBeforeSampleAnimation(){}onAfterSampleAnimation(){}getYDomain(){return fi.fromArray(this.getScale("y").domain())}getXDomain(){return this.getContext().genomeSpy.getDomain()}getScale(t,e=!1){const n=this.unitView.getResolution(t);if(n)return n.getScale();if(!e)throw new Error(`Cannot find a resolved scale for channel "${t}" at ${this.unitView.getPathString()} (${this.getType()})`)}render(t,e){}findDatum(t,e,n,r){return null}}const tu={xOffset:0,yOffset:0,relativeSizing:!1,maxRelativePointDiameter:.8,minAbsolutePointDiameter:0,geometricZoomBound:0},eu={x:{value:0},y:{value:.5},color:{value:"#1f77b4"},opacity:{value:1},size:{value:100},zoomThreshold:{value:1},shape:{value:"circle"},strokeWidth:{value:.7},gradientStrength:{value:0}},nu=Ys()(["circle","square","triangle-up","cross","diamond","triangle-down","triangle-right","triangle-left"].map((t,e)=>[t,e]));class ru extends Qs{constructor(t){super(t),this.properties={...tu,...this.properties}}getDefaultEncoding(){return{...super.getDefaultEncoding(),...eu}}initializeData(){super.initializeData();const t=this.unitView.getAccessor("x");if(!t)throw new Error("x channel is undefined!");for(const e of this.dataBySample.values())e.sort((e,n)=>t(e)-t(n))}initializeEncoders(){super.initializeEncoders();const t=this.getScale("y",!0);if(t&&t.bandwidth){const e=t.bandwidth()/2,n=this.encoders.y;this.encoders.y=t=>n(t)+e}}initializeGraphics(t){super.initializeGraphics(t),this.programInfo=Ts(t,[qs.a,Vs.a].map(t=>this.processShader(t)));const e=1===this.dataBySample.size?[...this.dataBySample.values()][0].length:void 0,n=new cu(this.encoders,e);for(const[t,e]of this.dataBySample.entries())n.addBatch(t,e);const r=n.toArrays();this.rangeMap=r.rangeMap,this.bufferInfo=ya(this.gl,r.arrays)}_getGeometricScaleFactor(){const t=Math.pow(2,this.properties.geometricZoomBound||0);return Math.pow(Math.min(1,this.getContext().genomeSpy.getExpZoomLevel()/t),1/3)}_getMaxPointSize(){const t=this.encoders.size;return t.constant?t():this.getScale("size").range().reduce((t,e)=>Math.max(t,e))}render(t,e){const n=this.gl,r=window.devicePixelRatio;n.enable(n.BLEND),n.useProgram(this.programInfo.program),As(this.programInfo,{...e,uYTranslate:0,uYScale:1,uXOffset:this.properties.xOffset/n.drawingBufferWidth*r,uYOffset:this.properties.yOffset/n.drawingBufferHeight*r,uViewportHeight:n.drawingBufferHeight,uDevicePixelRatio:r,uMaxRelativePointDiameter:this.properties.maxRelativePointDiameter,uMinAbsolutePointDiameter:this.properties.minAbsolutePointDiameter,uMaxPointSize:this._getMaxPointSize(),uScaleFactor:this._getGeometricScaleFactor(),fractionToShow:.02}),_s(n,this.programInfo,this.bufferInfo);const i=On(this.encoders.x.accessor).left,o=this.getContext().genomeSpy.getViewportDomain(),a=o.pad(.01*o.width());for(const e of t){const t=this.rangeMap.get(e.sampleId);if(t){const r=this.dataBySample.get(e.sampleId),o=i(r,a.lower),s=i(r,a.upper)-o;s&&(As(this.programInfo,e.uniforms),Os(n,this.bufferInfo,n.POINTS,s,t.offset+o))}}}findDatum(t,e,n,r){const i=this.dataBySample.get(t||"default");if(!i)return null;const o=this.encoders;e-=this.properties.xOffset,n+=this.properties.yOffset;const a=Math.sqrt(this._getMaxPointSize()),s=Math.max(this.properties.minAbsolutePointDiameter,Math.min(r.width()*this.properties.maxRelativePointDiameter,a))/a,u=this._getGeometricScaleFactor()*s,c=this.getContext().genomeSpy.rescaledX,l=On(o.x).left,f=l(i,c.invert(e-a/2*u)),h=l(i,c.invert(e+a/2*u)),d=1.005*(.02*this.getContext().genomeSpy.getExpZoomLevel());let p=null;for(let t=f;t<h;t++){const a=i[t];if(1-o.zoomThreshold(a)<d){(m=e,g=c(o.x(a)),y=n,v=r.interpolate(1-o.y(a)),Math.sqrt(Math.pow(g-m,2)+Math.pow(v-y,2)))<u*Math.sqrt(o.size(a))/2&&(p=a)}}var m,g,y,v;return p}}class iu{static create(t,e,n){const r=new iu(n);return Object.entries(t).filter(t=>e.includes(t[0])).forEach(t=>r.addConverter(t[0],t[1].numComponents||1,t[1].f)),r}constructor(t){this.size=t,this.arrays={},this.pushers=[],this.converters=[],this.vertexCount=0}addConverter(t,e,n){const r=this.createUpdater(t,e);this.converters.push(t=>r(n(t)))}createUpdater(t,e){let n;const r=!!this.size,i=r?new Float32Array(this.size*e):[];this.arrays[t]={data:i,numComponents:e};let o;return o=1==e?()=>{i[this.vertexCount]=n}:r?()=>i.set(n,this.vertexCount*e):()=>{const t=this.vertexCount*e;for(let r=0;r<e;r++)i[t+r]=n[r]},this.pushers.push(o),function(t){n=t}}pushAll(){for(const t of this.pushers)t();this.vertexCount++}updateFromDatum(t){for(const e of this.converters)e(t)}pushFromDatum(t){this.updateFromDatum(t),this.pushAll()}toValues(){return Ys()(Object.entries(this.arrays).map(t=>[t[0],{value:t[1].data}]))}}const ou=0,au=5;function su(t){return t?(Object(V.o)(t)&&(t=Xn(t)),new Float32Array([t.r/255,t.g/255,t.b/255])):[1,0,1]}class uu{constructor(t,{tesselationThreshold:e=1/0,visibleRange:n=[-1/0,1/0]}){this.encoders=t,this.visibleRange=n;const r=t;this.tesselationThreshold=e||1/0;const i={color:{f:t=>su(r.color(t)),numComponents:3},opacity:{f:r.opacity,numComponents:1}},o=Object.entries(t).filter(t=>t[1].constant).map(t=>t[0]),a=Object.entries(t).filter(t=>!t[1].constant).map(t=>t[0]);this.variableBuilder=iu.create(i,a),this.updateX=this.variableBuilder.createUpdater("x",2),this.updateY=this.variableBuilder.createUpdater("y",1),this.updateWidth=this.variableBuilder.createUpdater("width",1),this.updateHeight=this.variableBuilder.createUpdater("height",1),this.constantBuilder=iu.create(i,o),this.constantBuilder.updateFromDatum({}),this.constantBuilder.pushAll(),this.rangeMap=new Map}addBatch(t,e){const n=this.variableBuilder.vertexCount,r=[0,0],i=this.encoders,[o,a]=this.visibleRange;for(const t of e){let e=i.x(t),n=i.x2(t);if(e>n&&([e,n]=[n,e]),n<o||e>a)continue;e<o&&(e=o),n>a&&(n=a);let s=i.y(t),u=i.y2(t);s>u&&([s,u]=[u,s]);const c=n-e||Math.pow(.1,20),l=u-s||Math.pow(.1,20);this.variableBuilder.updateFromDatum(t),this.updateX(Us(e,r)),this.updateWidth(-c),this.updateY(s),this.updateHeight(l),this.variableBuilder.pushAll();const f=c<1/0?Math.ceil(c/this.tesselationThreshold):1;for(let t=0;t<=f;t++){const n=t/f;let i=0;0==t?i=-c:t>=f&&(i=c),this.updateWidth(i);const o=isFinite(c)?e+c*n:0==t?-1/0:1/0;this.updateX(Us(o,r)),this.updateY(s),this.updateHeight(l),this.variableBuilder.pushAll(),this.updateY(u),this.updateHeight(-l),this.variableBuilder.pushAll()}this.variableBuilder.updateFromDatum(t),this.updateX(Us(n,r)),this.updateWidth(c),this.updateHeight(-l),this.updateY(u),this.variableBuilder.pushAll()}const s=this.variableBuilder.vertexCount-n;s&&this.rangeMap.set(t,{offset:n,count:s})}toArrays(){return{arrays:{...this.variableBuilder.arrays,...this.constantBuilder.toValues()},vertexCount:this.variableBuilder.vertexCount,drawMode:au,rangeMap:this.rangeMap}}}class cu{constructor(t,e){const n=t,r=function(){const t=Object(V.f)();return e=>{if(Object(V.o)(e)&&t.size<30){let n=t.get(e);return n||(n=su(e),t.set(e,n),n)}return su(e)}}(),i=[0,0],o={x:{f:t=>Us(n.x(t),i),numComponents:2},y:{f:n.y,numComponents:1},size:{f:n.size,numComponents:1},color:{f:t=>r(n.color(t)),numComponents:3},opacity:{f:n.opacity,numComponents:1},zoomThreshold:{f:n.zoomThreshold,numComponents:1},shape:{f:t=>nu[n.shape(t)]||0,numComponents:1},strokeWidth:{f:n.strokeWidth,numComponents:1},gradientStrength:{f:n.gradientStrength,numComponents:1}},a=Object.entries(t).filter(t=>t[1].constant).map(t=>t[0]),s=Object.entries(t).filter(t=>!t[1].constant).map(t=>t[0]);this.variableBuilder=iu.create(o,s,e),this.constantBuilder=iu.create(o,a),this.constantBuilder.updateFromDatum({}),this.constantBuilder.pushAll(),this.index=0,this.rangeMap=new Map}addBatch(t,e){const n=this.index;for(const t of e)this.variableBuilder.pushFromDatum(t),this.index++;const r=this.index-n;r&&this.rangeMap.set(t,{offset:n,count:r})}toArrays(){return{arrays:{...this.variableBuilder.arrays,...this.constantBuilder.toValues()},vertexCount:this.index,drawMode:ou,rangeMap:this.rangeMap}}}const lu={minWidth:1,minHeight:0,minOpacity:0,xOffset:0,yOffset:0,tesselationZoomThreshold:10,tesselationTiles:35},fu={x:null,x2:null,y:null,y2:null,color:{value:"#1f77b4"},opacity:{value:1}};class hu extends Qs{constructor(t){super(t),this.properties={...lu,...this.properties},this.opaque=this.getEncoding().opacity.value>=1&&this.properties.minOpacity>=1}getDefaultEncoding(){return{...super.getDefaultEncoding(),...fu}}getEncoding(){const t=super.getEncoding();return t.y?"quantitative"!=t.y.type||t.y2||(t.y2={constant:0}):(t.y={value:0},t.y2={value:1}),t}onBeforeSampleAnimation(){const t=this.getContext().genomeSpy.getViewportDomain();t.width()<this.getContext().genomeSpy.getDomain().width()/this.properties.tesselationZoomThreshold&&(this._sampleBufferInfo=this._createSampleBufferInfo(t,t.width()/this.properties.tesselationTiles))}onAfterSampleAnimation(){this._sampleBufferInfo=this._fullSampleBufferInfo}_createSampleBufferInfo(t,e){const n=new uu(this.encoders,{tesselationThreshold:e,visibleRange:t?t.toArray():void 0});for(const[t,e]of this.dataBySample.entries())n.addBatch(t,e);const r=n.toArrays();return{rangeMap:r.rangeMap,bufferInfo:ya(this.gl,r.arrays)}}initializeEncoders(){super.initializeEncoders();const t=this.getScale("y",!0);if(t){const e=this.getEncoding();if(t.bandwidth){let n=t.bandwidth();if(e.y2){if(Object.is(e.y,e.y2)){n/=2;const t=this.encoders.y;this.encoders.y=e=>t(e)+n,this.encoders.y2=this.encoders.y}}else this.encoders.y2=t=>this.encoders.y(t)+n}}}initializeGraphics(t){super.initializeGraphics(t);const e=this.getXDomain(),n=e?e.width():1/0;this.programInfo=Ts(t,[Ls.a,zs.a].map(t=>this.processShader(t))),this._fullSampleBufferInfo=this._createSampleBufferInfo(null,n/this.properties.tesselationZoomThreshold/this.properties.tesselationTiles),this._sampleBufferInfo=this._fullSampleBufferInfo}render(t,e){const n=this.gl,r=window.devicePixelRatio;this.opaque?n.disable(n.BLEND):n.enable(n.BLEND),n.useProgram(this.programInfo.program),As(this.programInfo,{...e,uYTranslate:0,uYScale:1,uMinWidth:this.properties.minWidth/n.drawingBufferWidth*r,uMinHeight:this.properties.minHeight/n.drawingBufferHeight*r,uMinOpacity:this.properties.minOpacity,uXOffset:this.properties.xOffset/n.drawingBufferWidth*r,uYOffset:this.properties.yOffset/n.drawingBufferHeight*r}),_s(n,this.programInfo,this._sampleBufferInfo.bufferInfo);for(const e of t){const t=this._sampleBufferInfo.rangeMap.get(e.sampleId);t&&(As(this.programInfo,e.uniforms),Os(n,this._sampleBufferInfo,n.TRIANGLE_STRIP,t.count,t.offset))}}findDatum(t,e,n,r){const i=this.dataBySample.get(t||"default"),o=this.gl,a=window.devicePixelRatio;if(e-=this.properties.xOffset,n+=this.properties.yOffset,i){const t=this.encoders,s=this.properties.minWidth/o.drawingBufferWidth*a*this.getContext().genomeSpy.getViewportDomain().width()/2,u=this.properties.minHeight/o.drawingBufferHeight*a/2,c=this.getContext().genomeSpy.rescaledX.invert(e),l=1-(n-r.lower)/r.width(),f=this.properties.minWidth?e=>{const n=Math.max((t.x2(e)-t.x(e))/2,s),r=(t.x(e)+t.x2(e))/2;return c>=r-n&&c<r+n}:n=>c>=t.x(n)&&c<t.x2(n)||c>=t.x2(n)&&c<t.x(e),h=this.properties.minHeight?e=>{const n=Math.max(Math.abs(t.y2(e)-t.y(e))/2,u),r=(t.y(e)+t.y2(e))/2;return l>=r-n&&l<r+n}:e=>l>=t.y(e)&&l<t.y2(e)||l>=t.y2(e)&&l<t.y(e);let d=null;for(let t of i)f(t)&&h(t)&&(d=t);return d}}findDatumAt(t,e){const n=this.encoders,r=this.dataBySample.get(t);if(r)return r.find(t=>e>=n.x(t)&&e<n.x2(t))}getRangeAggregates(){return{quantitative:null,categorical:null}}}const du={size:1,minLength:0},pu={x:null,x2:null,y:null,y2:null},mu=Symbol("Vertical");class gu extends Wo{constructor(t,e,n,r){super(t,e,n,r),this.spec=t}getConfiguredResolution(t){return this.spec.resolve&&this.spec.resolve.scale&&this.spec.resolve.scale[t]}getDefaultResolution(t){return"shared"}getConfiguredOrDefaultResolution(t){return this.getConfiguredResolution(t)||this.getDefaultResolution(t)}}function yu(t,e,n){n=n||[];const r={},i=t=>{for(let i in t)n.includes(i)||void 0===t[i]||(void 0!==r[i]&&r[i]!==t[i]?console.warn(`Conflicting property ${i} of ${e}: (${JSON.stringify(r[i])} and ${JSON.stringify(t[i])}). Using ${JSON.stringify(r[i])}.`):r[i]=t[i])};for(const e of t)i(e);return r}var vu=function(t,e,n){var r=t-e+2*n;return t?r>0?r:1:0};const bu="log",wu="pow",Au="sqrt",Eu="sequential";function xu(t){return function(t){return t&&t.startsWith(Eu)}(t)||function(t){return t&&t.startsWith("diverging")}(t)}function _u(t){return t===bu||t.endsWith("-log")}function Cu(t){switch(t){case"linear":case bu:case wu:case Au:case"symlog":case"time":case"utc":case Eu:return!0}return!1}var Tu=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o};const Ou=Symbol("implicit");function Su(){var t=new Map,e=[],n=[],r=Ou;function i(i){var o=i+"",a=t.get(o);if(!a){if(r!==Ou)return r;t.set(o,a=e.push(i))}return n[(a-1)%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Map;for(const r of n){const n=r+"";t.has(n)||t.set(n,e.push(r))}return i},i.range=function(t){return arguments.length?(n=Array.from(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return Su(e,n).unknown(r)},Ur.apply(i,arguments),i}function Mu(){var t,e,n=Su().unknown(void 0),r=n.domain,i=n.range,o=[0,1],a=!1,s=0,u=0,c=.5;function l(){var n=r().length,l=o[1]<o[0],f=o[l-0],h=o[1-l],d=vu(n,s,u);t=(h-f)/(d||1),a&&(t=Math.floor(t)),f+=(h-f-t*(n-s))*c,e=t*(1-s),a&&(f=Math.round(f),e=Math.round(e));var p=Tu(n).map((function(e){return f+t*e}));return i(l?p.reverse():p)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),l()):r()},n.range=function(t){return arguments.length?(o=[+t[0],+t[1]],l()):o.slice()},n.rangeRound=function(t){return o=[+t[0],+t[1]],a=!0,l()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(a=!!t,l()):a},n.padding=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),s=u,l()):s},n.paddingInner=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),l()):s},n.paddingOuter=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),l()):u},n.align=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),l()):c},n.invertRange=function(t){if(null!=t[0]&&null!=t[1]){var n,a,s,u=+t[0],c=+t[1],l=o[1]<o[0],f=l?i().reverse():i(),h=f.length-1;if(u==u&&c==c&&(c<u&&(s=u,u=c,c=s),!(c<f[0]||u>o[1-l])))return n=Math.max(0,Mn(f,u)-1),a=u===c?n:Mn(f,c)-1,u-f[n]>e+1e-10&&++n,l&&(s=n,n=h-a,a=h-s),n>a?void 0:r().slice(n,a+1)}},n.invert=function(t){var e=n.invertRange([t,t]);return e?e[0]:e},n.copy=function(){return Mu().domain(r()).range(o).round(a).paddingInner(s).paddingOuter(u).align(c)},l()}var ku=Array.prototype.map;function Du(t){return ku.call(t,(function(t){return+t}))}var Fu=Array.prototype.slice;function Nu(t){var e;function n(t){return isNaN(t=+t)?e:t}return n.invert=n,n.domain=n.range=function(e){return arguments.length?(t=Array.from(e,Dr),n):t.slice()},n.unknown=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return Nu(t).unknown(e)},t=arguments.length?Array.from(t,Dr):[0,1],ii(n)}var Iu=function(t,e){var n,r=0,i=(t=t.slice()).length-1,o=t[r],a=t[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),t[r]=e.floor(o),t[i]=e.ceil(a),t};function Ru(t){return Math.log(t)}function Bu(t){return Math.exp(t)}function Lu(t){return-Math.log(-t)}function Pu(t){return-Math.exp(-t)}function zu(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Uu(t){return function(e){return-t(-e)}}function Wu(t){var e,n,r=t(Ru,Bu),i=r.domain,o=10;function a(){return e=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}(o),n=function(t){return 10===t?zu:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}(o),i()[0]<0?(e=Uu(e),n=Uu(n),t(Lu,Pu)):t(Ru,Bu),r}return r.base=function(t){return arguments.length?(o=+t,a()):o},r.domain=function(t){return arguments.length?(i(t),a()):i()},r.ticks=function(t){var r,a=i(),s=a[0],u=a[a.length-1];(r=u<s)&&(h=s,s=u,u=h);var c,l,f,h=e(s),d=e(u),p=null==t?10:+t,m=[];if(!(o%1)&&d-h<p){if(h=Math.floor(h),d=Math.ceil(d),s>0){for(;h<=d;++h)for(l=1,c=n(h);l<o;++l)if(!((f=c*l)<s)){if(f>u)break;m.push(f)}}else for(;h<=d;++h)for(l=o-1,c=n(h);l>=1;--l)if(!((f=c*l)<s)){if(f>u)break;m.push(f)}2*m.length<p&&(m=xn(s,u,p))}else m=xn(h,d,Math.min(d-h,p)).map(n);return r?m.reverse():m},r.tickFormat=function(t,i){if(null==i&&(i=10===o?".0e":","),"function"!=typeof i&&(i=Xr(i)),t===1/0)return i;null==t&&(t=10);var a=Math.max(1,o*t/r.ticks().length);return function(t){var r=t/n(Math.round(e(t)));return r*o<o-.5&&(r*=o),r<=a?i(t):""}},r.nice=function(){return i(Iu(i(),{floor:function(t){return n(Math.floor(e(t)))},ceil:function(t){return n(Math.ceil(e(t)))}}))},r}function ju(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Hu(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Yu(t){return t<0?-t*t:t*t}function $u(t){var e=t(Nr,Nr),n=1;function r(){return 1===n?t(Nr,Nr):.5===n?t(Hu,Yu):t(ju(n),ju(1/n))}return e.exponent=function(t){return arguments.length?(n=+t,r()):n},ii(e)}function qu(){var t=$u(Pr());return t.copy=function(){return Lr(t,qu()).exponent(t.exponent())},Ur.apply(t,arguments),t}function Xu(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Vu(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function Gu(t){var e=1,n=t(Xu(e),Vu(e));return n.constant=function(n){return arguments.length?t(Xu(e=+n),Vu(e)):e},ii(n)}var Ku=Ot((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()})),Zu=Ku,Ju=(Ku.range,Ot((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds()-6e4*t.getMinutes())}),(function(t,e){t.setTime(+t+36e5*e)}),(function(t,e){return(e-t)/36e5}),(function(t){return t.getHours()}))),Qu=Ju,tc=(Ju.range,Ot((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds())}),(function(t,e){t.setTime(+t+6e4*e)}),(function(t,e){return(e-t)/6e4}),(function(t){return t.getMinutes()}))),ec=tc,nc=(tc.range,Ot((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+1e3*e)}),(function(t,e){return(e-t)/1e3}),(function(t){return t.getUTCSeconds()}))),rc=nc,ic=(nc.range,Ot((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t})));ic.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Ot((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):ic:null};var oc=ic;ic.range;function ac(t){return new Date(t)}function sc(t){return t instanceof Date?+t:+new Date(+t)}function uc(t,e,n,r,i,o,a,s,u){var c=zr(),l=c.invert,f=c.domain,h=u(".%L"),d=u(":%S"),p=u("%I:%M"),m=u("%I %p"),g=u("%a %d"),y=u("%b %d"),v=u("%B"),b=u("%Y"),w=[[a,1,1e3],[a,5,5e3],[a,15,15e3],[a,30,3e4],[o,1,6e4],[o,5,3e5],[o,15,9e5],[o,30,18e5],[i,1,36e5],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,864e5],[r,2,1728e5],[n,1,6048e5],[e,1,2592e6],[e,3,7776e6],[t,1,31536e6]];function A(s){return(a(s)<s?h:o(s)<s?d:i(s)<s?p:r(s)<s?m:e(s)<s?n(s)<s?g:y:t(s)<s?v:b)(s)}function E(e,n,r){if(null==e&&(e=10),"number"==typeof e){var i,o=Math.abs(r-n)/e,a=On((function(t){return t[2]})).right(w,o);return a===w.length?(i=Cn(n/31536e6,r/31536e6,e),e=t):a?(i=(a=w[o/w[a-1][2]<w[a][2]/o?a-1:a])[1],e=a[0]):(i=Math.max(Cn(n,r,e),1),e=s),e.every(i)}return e}return c.invert=function(t){return new Date(l(t))},c.domain=function(t){return arguments.length?f(Array.from(t,sc)):f().map(ac)},c.ticks=function(t){var e,n=f(),r=n[0],i=n[n.length-1],o=i<r;return o&&(e=r,r=i,i=e),e=(e=E(t,r,i))?e.range(r,i+1):[],o?e.reverse():e},c.tickFormat=function(t,e){return null==e?A:u(e)},c.nice=function(t){var e=f();return(t=E(t,e[0],e[e.length-1]))?f(Iu(e,t)):c},c.copy=function(){return Lr(c,uc(t,e,n,r,i,o,a,s,u))},c}var cc=Ot((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})),lc=cc,fc=(cc.range,Ot((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+36e5*e)}),(function(t,e){return(e-t)/36e5}),(function(t){return t.getUTCHours()}))),hc=fc,dc=(fc.range,Ot((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+6e4*e)}),(function(t,e){return(e-t)/6e4}),(function(t){return t.getUTCMinutes()}))),pc=dc;dc.range;function mc(){var t,e,n,r,i,o=0,a=1,s=Nr,u=!1;function c(e){return isNaN(e=+e)?i:s(0===n?.5:(e=(r(e)-t)*n,u?Math.max(0,Math.min(1,e)):e))}function l(t){return function(e){var n,r;return arguments.length?([n,r]=e,s=t(n,r),c):[s(0),s(1)]}}return c.domain=function(i){return arguments.length?([o,a]=i,t=r(o=+o),e=r(a=+a),n=t===e?0:1/(e-t),c):[o,a]},c.clamp=function(t){return arguments.length?(u=!!t,c):u},c.interpolator=function(t){return arguments.length?(s=t,c):s},c.range=l(Mr),c.rangeRound=l(kr),c.unknown=function(t){return arguments.length?(i=t,c):i},function(i){return r=i,t=i(o),e=i(a),n=t===e?0:1/(e-t),c}}function gc(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function yc(){var t=ii(mc()(Nr));return t.copy=function(){return gc(t,yc())},Wr.apply(t,arguments)}function vc(){var t=$u(mc());return t.copy=function(){return gc(t,vc()).exponent(t.exponent())},Wr.apply(t,arguments)}function bc(t,e){for(var n=0,r=e.length-1,i=e[0],o=new Array(r<0?0:r);n<r;)o[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return o[e](t-e)}}function wc(){var t,e,n,r,i,o,a,s=0,u=.5,c=1,l=1,f=Nr,h=!1;function d(t){return isNaN(t=+t)?a:(t=.5+((t=+o(t))-e)*(l*t<l*e?r:i),f(h?Math.max(0,Math.min(1,t)):t))}function p(t){return function(e){var n,r,i;return arguments.length?([n,r,i]=e,f=bc(t,[n,r,i]),d):[f(0),f(.5),f(1)]}}return d.domain=function(a){return arguments.length?([s,u,c]=a,t=o(s=+s),e=o(u=+u),n=o(c=+c),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),l=e<t?-1:1,d):[s,u,c]},d.clamp=function(t){return arguments.length?(h=!!t,d):h},d.interpolator=function(t){return arguments.length?(f=t,d):f},d.range=p(Mr),d.rangeRound=p(kr),d.unknown=function(t){return arguments.length?(a=t,d):a},function(a){return o=a,t=a(s),e=a(u),n=a(c),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),l=e<t?-1:1,d}}function Ac(){var t=$u(wc());return t.copy=function(){return gc(t,Ac()).exponent(t.exponent())},Wr.apply(t,arguments)}function Ec(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n<e||void 0===n&&e>=e)&&(n=e);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function xc(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n>e||void 0===n&&e>=e)&&(n=e);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function _c(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function Cc(t,e,n){if(r=(t=Float64Array.from(function*(t,e){if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(yield e);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(r=+r)>=r&&(yield r)}}(t,n))).length){if((e=+e)<=0||r<2)return xc(t);if(e>=1)return Ec(t);var r,i=(r-1)*e,o=Math.floor(i),a=Ec(function t(e,n,r=0,i=e.length-1,o=Tn){for(;i>r;){if(i-r>600){const a=i-r+1,s=n-r+1,u=Math.log(a),c=.5*Math.exp(2*u/3),l=.5*Math.sqrt(u*c*(a-c)/a)*(s-a/2<0?-1:1);t(e,n,Math.max(r,Math.floor(n-s*c/a+l)),Math.min(i,Math.floor(n+(a-s)*c/a+l)),o)}const a=e[n];let s=r,u=i;for(_c(e,r,n),o(e[i],a)>0&&_c(e,r,i);s<u;){for(_c(e,s,u),++s,--u;o(e[s],a)<0;)++s;for(;o(e[u],a)>0;)--u}0===o(e[r],a)?_c(e,r,u):(++u,_c(e,u,i)),u<=n&&(r=u+1),n<=u&&(i=u-1)}return e}(t,o).subarray(0,o+1));return a+(xc(t.subarray(o+1))-a)*(i-o)}}function Tc(t,e){return function(){var n=e();return n.invertRange||(n.invertRange=n.invert?function(t){return function(e){var n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}(n):n.invertExtent?function(t){return function(e){var n,r,i,o,a=t.range(),s=e[0],u=e[1],c=-1;for(u<s&&(r=s,s=u,u=r),i=0,o=a.length;i<o;++i)a[i]>=s&&a[i]<=u&&(c<0&&(c=i),n=i);if(!(c<0))return s=t.invertExtent(a[c]),u=t.invertExtent(a[n]),[void 0===s[0]?s[1]:s[0],void 0===u[1]?u[0]:u[1]]}}(n):void 0),n.type=t,n}}function Oc(t,e){return arguments.length>1?(Sc[t]=Tc(t,e),this):Object(V.h)(Sc,t)?Sc[t]:void 0}var Sc={identity:Nu,linear:oi,[bu]:function t(){var e=Wu(Pr()).domain([1,10]);return e.copy=function(){return Lr(e,t()).base(e.base())},Ur.apply(e,arguments),e},[wu]:qu,[Au]:function(){return qu.apply(null,arguments).exponent(.5)},symlog:function t(){var e=Gu(Pr());return e.copy=function(){return Lr(e,t()).constant(e.constant())},Ur.apply(e,arguments)},time:function(){return Ur.apply(uc(Gt,Zu,zt,Xt,Qu,ec,rc,oc,ne).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},utc:function(){return Ur.apply(uc(Zt,lc,Mt,Lt,hc,pc,rc,oc,ie).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},[Eu]:yc,"sequential-linear":yc,"sequential-log":function t(){var e=Wu(mc()).domain([1,10]);return e.copy=function(){return gc(e,t()).base(e.base())},Wr.apply(e,arguments)},"sequential-pow":vc,"sequential-sqrt":function(){return vc.apply(null,arguments).exponent(.5)},"sequential-symlog":function t(){var e=Gu(mc());return e.copy=function(){return gc(e,t()).constant(e.constant())},Wr.apply(e,arguments)},"diverging-linear":function t(){var e=ii(wc()(Nr));return e.copy=function(){return gc(e,t())},Wr.apply(e,arguments)},"diverging-log":function t(){var e=Wu(wc()).domain([.1,1,10]);return e.copy=function(){return gc(e,t()).base(e.base())},Wr.apply(e,arguments)},"diverging-pow":Ac,"diverging-sqrt":function(){return Ac.apply(null,arguments).exponent(.5)},"diverging-symlog":function t(){var e=Gu(wc());return e.copy=function(){return gc(e,t()).constant(e.constant())},Wr.apply(e,arguments)},quantile:function t(){var e,n=[],r=[],i=[];function o(){var t=0,e=Math.max(1,r.length);for(i=new Array(e-1);++t<e;)i[t-1]=Cc(n,t/e);return a}function a(t){return isNaN(t=+t)?e:r[kn(i,t)]}return a.invertExtent=function(t){var e=r.indexOf(t);return e<0?[NaN,NaN]:[e>0?i[e-1]:n[0],e<i.length?i[e]:n[n.length-1]]},a.domain=function(t){if(!arguments.length)return n.slice();n=[];for(let e of t)null==e||isNaN(e=+e)||n.push(e);return n.sort(Tn),o()},a.range=function(t){return arguments.length?(r=Array.from(t),o()):r.slice()},a.unknown=function(t){return arguments.length?(e=t,a):e},a.quantiles=function(){return i.slice()},a.copy=function(){return t().domain(n).range(r).unknown(e)},Ur.apply(a,arguments)},quantize:function t(){var e,n=0,r=1,i=1,o=[.5],a=[0,1];function s(t){return t<=t?a[kn(o,t,0,i)]:e}function u(){var t=-1;for(o=new Array(i);++t<i;)o[t]=((t+1)*r-(t-i)*n)/(i+1);return s}return s.domain=function(t){return arguments.length?([n,r]=t,n=+n,r=+r,u()):[n,r]},s.range=function(t){return arguments.length?(i=(a=Array.from(t)).length-1,u()):a.slice()},s.invertExtent=function(t){var e=a.indexOf(t);return e<0?[NaN,NaN]:e<1?[n,o[0]]:e>=i?[o[i-1],r]:[o[e-1],o[e]]},s.unknown=function(t){return arguments.length?(e=t,s):s},s.thresholds=function(){return o.slice()},s.copy=function(){return t().domain([n,r]).range(a).unknown(e)},Ur.apply(ii(s),arguments)},threshold:function t(){var e,n=[.5],r=[0,1],i=1;function o(t){return t<=t?r[kn(n,t,0,i)]:e}return o.domain=function(t){return arguments.length?(n=Array.from(t),i=Math.min(n.length,r.length-1),o):n.slice()},o.range=function(t){return arguments.length?(r=Array.from(t),i=Math.min(n.length,r.length-1),o):r.slice()},o.invertExtent=function(t){var e=r.indexOf(t);return[n[e-1],n[e]]},o.unknown=function(t){return arguments.length?(e=t,o):e},o.copy=function(){return t().domain(n).range(r).unknown(e)},Ur.apply(o,arguments)},"bin-ordinal":function t(){var e=[],n=[];function r(t){return null==t||t!=t?void 0:n[(kn(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=Du(t),r):e.slice()},r.range=function(t){return arguments.length?(n=Fu.call(t),r):n.slice()},r.tickFormat=function(t,n){return ri(e[0],Object(V.q)(e),null==t?10:t,n)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r},ordinal:Su,band:Mu,point:function(){return function t(e){var n=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return t(n())},e}(Mu().paddingInner(1))}};for(var Mc in Sc)Oc(Mc,Sc[Mc]);var kc,Dc,Fc,Nc,Ic=function(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}},Rc=function(t,e){var n=hr(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}},Bc=180/Math.PI,Lc={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},Pc=function(t,e,n,r,i,o){var a,s,u;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),t*r<e*n&&(t=-t,e=-e,u=-u,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*Bc,skewX:Math.atan(u)*Bc,scaleX:a,scaleY:s}};function zc(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var s=[],u=[];return o=t(o),a=t(a),function(t,r,i,o,a,s){if(t!==i||r!==o){var u=a.push("translate(",null,e,null,n);s.push({i:u-4,x:_r(t,i)},{i:u-2,x:_r(r,o)})}else(i||o)&&a.push("translate("+i+e+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,u),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:_r(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,a.rotate,s,u),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:_r(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,a.skewX,s,u),function(t,e,n,r,o,a){if(t!==n||e!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:_r(t,n)},{i:s-2,x:_r(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,u),o=a=null,function(t){for(var e,n=-1,r=u.length;++n<r;)s[(e=u[n]).i]=e.x(t);return s.join("")}}}var Uc=zc((function(t){return"none"===t?Lc:(kc||(kc=document.createElement("DIV"),Dc=document.documentElement,Fc=document.defaultView),kc.style.transform=t,t=Fc.getComputedStyle(Dc.appendChild(kc),null).getPropertyValue("transform"),Dc.removeChild(kc),t=t.slice(7,-1).split(","),Pc(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}),"px, ","px)","deg)"),Wc=zc((function(t){return null==t?Lc:(Nc||(Nc=document.createElementNS("http://www.w3.org/2000/svg","g")),Nc.setAttribute("transform",t),(t=Nc.transform.baseVal.consolidate())?(t=t.matrix,Pc(t.a,t.b,t.c,t.d,t.e,t.f)):Lc)}),", ",")",")");function jc(t){return function(e,n){var r=t((e=ir(e)).h,(n=ir(n)).h),i=pr(e.s,n.s),o=pr(e.l,n.l),a=pr(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=o(t),e.opacity=a(t),e+""}}}var Hc=jc(hr),Yc=jc(pr),$c=Math.PI/180,qc=180/Math.PI;function Xc(t){if(t instanceof Gc)return new Gc(t.l,t.a,t.b,t.opacity);if(t instanceof nl)return rl(t);t instanceof Jn||(t=Kn(t));var e,n,r=Qc(t.r),i=Qc(t.g),o=Qc(t.b),a=Kc((.2225045*r+.7168786*i+.0606169*o)/1);return r===i&&i===o?e=n=a:(e=Kc((.4360747*r+.3850649*i+.1430804*o)/.96422),n=Kc((.0139322*r+.0971045*i+.7141733*o)/.82521)),new Gc(116*a-16,500*(e-a),200*(a-n),t.opacity)}function Vc(t,e,n,r){return 1===arguments.length?Xc(t):new Gc(t,e,n,null==r?1:r)}function Gc(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function Kc(t){return t>6/29*(6/29)*(6/29)?Math.pow(t,1/3):t/(6/29*3*(6/29))+4/29}function Zc(t){return t>6/29?t*t*t:6/29*3*(6/29)*(t-4/29)}function Jc(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Qc(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function tl(t){if(t instanceof nl)return new nl(t.h,t.c,t.l,t.opacity);if(t instanceof Gc||(t=Xc(t)),0===t.a&&0===t.b)return new nl(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*qc;return new nl(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function el(t,e,n,r){return 1===arguments.length?tl(t):new nl(t,e,n,null==r?1:r)}function nl(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function rl(t){if(isNaN(t.h))return new Gc(t.l,0,0,t.opacity);var e=t.h*$c;return new Gc(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function il(t,e){var n=pr((t=Vc(t)).l,(e=Vc(e)).l),r=pr(t.a,e.a),i=pr(t.b,e.b),o=pr(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=o(e),t+""}}function ol(t){return function(e,n){var r=t((e=el(e)).h,(n=el(n)).h),i=pr(e.c,n.c),o=pr(e.l,n.l),a=pr(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=o(t),e.opacity=a(t),e+""}}}Dn(Gc,Vc,Fn(Nn,{brighter:function(t){return new Gc(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new Gc(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new Jn(Jc(3.1338561*(e=.96422*Zc(e))-1.6168667*(t=1*Zc(t))-.4906146*(n=.82521*Zc(n))),Jc(-.9787684*e+1.9161415*t+.033454*n),Jc(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),Dn(nl,el,Fn(Nn,{brighter:function(t){return new nl(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new nl(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return rl(this).rgb()}}));var al=ol(hr),sl=ol(pr),ul=-.14861,cl=1.78277,ll=-.29227,fl=-.90649,hl=1.97294,dl=hl*fl,pl=hl*cl,ml=cl*ll-fl*ul;function gl(t){if(t instanceof vl)return new vl(t.h,t.s,t.l,t.opacity);t instanceof Jn||(t=Kn(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(ml*r+dl*e-pl*n)/(ml+dl-pl),o=r-i,a=(hl*(n-i)-ll*o)/fl,s=Math.sqrt(a*a+o*o)/(hl*i*(1-i)),u=s?Math.atan2(a,o)*qc-120:NaN;return new vl(u<0?u+360:u,s,i,t.opacity)}function yl(t,e,n,r){return 1===arguments.length?gl(t):new vl(t,e,n,null==r?1:r)}function vl(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function bl(t){return function e(n){function r(e,r){var i=t((e=yl(e)).h,(r=yl(r)).h),o=pr(e.s,r.s),a=pr(e.l,r.l),s=pr(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=o(t),e.l=a(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}Dn(vl,yl,Fn(Nn,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new vl(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new vl(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*$c,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new Jn(255*(e+n*(ul*r+cl*i)),255*(e+n*(ll*r+fl*i)),255*(e+n*(hl*r)),this.opacity)}}));var wl=bl(hr),Al=bl(pr),El=function(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n};function xl(t,e,n){return bc(_l(e||"rgb",n),t)}function _l(t,e){var n=r[function(t){return"interpolate"+t.toLowerCase().split("-").map((function(t){return t[0].toUpperCase()+t.slice(1)})).join("")}(t)];return null!=e&&n&&n.gamma?n.gamma(e):n}function Cl(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function Tl(t,e){for(let n in t)Sl(n,e(t[n]))}const Ol={};function Sl(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(Ol[t]=e,this):Ol[t]}
/*!
 * Adapted from vega-encode:
 * https://github.com/vega/vega/blob/master/packages/vega-encode/src/ticks.js
 *
 * Copyright (c) 2015-2018, University of Washington Interactive Data Lab
 * All rights reserved.
 *
 * BSD-3-Clause License: https://github.com/vega/vega-lite/blob/master/LICENSE
 */function Ml(t,e,n){return Object(V.m)(e)&&null!=n&&(e=Math.min(e,~~(Object(V.r)(t.domain())/n)||1)),Object(V.n)(e)&&(e.step,e=e.interval),e}function kl(t,e,n){var r=t.range(),i=Math.floor(r[0]),o=Math.ceil(Object(V.q)(r));if(i>o&&(r=o,o=i,i=r),e=e.filter((function(e){return e=t(e),i<=e&&e<=o})),n>0&&e.length>1){for(var a=[e[0],Object(V.q)(e)];e.length>n&&e.length>=3;)e=e.filter((function(t,e){return!(e%2)}));e.length<3&&(e=a)}return e}function Dl(t,e,n){var r,i,o=t.tickFormat?t.tickFormat(e,n):n?Xr(n):String;if(_u(t.type)){var a=function(t){var e=Hr(t||",");if(null==e.precision){switch(e.precision=12,e.type){case"%":e.precision-=2;break;case"e":e.precision-=1}return function(t,e){return function(n){var r,i,o=t(n),a=o.indexOf(e);if(a<0)return o;for(i=(r=function(t,e){var n,r=t.lastIndexOf("e");if(r>0)return r;for(r=t.length;--r>e;)if((n=t.charCodeAt(r))>=48&&n<=57)return r+1}
/*!
 * Adapted from vega-encode:
 * https://github.com/vega/vega/blob/master/packages/vega-encode/src/Scale.js
 *
 * Copyright (c) 2015-2018, University of Washington Interactive Data Lab
 * All rights reserved.
 *
 * BSD-3-Clause License: https://github.com/vega/vega-lite/blob/master/LICENSE
 */(o,a))<o.length?o.slice(r):"";--r>a;)if("0"!==o[r]){++r;break}return o.slice(0,r)+i}}(Xr(e),Xr(".1f")(1)[1])}return Xr(e)}(n);o=t.bins?a:(r=o,i=a,function(t){return r(t)?i(t):""})}return o}Tl({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},Cl),Tl({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},t=>xl(Cl(t)));function Fl(t){return Cu(t)&&t!==Eu}var Nl=Object(V.w)(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function Il(t,e){const n=Oc(function(t){var e,n=t.type,r="";if(n===Eu)return"sequential-linear";(function(t){const e=t.type;return Cu(e)&&"time"!==e&&"utc"!==e&&(t.scheme||t.range&&t.range.length&&t.range.every(V.o))})(t)&&(e=t.rawDomain?t.rawDomain.length:t.domain?t.domain.length+ +(null!=t.domainMid):0,r=2===e?"sequential-":3===e?"diverging-":"");return(r+n||"linear").toLowerCase()}(t))(),r=e||{warn:(t,...e)=>console.warn(t,...e)};for(const e in t)if(!Nl[e]){if("padding"===e&&Fl(n.type))continue;Object(V.l)(n[e])?n[e](t[e]):r.warn("Unsupported scale property: "+e)}return function(t,e,n){var r=t.type,i=e.round||!1,o=e.range;if(null!=e.rangeStep)o=function(t,e,n){"band"!==t&&"point"!==t&&Object(V.d)("Only band and point scales support rangeStep.");var r=(null!=e.paddingOuter?e.paddingOuter:e.padding)||0,i="point"===t?1:(null!=e.paddingInner?e.paddingInner:e.padding)||0;return[0,e.rangeStep*vu(n,i,r)]}(r,e,n);else if(e.scheme&&(o=function(t,e,n){var r,i,o=e.schemeExtent;Object(V.j)(e.scheme)?i=xl(e.scheme,e.interpolate,e.interpolateGamma):(r=e.scheme.toLowerCase(),(i=Sl(r))||Object(V.d)(`Unrecognized scheme name: ${e.scheme}`));return n="threshold"===t?n+1:"bin-ordinal"===t?n-1:"quantile"===t||"quantize"===t?+e.schemeCount||5:n,xu(t)?Bl(i,o,e.reverse):Object(V.l)(i)?function(t,e){for(var n=new Array(e),r=e+1,i=0;i<e;)n[i]=t(++i/r);return n}(Bl(i,o),n):"ordinal"===t?i:i.slice(0,n)}(r,e,n),Object(V.l)(o))){if(t.interpolator)return t.interpolator(o);Object(V.d)(`Scale type ${r} does not support interpolating color schemes.`)}if(o&&xu(r))return t.interpolator(xl(Ll(o,e.reverse),e.interpolate,e.interpolateGamma));o&&e.interpolate&&t.interpolate?t.interpolate(_l(e.interpolate,e.interpolateGamma)):Object(V.l)(t.round)?t.round(i):Object(V.l)(t.rangeRound)&&t.interpolate(i?kr:Mr);o&&t.range(Ll(o,e.reverse))}(n,t,function(t,e,n){let r=e.bins;if(r&&!Object(V.j)(r)){const e=(null==r.start||null==r.stop)&&t.domain(),n=null==r.start?e[0]:r.start,i=null==r.stop?Object(V.q)(e):r.stop,o=r.step;o||Object(V.d)("Scale bins parameter missing step property."),r=Tu(n,i+o,o)}r?t.bins=r:t.bins&&delete t.bins;"bin-ordinal"===t.type&&(r?e.domain||e.domainRaw||(t.domain(r),n=r.length):t.bins=t.domain());return n}(n,t,function(t,e,n){var r=function(t,e,n){return e?(t.domain(Rl(t.type,e,n)),e.length):-1}(t,e.domainRaw,n);if(r>-1)return r;var i,o,a=e.domain,s=t.type,u=e.zero||void 0===e.zero&&function(t){const e=t.type;return!t.bins&&("linear"===e||e===wu||e===Au)}(t);if(!a)return 0;Fl(s)&&e.padding&&a[0]!==Object(V.q)(a)&&(a=function(t,e,n,r,i,o){var a=Math.abs(Object(V.q)(n)-n[0]),s=a/(a-2*r),u=t===bu?Object(V.z)(e,null,s):t===Au?Object(V.A)(e,null,s,.5):t===wu?Object(V.A)(e,null,s,i||1):"symlog"===t?Object(V.B)(e,null,s,o||1):Object(V.y)(e,null,s);return(e=e.slice())[0]=u[0],e[e.length-1]=u[1],e}(s,a,e.range,e.padding,e.exponent,e.constant));(u||null!=e.domainMin||null!=e.domainMax||null!=e.domainMid)&&(i=(a=a.slice()).length-1||1,u&&(a[0]>0&&(a[0]=0),a[i]<0&&(a[i]=0)),null!=e.domainMin&&(a[0]=e.domainMin),null!=e.domainMax&&(a[i]=e.domainMax),null!=e.domainMid&&(((o=e.domainMid)<a[0]||o>a[i])&&n.warn("Scale domainMid exceeds domain min or max.",o),a.splice(i,0,o)));t.domain(Rl(s,a,n)),"ordinal"===s&&t.unknown(e.domainImplicit?Ou:void 0);e.nice&&t.nice&&t.nice(!0!==e.nice&&Ml(t,e.nice)||null);return a.length}(n,t,r))),n}function Rl(t,e,n){_u(t)&&(Math.abs(e.reduce((function(t,e){return t+(e<0?-1:e>0?1:0)}),0))!==e.length&&n.warn("Log scale domain includes zero: "+Object(V.s)(e)));return e}function Bl(t,e,n){return Object(V.l)(t)&&(e||n)?(r=t,i=Ll(e||[0,1],n),o=i[0],a=Object(V.q)(i)-o,function(t){return r(o+t*a)}):t;var r,i,o,a}function Ll(t,e){return e?t.slice().reverse():t}class Pl{constructor(t){this.channel=t,this.views=[],this.scale={},this.type=null}static createExplicitResolution(t,e){const n=new Pl(t);return n.scale=e,n._scale=Il(n.scale),n}pushUnitView(t){const e=this._getEncoding(t).type;if(this.type){if(e!==this.type)throw new Error(`Can not use shared scale for different data types: ${this.type} vs. ${e}. Use "resolve: independent" for channel ${this.channel}`)}else this.type=e;this.views.push(t)}getAxisProps(){const t=this.views.map(t=>this._getEncoding(t).axis);return t.length>0&&t.every(t=>null===t)?null:yu(t.filter(t=>void 0!==t),"axis",["title"])}isDomainDefined(){if(this._explicitDomain)return!0;for(const t of this.views){const e=this._getEncoding(t).scale;return e&&Array.isArray(e.domain)}return!1}getScaleProps(){return yu(this.views.map(t=>this._getEncoding(t).scale).filter(t=>void 0!==t),"scale",["domain"])}getTitle(){return[...new Set(this.views.map(t=>{const e=this._getEncoding(t);return[null===e.axis?null:void 0,null!==e.axis&&"object"==typeof e.axis?e.axis.title:void 0,e.title,e.field,e.expr].filter(t=>void 0!==t).shift()}).filter(V.o))].join(", ")}setDomain(t){this._explicitDomain=t,this._scale=void 0}getDataDomain(){if(this._explicitDomain)return this._explicitDomain;const t=this.views.map(t=>t.getDomain(this.channel)).filter(t=>!!t);if(t.length>1)return t.reduce((t,e)=>t.extendAll(e));if(1===t.length)return t[0];throw new Error(`Cannot resolve domain! Channel: ${this.channel}, views: ${this.views.map(t=>t.getPathString()).join(", ")}`)}getDomain(){return this.getScale().domain()}getScale(){if(this._scale)return this._scale;const t=this.getDataDomain();if(!t)return;const e={type:zl(this.channel,t.type),...this._getDefaultScaleProperties(t.type),...this.getScaleProps(),domain:t,...Ul(this.channel)};return Array.isArray(e.range)&&delete e.scheme,this._scale=Il(e),this._scale}_getEncoding(t){return t.getEncoding()[this.channel]}_getDefaultScaleProperties(t){const e=this.channel,n={};return this.isDomainDefined()&&(n.zero=!1),"x"!=e||this.isDomainDefined()||(n.zero=!0),"y"==e||"x"==e?n.nice=!1:"color"==e?n.scheme="nominal"==t?"tableau10":"ordinal"==t?"blues":"viridis":"shape"==e?n.range=Object.keys(nu):"size"==e&&(n.range=[0,400]),n}}function zl(t,e){const n={x:[null,"identity"],y:["band","linear"],size:["point","linear"],opacity:["point","linear"],color:["ordinal","linear"],shape:["ordinal",null],sample:["identity",null]};return n[t]?n[t]["quantitative"==e?1:0]:"quantitative"==e?"linear":"ordinal"}function Ul(t){return{y:{range:[0,1]}}[t]||{}}class Wl extends Array{constructor(){super(),this.type=void 0}extend(t){return this}extendAll(t){if(t instanceof Wl&&t.type!=this.type)throw new Error(`Cannot combine different types of domains: ${this.type} and ${t.type}`);for(const e of t)this.extend(e);return this}}class jl extends Wl{constructor(){super(),this.type="ordinal",this.uniqueValues=new Set}extend(t){return null==t||Number.isNaN(t)?this:(this.uniqueValues.has(t)||(this.uniqueValues.add(t),this.push(t)),this)}}class Hl extends Wl{constructor(t){super();let e=0;for(let n=1;n<t.length;n++)e+=Math.sign(t[n]-t[n-1]);if(Math.abs(e)!=t.length-1)throw new Error("Piecewise domain must be strictly increasing or decreasing: "+JSON.stringify(t));t.forEach(t=>this.push(t))}extend(t){if(this.includes(t))return this;throw new Error("Piecewise domains are immutable and cannot be unioned!")}}const Yl={quantitative:class extends Wl{constructor(){super(),this.type="quantitative"}extend(t){return null==t||Number.isNaN(t)?this:(t=+t,this.length?t<this[0]?this[0]=t:t>this[1]&&(this[1]=t):(this.push(t),this.push(t)),this)}},nominal:class extends jl{constructor(){super(),this.type="nominal"}},ordinal:jl};function $l(t,e){if("quantitative"==t&&((n=e)&&n.length>0&&2!=n.length&&n.every(t=>"number"==typeof t))){const n=new Hl(e);return n.type=t,n}if(Yl[t]){const n=new Yl[t];return n.type=t,e&&n.extendAll(e),n}var n;throw new Error("Unknown type: "+t)}const ql={point:ru,rect:hu,rule:class extends hu{constructor(t){super(t),this.properties={...du,...this.properties};const e=this.getEncoding()[mu],n=this.properties;Object.assign(this.properties,e?{minWidth:n.size,minHeight:n.minLength,minOpacity:1}:{minWidth:n.minLength,minHeight:n.size,minOpacity:1})}getDefaultEncoding(){return{...super.getDefaultEncoding(),...pu}}getEncoding(){const t={...this.getDefaultEncoding(),...this.unitView.getEncoding()};let e;if(t.x&&!t.y)e=!0,t.y={value:-1/0},t.y2={value:1/0},t.x2=t.x;else if(t.y&&!t.x)e=!1,t.x={value:-1/0},t.x2={value:1/0},t.y2=t.y;else if(t.x&&t.y&&t.y2)e=!0,t.x2=t.x;else if(t.y&&t.x&&t.x2)e=!1,t.y2=t.y;else{if(!t.y||!t.x||t.x2||"quantitative"!=t.y.type||t.y2)throw new Error("Invalid x and y encodings for rule mark: "+JSON.stringify(t));e=!0,t.x2=t.x,t.y2={constant:0}}return t[mu]=e,t}}};class Xl extends Wo{constructor(t,e,n,r){super(t,e,n,r),this.spec=t,this._dataDomains={},this._accessors={};const i=ql[this.getMarkType()];if(!i)throw new Error(`No such mark: ${this.getMarkType()}`);this.mark=new i(this)}getMarkType(){return"object"==typeof this.spec.mark?this.spec.mark.type:this.spec.mark}resolve(){const t=this.getEncoding();for(const e in t){if(Zs(e))continue;if(!this.getAccessor(e))continue;let t=this;for(;t.parent instanceof gu&&"shared"==t.parent.getConfiguredOrDefaultResolution(e);)t=t.parent;t.resolutions[e]||(t.resolutions[e]=new Pl(e)),t.resolutions[e].pushUnitView(this)}}getResolution(t){let e=this;do{if(e.resolutions[t])return e.resolutions[t];e=e.parent}while(e)}getAccessor(t){if(this._accessors.hasOwnProperty(t))return this._accessors[t];const e=this.mark.getEncoding();if(e&&e[t]){const n=this.context.accessorFactory.createAccessor(e[t]);return this._accessors[t]=n,n}}_getCoordinateSystemExtent(){const t=this.context.coordinateSystem;return t&&t.getExtent()||void 0}getDomain(t){if(Zs(t))throw new Error(`getDomain(${t}), must only be called for primary channels!`);const e=this.getEncoding()[t],n=e.type;if(!n)throw new Error(`No data type for channel "${t}"!`);const r=e&&e.scale&&e.scale.domain;if(r)return $l(n,r);let i=this._extractDomain(t,n);i||console.warn(`Cannot extract domain for channel "${t}" on ${this.getPathString()}. You can specify it explicitly.`);const o=Ks[t];if(o){const t=this._extractDomain(o,n);t&&i.extendAll(t)}return i}_extractDomain(t,e){if(this._dataDomains[t])return this._dataDomains[t];let n;const r=this.getData(),i=this.getEncoding()[t];if(i){const t=this.context.accessorFactory.createAccessor(i);if(t)if(n=$l(e),t.constant)n.extend(t({}));else for(const e of r.flatData())n.extend(t(e))}return this._dataDomains[t]=n,n}}class Vl extends gu{constructor(t,e,n,r){super(t,e,n,r),this.children=(t.layer||[]).map((t,n)=>new(tf(t))(t,e,this,"layer"+n))}}class Gl extends gu{constructor(t,e,n,r){super(t,e,n,r),this.children=(t.concat||[]).map((t,n)=>new(tf(t))(t,e,this,"concat"+n))}getDefaultResolution(t){return"x"==t?"shared":"independent"}}function Kl(t){return"string"==typeof t.mark||"object"==typeof t.mark}function Zl(t){return"object"==typeof t.layer}function Jl(t){return Array.isArray(t.concat)}function Ql(t){return!!t.import}function tf(t){if(Ql(t))return jo;if(Kl(t))return Xl;if(Zl(t))return Vl;if(Jl(t))return Gl;throw new Error("Invalid spec, cannot figure out the view: "+JSON.stringify(t))}function ef(t,e){return new(tf(t))(t,e,null,t.name||"root")}function nf(t){return rf(t).filter(t=>t instanceof Xl).map(t=>t.mark)}function rf(t){const e=[];return t.visit(t=>{e.push(t)}),e}const of={values:null,minExtent:30,maxExtent:1/0,offset:0,domain:!0,domainWidth:1,domainColor:"gray",ticks:!0,tickSize:6,tickWidth:1,tickColor:"gray",tickCount:null,tickMinStep:null,labels:!0,labelPadding:4,labelFont:"sans-serif",labelFontSize:10,labelLimit:180,labelColor:"black",format:null,titleColor:"black",titleFont:"sans-serif",titleFontSize:10,titlePadding:5};function af(t,e,n,r="vertical",i){let o=0;i=i||t.getScale();const a=t.getAxisProps();if(null===a)return;const s={...of,...a},u={offsets:{domain:0,ticks:0,labels:0,title:0},width:0,ticks:[],tickLabels:[],title:void 0,scale:i.copy().range([e,0]),props:s};o+=s.offset,u.offsets.domain=o;let c=s.tickCount||"vertical"==r?Math.round(e/Math.exp(e/800)/s.labelFontSize/1.7):Math.round(e/80);if(c=Ml(i,c,s.tickMinStep),u.ticks=s.values?kl(i,s.values,c):function(t,e){return t.bins?kl(t,function(t,e){var n=t.length,r=~~(n/(e||n));return r<2?t.slice():t.filter((function(t,e){return!(e%r)}))}(t.bins,e)):t.ticks?t.ticks(e):t.domain()}(i,c),s.ticks&&(o+=s.tickSize,u.offsets.ticks=o),s.labels){o+=s.labelPadding,u.offsets.labels=o;const t=Dl(i,c,s.format);u.tickLabels=u.ticks.map(t),o+="vertical"==r?u.tickLabels.map(t=>n(t)).reduce((t,e)=>Math.max(t,e),0):s.labelFontSize}return u.title=t.getTitle(),u.title&&(o+=s.titlePadding,o+=s.titleFontSize,u.offsets.title=o),u.width=o,u}var sf=function(t){if(!(i=t.length))return[];for(var e=-1,n=xc(t,uf),r=new Array(n);++e<n;)for(var i,o=-1,a=r[e]=new Array(i);++o<i;)a[o]=t[o][e];return r};function uf(t){return t.length}const cf=Xr(".4~r"),lf=Xr(".4~e");function ff(t){return null===t?"":Object(V.o)(t)?t.substring(0,30):Number.isInteger(t)?""+t:Object(V.m)(t)?Math.abs(t)>Math.pow(10,8)||Math.abs(t)<Math.pow(10,-8)?lf(t):cf(t):Object(V.k)(t)?t?"True":"False":"?"+typeof t+" "+t}function hf(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function df(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function mf(t,e,n){return e&&pf(t.prototype,e),n&&pf(t,n),t}function gf(t){return(gf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yf(t,e){return!e||"object"!==gf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vf(t){return(vf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bf(t,e){return(bf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function wf(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bf(t,e)}function Af(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Ef(t,e,n){return(Ef=Af()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&bf(i,n.prototype),i}).apply(null,arguments)}function xf(t){var e="function"==typeof Map?new Map:void 0;return(xf=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return Ef(t,arguments,vf(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),bf(r,t)})(t)}var _f={};function Cf(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function Tf(t){return Math.round(t/_f.EPSILON)*_f.EPSILON}function Of(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.precision,r=void 0===n?_f.precision||4:n;return t=Tf(t),parseFloat(t.toPrecision(r))}function Sf(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&void 0!==t.length}function Mf(t,e){if(Sf(t)&&Sf(e)){if(t===e)return!0;if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!Mf(t[n],e[n]))return!1;return!0}return Math.abs(t-e)<=_f.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}_f.EPSILON=1e-12,_f.debug=!0,_f.precision=4,_f.printTypes=!1,_f.printDegrees=!1,_f.printRowMajor=!0;var kf=function(t){function e(){return df(this,e),yf(this,vf(e).apply(this,arguments))}return wf(e,t),mf(e,[{key:"clone",value:function(){return(new this.constructor).copy(this).check()}},{key:"copy",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=t[e];return this.check()}},{key:"set",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=(t<0||arguments.length<=t?void 0:arguments[t])||0;return this.check()}},{key:"fromArray",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}},{key:"toString",value:function(){return this.formatString(_f)}},{key:"formatString",value:function(t){for(var e="",n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+Of(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}},{key:"toArray",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}},{key:"toFloat32Array",value:function(){return new Float32Array(this)}},{key:"equals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(!Mf(this[e],t[e]))return!1;return!0}},{key:"exactEquals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}},{key:"negate",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}},{key:"inverse",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=1/this[t];return this.check()}},{key:"lerp",value:function(t,e,n){void 0===n&&(n=e,e=t,t=this);for(var r=0;r<this.ELEMENTS;++r){var i=t[r];this[r]=i+n*(e[r]-i)}return this.check()}},{key:"min",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}},{key:"max",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}},{key:"clamp",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}},{key:"validate",value:function(){for(var t=this.length===this.ELEMENTS,e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}},{key:"check",value:function(){if(_f.debug&&!this.validate(this))throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}},{key:"sub",value:function(t){return this.subtract(t)}},{key:"setScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}},{key:"addScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}},{key:"subScalar",value:function(t){return this.addScalar(-t)}},{key:"multiplyScalar",value:function(t){return this.scale(t)}},{key:"divideScalar",value:function(t){return this.scale(1/t)}},{key:"clampScalar",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}}]),e}(xf(Array));function Df(t,e){return t.length===e&&t.every(Number.isFinite)}var Ff=function(t,e){if(!t)throw new Error(e)},Nf=function(t){function e(){return df(this,e),yf(this,vf(e).apply(this,arguments))}return wf(e,t),mf(e,[{key:"len",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"magnitude",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"lengthSquared",value:function(){for(var t=0,e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}},{key:"distance",value:function(t){return Math.sqrt(this.distanceSquared(t))}},{key:"distanceSquared",value:function(t){for(var e=0,n=0;n<this.ELEMENTS;++n){var r=this[n]-t[n];e+=r*r}return Cf(e)}},{key:"dot",value:function(t){for(var e=0,n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return Cf(e)}},{key:"normalize",value:function(){var t=this.magnitude();if(0!==t)for(var e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}},{key:"add",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<this.ELEMENTS;++o)this[o]+=i[o];return this.check()}},{key:"subtract",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<this.ELEMENTS;++o)this[o]-=i[o];return this.check()}},{key:"multiply",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<this.ELEMENTS;++o)this[o]*=i[o];return this.check()}},{key:"divide",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<this.ELEMENTS;++o)this[o]/=i[o];return this.check()}},{key:"scale",value:function(t){if(Array.isArray(t))return this.multiply(t);for(var e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}},{key:"scaleAndAdd",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=this[n]*e+t[n];return this.check()}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"distanceTo",value:function(t){return this.distance(t)}},{key:"distanceToSquared",value:function(t){return this.distanceSquared(t)}},{key:"getComponent",value:function(t){return Ff(t>=0&&t<this.ELEMENTS,"index is out of range"),Cf(this[t])}},{key:"setComponent",value:function(t,e){return Ff(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}},{key:"addVectors",value:function(t,e){return this.copy(t).add(e)}},{key:"subVectors",value:function(t,e){return this.copy(t).subtract(e)}},{key:"multiplyVectors",value:function(t,e){return this.copy(t).multiply(e)}},{key:"addScaledVector",value:function(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}},{key:"x",get:function(){return this[0]},set:function(t){return this[0]=Cf(t)}},{key:"y",get:function(){return this[1]},set:function(t){return this[1]=Cf(t)}}]),e}(kf),If="undefined"!=typeof Float32Array?Float32Array:Array;Math.random;Math.PI;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});Rf=new If(2),If!=Float32Array&&(Rf[0]=0,Rf[1]=0),Bf=Rf;var Rf,Bf,Lf=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return df(this,e),t=yf(this,vf(e).call(this,2)),Array.isArray(n)&&1===arguments.length?t.copy(n):t.set(n,r),t}return wf(e,t),mf(e,[{key:"cross",value:function(t){return function(t,e,n){var r=e[0]*n[1]-e[1]*n[0];t[0]=t[1]=0,t[2]=r}(this,this,t),this.check()}},{key:"horizontalAngle",value:function(){return Math.atan2(this.y,this.x)}},{key:"verticalAngle",value:function(){return Math.atan2(this.x,this.y)}},{key:"operation",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t.apply(void 0,[this,this].concat(n)),this.check()}},{key:"ELEMENTS",get:function(){return 2}}]),e}(Nf);!function(){var t=function(){var t=new If(3);return If!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}()}();var Pf=[0,0,0],zf=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return df(this,e),t=yf(this,vf(e).call(this,3)),Array.isArray(n)&&1===arguments.length?t.copy(n):t.set(n,r,i),t}return wf(e,t),mf(e,[{key:"angle",value:function(t){return n=t,r=(e=this)[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2],c=Math.sqrt(r*r+i*i+o*o)*Math.sqrt(a*a+s*s+u*u),l=c&&function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}(e,n)/c,Math.acos(Math.min(Math.max(l,-1),1));var e,n,r,i,o,a,s,u,c,l}},{key:"cross",value:function(t){return function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2];t[0]=i*u-o*s,t[1]=o*a-r*u,t[2]=r*s-i*a}(this,this,t),this.check()}},{key:"rotateX",value:function(t){var e=t.radians,n=t.origin;return function(t,e,n,r){var i=[],o=[];i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2]}(this,this,void 0===n?Pf:n,e),this.check()}},{key:"rotateY",value:function(t){var e=t.radians,n=t.origin;return function(t,e,n,r){var i=[],o=[];i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2]}(this,this,void 0===n?Pf:n,e),this.check()}},{key:"rotateZ",value:function(t){var e=t.radians,n=t.origin;return function(t,e,n,r){var i=[],o=[];i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2]}(this,this,void 0===n?Pf:n,e),this.check()}},{key:"operation",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t.apply(void 0,[this,this].concat(n)),this.check()}},{key:"ELEMENTS",get:function(){return 3}},{key:"z",get:function(){return this[2]},set:function(t){return this[2]=Cf(t)}}]),e}(Nf),Uf=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return df(this,e),t=yf(this,vf(e).call(this,4)),Array.isArray(n)&&1===arguments.length?t.copy(n):t.set(n,r,i,o),t}return wf(e,t),mf(e,[{key:"applyMatrix4",value:function(t){return t.transformVector(this,this),this}},{key:"ELEMENTS",get:function(){return 4}},{key:"z",get:function(){return this[2]},set:function(t){return this[2]=Cf(t)}},{key:"w",get:function(){return this[3]},set:function(t){return this[3]=Cf(t)}}]),e}(Nf);function Wf(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],d=e[10],p=e[11],m=e[12],g=e[13],y=e[14],v=e[15],b=n[0],w=n[1],A=n[2],E=n[3];return t[0]=b*r+w*s+A*f+E*m,t[1]=b*i+w*u+A*h+E*g,t[2]=b*o+w*c+A*d+E*y,t[3]=b*a+w*l+A*p+E*v,b=n[4],w=n[5],A=n[6],E=n[7],t[4]=b*r+w*s+A*f+E*m,t[5]=b*i+w*u+A*h+E*g,t[6]=b*o+w*c+A*d+E*y,t[7]=b*a+w*l+A*p+E*v,b=n[8],w=n[9],A=n[10],E=n[11],t[8]=b*r+w*s+A*f+E*m,t[9]=b*i+w*u+A*h+E*g,t[10]=b*o+w*c+A*d+E*y,t[11]=b*a+w*l+A*p+E*v,b=n[12],w=n[13],A=n[14],E=n[15],t[12]=b*r+w*s+A*f+E*m,t[13]=b*i+w*u+A*h+E*g,t[14]=b*o+w*c+A*d+E*y,t[15]=b*a+w*l+A*p+E*v,t}function jf(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Hf(t,e,n,r,i){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}function Yf(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}!function(){var t=function(){var t=new If(4);return If!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}()}();var $f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var qf=function(t){function e(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return df(this,e),t=yf(this,vf(e).call(this,16)),Array.isArray(r[0])&&1===arguments.length?t.copy(r[0]):t.identity(),t}return wf(e,t),mf(e,[{key:"setRowMajor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,l=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1,f=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,h=arguments.length>12&&void 0!==arguments[12]?arguments[12]:0,d=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,p=arguments.length>14&&void 0!==arguments[14]?arguments[14]:0,m=arguments.length>15&&void 0!==arguments[15]?arguments[15]:1;return this[0]=t,this[1]=i,this[2]=u,this[3]=h,this[4]=e,this[5]=o,this[6]=c,this[7]=d,this[8]=n,this[9]=a,this[10]=l,this[11]=p,this[12]=r,this[13]=s,this[14]=f,this[15]=m,this.check()}},{key:"setColumnMajor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,l=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1,f=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,h=arguments.length>12&&void 0!==arguments[12]?arguments[12]:0,d=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,p=arguments.length>14&&void 0!==arguments[14]?arguments[14]:0,m=arguments.length>15&&void 0!==arguments[15]?arguments[15]:1;return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=a,this[7]=s,this[8]=u,this[9]=c,this[10]=l,this[11]=f,this[12]=h,this[13]=d,this[14]=p,this[15]=m,this.check()}},{key:"set",value:function(){return this.setColumnMajor.apply(this,arguments)}},{key:"getElement",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?this[t][e]:this[e][t]}},{key:"setElement",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return r?this[t][e]=Cf(n):this[e][t]=Cf(n),this}},{key:"determinant",value:function(){return e=(t=this)[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],f=t[10],h=t[11],d=t[12],p=t[13],m=t[14],g=t[15],(e*a-n*o)*(f*g-h*m)-(e*s-r*o)*(l*g-h*p)+(e*u-i*o)*(l*m-f*p)+(n*s-r*a)*(c*g-h*d)-(n*u-i*a)*(c*m-f*d)+(r*u-i*s)*(c*p-l*d);var t,e,n,r,i,o,a,s,u,c,l,f,h,d,p,m,g}},{key:"identity",value:function(){return this.copy($f)}},{key:"fromQuaternion",value:function(t){return function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,f=r*s,h=i*a,d=i*s,p=i*u,m=o*a,g=o*s,y=o*u;t[0]=1-f-p,t[1]=l+y,t[2]=h-g,t[3]=0,t[4]=l-y,t[5]=1-c-p,t[6]=d+m,t[7]=0,t[8]=h+g,t[9]=d-m,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(this,t),this.check()}},{key:"frustum",value:function(t){return function(t,e,n,r,i,o,a){var s=1/(n-e),u=1/(i-r),c=1/(o-a);t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*u,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0}(this,t.left,t.right,t.bottom,t.top,t.near,t.far),this.check()}},{key:"lookAt",value:function(t){var e=t.eye,n=t.center,r=void 0===n?[0,0,0]:n,i=t.up;return function(t,e,n,r){var i,o,a,s,u,c,l,f,h,d,p=e[0],m=e[1],g=e[2],y=r[0],v=r[1],b=r[2],w=n[0],A=n[1],E=n[2];Math.abs(p-w)<1e-6&&Math.abs(m-A)<1e-6&&Math.abs(g-E)<1e-6?function(t){t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(t):(l=p-w,f=m-A,h=g-E,i=v*(h*=d=1/Math.hypot(l,f,h))-b*(f*=d),o=b*(l*=d)-y*h,a=y*f-v*l,(d=Math.hypot(i,o,a))?(i*=d=1/d,o*=d,a*=d):(i=0,o=0,a=0),s=f*a-h*o,u=h*i-l*a,c=l*o-f*i,(d=Math.hypot(s,u,c))?(s*=d=1/d,u*=d,c*=d):(s=0,u=0,c=0),t[0]=i,t[1]=s,t[2]=l,t[3]=0,t[4]=o,t[5]=u,t[6]=f,t[7]=0,t[8]=a,t[9]=c,t[10]=h,t[11]=0,t[12]=-(i*p+o*m+a*g),t[13]=-(s*p+u*m+c*g),t[14]=-(l*p+f*m+h*g),t[15]=1)}(this,e,r,void 0===i?[0,1,0]:i),this.check()}},{key:"ortho",value:function(t){var e=t.left,n=t.right,r=t.bottom,i=t.top,o=t.near,a=void 0===o?.1:o,s=t.far;return function(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),c=1/(o-a);t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(a+o)*c,t[15]=1}(this,e,n,r,i,a,void 0===s?500:s),this.check()}},{key:"orthographic",value:function(t){var n=t.fovy,r=void 0===n?45*Math.PI/180:n,i=t.aspect,o=void 0===i?1:i,a=t.focalDistance,s=void 0===a?1:a,u=t.near,c=void 0===u?.1:u,l=t.far,f=void 0===l?500:l;if(r>2*Math.PI)throw Error("radians");var h=r/2,d=s*Math.tan(h),p=d*o;return(new e).ortho({left:-p,right:p,bottom:-d,top:d,near:c,far:f})}},{key:"perspective",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.fovy,n=t.fov,r=void 0===n?45*Math.PI/180:n,i=t.aspect,o=void 0===i?1:i,a=t.near,s=void 0===a?.1:a,u=t.far,c=void 0===u?500:u;if((e=e||r)>2*Math.PI)throw Error("radians");return Hf(this,e,o,s,c),this.check()}},{key:"transpose",value:function(){return function(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15]}(this,this),this.check()}},{key:"invert",value:function(){return function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],h=e[10],d=e[11],p=e[12],m=e[13],g=e[14],y=e[15],v=n*s-r*a,b=n*u-i*a,w=n*c-o*a,A=r*u-i*s,E=r*c-o*s,x=i*c-o*u,_=l*m-f*p,C=l*g-h*p,T=l*y-d*p,O=f*g-h*m,S=f*y-d*m,M=h*y-d*g,k=v*M-b*S+w*O+A*T-E*C+x*_;k&&(k=1/k,t[0]=(s*M-u*S+c*O)*k,t[1]=(i*S-r*M-o*O)*k,t[2]=(m*x-g*E+y*A)*k,t[3]=(h*E-f*x-d*A)*k,t[4]=(u*T-a*M-c*C)*k,t[5]=(n*M-i*T+o*C)*k,t[6]=(g*w-p*x-y*b)*k,t[7]=(l*x-h*w+d*b)*k,t[8]=(a*S-s*T+c*_)*k,t[9]=(r*T-n*S-o*_)*k,t[10]=(p*E-m*w+y*v)*k,t[11]=(f*w-l*E-d*v)*k,t[12]=(s*C-a*O-u*_)*k,t[13]=(n*O-r*C+i*_)*k,t[14]=(m*b-p*A-g*v)*k,t[15]=(l*A-f*b+h*v)*k)}(this,this),this.check()}},{key:"multiplyLeft",value:function(t){return Wf(this,t,this),this.check()}},{key:"multiplyRight",value:function(t){return Wf(this,this,t),this.check()}},{key:"rotateX",value:function(t){return function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],f=e[10],h=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+l*r,t[6]=s*i+f*r,t[7]=u*i+h*r,t[8]=c*i-o*r,t[9]=l*i-a*r,t[10]=f*i-s*r,t[11]=h*i-u*r}(this,this,t),this.check()}},{key:"rotateY",value:function(t){return function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[8],l=e[9],f=e[10],h=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*r,t[1]=a*i-l*r,t[2]=s*i-f*r,t[3]=u*i-h*r,t[8]=o*r+c*i,t[9]=a*r+l*i,t[10]=s*r+f*i,t[11]=u*r+h*i}(this,this,t),this.check()}},{key:"rotateZ",value:function(t){return function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],l=e[5],f=e[6],h=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=a*i+l*r,t[2]=s*i+f*r,t[3]=u*i+h*r,t[4]=c*i-o*r,t[5]=l*i-a*r,t[6]=f*i-s*r,t[7]=h*i-u*r}(this,this,t),this.check()}},{key:"rotateXYZ",value:function(t){var e=hf(t,3),n=e[0],r=e[1],i=e[2];return this.rotateX(n).rotateY(r).rotateZ(i)}},{key:"rotateAxis",value:function(t,e){return function(t,e,n,r){var i,o,a,s,u,c,l,f,h,d,p,m,g,y,v,b,w,A,E,x,_,C,T,O,S=r[0],M=r[1],k=r[2],D=Math.hypot(S,M,k);D<1e-6||(S*=D=1/D,M*=D,k*=D,i=Math.sin(n),a=1-(o=Math.cos(n)),s=e[0],u=e[1],c=e[2],l=e[3],f=e[4],h=e[5],d=e[6],p=e[7],m=e[8],g=e[9],y=e[10],v=e[11],b=S*S*a+o,w=M*S*a+k*i,A=k*S*a-M*i,E=S*M*a-k*i,x=M*M*a+o,_=k*M*a+S*i,C=S*k*a+M*i,T=M*k*a-S*i,O=k*k*a+o,t[0]=s*b+f*w+m*A,t[1]=u*b+h*w+g*A,t[2]=c*b+d*w+y*A,t[3]=l*b+p*w+v*A,t[4]=s*E+f*x+m*_,t[5]=u*E+h*x+g*_,t[6]=c*E+d*x+y*_,t[7]=l*E+p*x+v*_,t[8]=s*C+f*T+m*O,t[9]=u*C+h*T+g*O,t[10]=c*C+d*T+y*O,t[11]=l*C+p*T+v*O,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]))}(this,this,t,e),this.check()}},{key:"scale",value:function(t){return Array.isArray(t)?jf(this,this,t):jf(this,this,[t,t,t]),this.check()}},{key:"translate",value:function(t){return function(t,e,n){var r,i,o,a,s,u,c,l,f,h,d,p,m=n[0],g=n[1],y=n[2];e===t?(t[12]=e[0]*m+e[4]*g+e[8]*y+e[12],t[13]=e[1]*m+e[5]*g+e[9]*y+e[13],t[14]=e[2]*m+e[6]*g+e[10]*y+e[14],t[15]=e[3]*m+e[7]*g+e[11]*y+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],d=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=f,t[9]=h,t[10]=d,t[11]=p,t[12]=r*m+s*g+f*y+e[12],t[13]=i*m+u*g+h*y+e[13],t[14]=o*m+c*g+d*y+e[14],t[15]=a*m+l*g+p*y+e[15])}(this,this,t),this.check()}},{key:"transformVector2",value:function(t,e){return function(t,e,n){var r=e[0],i=e[1];t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13]}(e=e||new Lf,t,this),Df(e,2),e}},{key:"transformVector3",value:function(t,e){return function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a}(e=e||new zf,t,this),Df(e,3),e}},{key:"transformVector4",value:function(t,e){return Yf(e=e||new Uf,t,this),Df(e,4),e.check()}},{key:"transformVector",value:function(t,e){switch(t.length){case 2:return this.transformVector2(t,e);case 3:return this.transformVector3(t,e);case 4:return this.transformVector4(t,e);default:throw new Error("Illegal vector")}}},{key:"transformDirection",value:function(t,e){return this._transformVector(t,e,0)}},{key:"transformPoint",value:function(t,e){return this._transformVector(t,e,1)}},{key:"_transformVector",value:function(t,e,n){switch(t.length){case 2:Yf(e=e||new Lf,[t[0],t[1],0,n],this),e.length=2,Df(e,2);break;case 3:Yf(e=e||new zf,[t[0],t[1],t[2],n],this),e.length=3,Df(e,3);break;case 4:if(Boolean(n)!==Boolean(t[3]))throw new Error("math.gl: Matrix4.transformPoint - invalid vector");Yf(e=e||new Uf,t,this),Df(e,4);break;default:throw new Error("Illegal vector")}return e}},{key:"makeRotationX",value:function(t){return this.identity().rotateX(t)}},{key:"makeTranslation",value:function(t,e,n){return this.identity().translate([t,e,n])}},{key:"ELEMENTS",get:function(){return 16}}]),e}(kf);class Xf extends Mi{constructor(t,e){super(t,e)}async initialize(t){await super.initialize(t)}initializeWebGL(){this.glCanvas=this.createCanvas();const t=Rs(this.glCanvas);if(!t)throw new Error("Unable to initialize WebGL. Your browser or machine may not support it.");this.gl=t;const e=Zn(this.config.plotBackground||"white");t.clearColor(e.r/255,e.g/255,e.b/255,1),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),this._shaderDefines=Ws(t)}processShader(t){return this._shaderDefines+"\n"+t}adjustGl(){const t=this.gl;t.canvas.width=t.canvas.clientWidth*window.devicePixelRatio,t.canvas.height=this.getHeight()*window.devicePixelRatio,t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),this.viewportProjection=Object.freeze((new qf).ortho({left:0,right:t.canvas.clientWidth,bottom:this.getHeight()||1,top:0,near:0,far:500}))}getDomainUniforms(){const t=this.genomeSpy.getViewportDomain();return{uXScale:Us(1/t.width()),uXTranslate:Us(-t.lower/t.width()),ONE:1}}}const Vf=t=>Promise.resolve(t),Gf=(t,e)=>Object.is(t,e);class Kf{constructor({element:t,resolver:e,tooltip:n,tooltipConverter:r=Vf,eqTest:i=Gf}){this.element=t,this.resolver=e,this.tooltip=n,this.tooltipConverter=r,this.eqTest=i,this.currentTooltipObject=null,this.tooltipDelay=400,this.timeoutId=null,this.currentObject=null;for(let e of["mousemove","mouseleave","wheel","click","mousedown","mouseup","contextmenu"])t.addEventListener(e,t=>this._handleMouseEvent(t),!1);this.eventEmitter=new li.a}on(...t){return this.eventEmitter.on(...t),this}clear(){this._updateTooltip(null)}_handleMouseEvent(t){const e=hi(this.element,t);let n=null;if(["mousemove","click","mousedown","mouseup","contextmenu"].includes(t.type)&&(n=this.resolver(e)),"mousemove"==t.type)this.tooltip&&this.tooltip.handleMouseMove(t);else if(["click","mousedown","mouseup","contextmenu"].includes(t.type)&&n){let r=t.type;"click"==r&&(r=1==t.detail?"click":"dblclick"),this.eventEmitter.emit(r,n,t,e)}this._updateTooltip(0==t.buttons?n:null),n&&n!=this.currentObject?this.eventEmitter.emit("mouseover",n,t,e):n&&!this.currentObject?this.eventEmitter.emit("mouseover",n,t,e):!n&&this.currentObject&&this.eventEmitter.emit("mouseleave",t,e),this.currentObject=n}_updateTooltip(t){this.tooltip&&(this.eqTest(t,this.currentTooltipObject)||("number"==typeof this.timeoutId&&clearTimeout(this.timeoutId),this.tooltip.setContent(null),t&&(this.timeoutId=setTimeout(()=>{this.tooltipConverter(t).then(e=>{this.eqTest(t,this.currentTooltipObject)&&this.tooltip.setContent(e)})},this.tooltipDelay)),this.currentTooltipObject=t))}}function Zf(t){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return t.replace(/[&<>"']/g,t=>e[t])}const Jf={height:null};class Qf extends Xf{constructor(t,e,n){super(t,e),this.styles=Object.assign({},Jf,e.styles),this.view=n}async initialize(t){await super.initialize(t),this.initializeWebGL(),this.leftCanvas=this.createCanvas(),this.trackContainer.className="simple-track","number"==typeof this.styles.height?this.trackContainer.style.height=`${this.styles.height}px`:this.trackContainer.style.flexGrow="1",this.viewportMouseTracker=new Kf({element:this.glCanvas,tooltip:this.genomeSpy.tooltip,resolver:this.findDatumAndMarkAt.bind(this),tooltipConverter:t=>Promise.resolve(this.datumToTooltip(t)),eqTest:(t,e)=>Object.is(t&&t.datum,e&&e.datum)}).on("dblclick",this.zoomToDatum.bind(this)),this.genomeSpy.on("layout",t=>{this.resizeCanvases(t),this.renderViewport(),this.renderYAxis()}),this.genomeSpy.on("zoom",()=>{this.renderViewport()}),this.genomeSpy.zoom.attachZoomEvents(this.glCanvas,t=>{const e=this.findDatumAndMarkAt(t);if(e){const n=e.datum,r=e.mark;r instanceof ru&&(t[0]=this.genomeSpy.rescaledX(r.encoders.x(n)))}return t}),this.initializeGraphics()}initializeGraphics(){this.view.visit(t=>{t instanceof Xl&&t.mark.initializeGraphics(this.gl)})}resizeCanvases(t){this.adjustCanvas(this.glCanvas,t.viewport),this.adjustGl(),this.adjustCanvas(this.leftCanvas,t.axis)}zoomToDatum(t,e,n){const r=t.mark.encoders,i=t.datum;if(r.x&&r.x2){const t=new fi(r.x(i),r.x2(i));this.genomeSpy.zoomTo(t.pad(.25*t.width()))}else if(r.x&&!r.x2){const t=1e6;this.genomeSpy.zoomTo(new fi(r.x(i)-t/2,r.x(i)+t/2))}}_getViewRoot(){let t=this.view;for(;t.parent;)t=t.parent;return t}getXDomain(){return this._getViewRoot().resolutions.x.getScale().domain()}findDatumAndMarkAt(t){const[e,n]=t,r=new fi(0,this.getHeight());for(const t of nf(this.view).reverse())if(null!==t.properties.tooltip){const i=t.findDatum(void 0,e,n,r);if(i)return{datum:i,mark:t}}}datumToTooltip(t){const e=t.datum,n=t.mark,r=n.properties,i=r&&r.tooltip&&r.tooltip.skipFields?t=>r.tooltip.skipFields.indexOf(t[0])<0:t=>!0;const o='<table class="attributes"'+Object.entries(e).filter(i).map(([t,r])=>`\n                <tr>\n                    <th>${Zf(t)}</th>\n                    <td>${Zf(ff(r))} ${function(t,e){for(const[r,i]of Object.entries(n.encoders))if(i.accessor&&i.accessor.fields.includes(t))switch(r){case"color":return`<span class="color-legend" style="background-color: ${i(e)}"></span>`}return""}(t,e)}</td>\n                </tr>`).join("")+"</table>";return`\n        ${n.unitView.spec.title?`<div class="title"><strong>${Zf(n.unitView.spec.title)}</strong></div>`:""}\n        <div class="sample-track-datum-tooltip">\n            ${o}\n        </div>`}renderViewport(){const t=this.gl;t.clear(t.COLOR_BUFFER_BIT);const e={...this.getDomainUniforms(),zoomLevel:this.genomeSpy.getExpZoomLevel()},n=[{sampleId:"default",uniforms:{yPosLeft:[0,1],yPosRight:[0,1]}}];for(const t of nf(this.view))t.render(n,e)}getMinAxisWidth(){const t=this.getYAxisLayouts();return t.map(t=>t.width).reduce((t,e)=>t+e,0)+10*(t.length-1)}renderYAxis(){const t=this.getHeight(),e=this.leftCanvas.clientWidth,n=this.get2d(this.leftCanvas);for(const r of this.getYAxisLayouts()){const i=r.scale,o=r.props;if(o.domain){const t=!1?r.ticks:i.domain();n.fillStyle=o.domainColor,n.fillRect(e-r.offsets.domain-o.domainWidth,i(t[t.length-1])-o.tickWidth/2,o.domainWidth,Math.abs(i(t[0])-i(t[t.length-1]))+o.tickWidth+(i.bandwidth?i.bandwidth():0))}const a=(i.bandwidth&&i.bandwidth()||0)/2;if(o.ticks)for(const t of r.ticks){const s=i(t)+a;n.fillStyle=o.tickColor,n.fillRect(e-r.offsets.ticks,s-o.tickWidth/2,o.tickSize,o.tickWidth)}if(o.labels){n.font=`${o.labelFont} ${o.labelFontSize}px`,n.textAlign="right",n.textBaseline="middle";for(let t=0;t<r.ticks.length;t++){const s=r.ticks[t],u=r.tickLabels[t],c=i(s)+a;n.fillStyle=o.labelColor,n.fillText(u,e-r.offsets.labels,c)}}r.title&&(n.save(),n.translate(e-r.offsets.title,t/2),n.rotate(-Math.PI/2),n.fillStyle=o.titleColor,n.font=`${o.titleFont} ${o.titleFontSize}px`,n.textAlign="center",n.textBaseline="top",n.fillText(r.title,0,0),n.restore()),n.translate(-r.width-10,0)}}getYAxisLayouts(){const t=this.getHeight(),e=this.get2d(this.leftCanvas),n=t=>e.measureText(t).width;return rf(this.view).map(t=>t.resolutions.y).filter(t=>t).map(e=>af(e,t,n)).filter(t=>!!t)}}class th{constructor(t,e){this.intervals=e||[],this.accessor=t||(t=>t)}_findInsertionPoint(t){const e=this.accessor(t);let n=0;for(;n<this.intervals.length&&e.lower>=this.accessor(this.intervals[n]).upper;)n++;return n<this.intervals.length&&this.accessor(this.intervals[n]).lower<e.upper?-1:n}add(t){const e=this._findInsertionPoint(t);if(e<0)throw"No room for the given interval!";this.intervals.splice(e,0,t)}addIfRoom(t){const e=this._findInsertionPoint(t);return!(e<0)&&(this.intervals.splice(e,0,t),!0)}intervalAt(t,e=!1){if(0==this.intervals.length)return null;let n=0;for(;n<this.intervals.length&&t>=this.accessor(this.intervals[n]).upper;)n++;const r=n<this.intervals.length?this.accessor(this.intervals[n]):null;if(r&&r.contains(t))return this.intervals[n];if(e){const e=r?r.lower-t:1/0,i=n>0?t-this.accessor(this.intervals[n-1]).upper:1/0;return this.intervals[e<i?n:n-1]}return null}overlaps(t){return this._findInsertionPoint(t)<0}clear(){this.intervals=[]}toArray(){return[].concat(this.intervals)}}class eh{constructor(){this._range=new fi(0,1),this.paddingInner=0,this.paddingOuter=0,this._relativeWidths=[],this._keys=[],this._keyCache=null,this._bands=null}_buildCaches(){this._keyCache=new Map;const t=[],e=this._relativeWidths.reduce((t,e)=>t+e,0)||1,n=this._range.pad(-this.paddingOuter/2/e*this._range.width()),r=n.width();let i=n.lower;for(let n=0;n<this._keys.length;n++){const o=this._keys[n],a=i,s=i+this._relativeWidths[n]/e*r,u=(s-a)*this.paddingInner/2,c=new fi(a+u,s-u);t.push({key:o,interval:c}),this._keyCache.set(o,c),i=s}this._bands=new th(t=>t.interval,t)}scale(t){return this._keyCache||this._buildCaches(),this._keyCache.get(t)}invert(t,e=!1){this._keyCache||this._buildCaches();const n=this._bands.intervalAt(t,e);return n&&n.key}range(t){this._range=t instanceof fi?t:fi.fromArray(t),this._keyCache=null}getRange(){return this._range}domain(t,e){this._keys=[...t],this._relativeWidths=e||Array(t.length).fill(1),this._keyCache=null}getDomain(){return this._keys}getBandWidth(){return this._range.width()/this._relativeWidths.reduce((t,e)=>t+e,0)}clone(){const t=new eh;return t.paddingInner=this.paddingInner,t.paddingOuter=this.paddingOuter,t.domain(this._keys,this._relativeWidths),t.range(this._range),t}}var nh;function rh(){var t,e,n=Su().unknown(void 0),r=n.domain,i=n.range,o=0,a=1,s=!1,u=0,c=0,l=.5;function f(){var n=r().length,f=a<o,h=f?a:o,d=f?o:a;t=(d-h)/Math.max(1,n-u+2*c),s&&(t=Math.floor(t)),h+=(d-h-t*(n-u))*l,e=t*(1-u),s&&(h=Math.round(h),e=Math.round(e));var p=Tu(n).map((function(e){return h+t*e}));return i(f?p.reverse():p)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),f()):r()},n.range=function(t){return arguments.length?([o,a]=t,o=+o,a=+a,f()):[o,a]},n.rangeRound=function(t){return[o,a]=t,o=+o,a=+a,s=!0,f()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(s=!!t,f()):s},n.padding=function(t){return arguments.length?(u=Math.min(1,c=+t),f()):u},n.paddingInner=function(t){return arguments.length?(u=Math.min(1,t),f()):u},n.paddingOuter=function(t){return arguments.length?(c=+t,f()):c},n.align=function(t){return arguments.length?(l=Math.max(0,Math.min(1,t)),f()):l},n.copy=function(){return rh(r(),[o,a]).round(s).paddingInner(u).paddingOuter(c).align(l)},Ur.apply(f(),arguments)}class ih{constructor(t,e){this.fontSize=t,this.fontFamily=e,this.cache=new Map,this.vPadding=0,this._dpr=window.devicePixelRatio||1,this.measureContext=document.createElement("canvas").getContext("2d"),this.measureContext.font=`${this.fontSize}px ${this.fontFamily}`,this.measureContext.textBaseline="middle"}_getText(t){let e=this.cache.get(t);if(!e){e=document.createElement("canvas");const n=e.getContext("2d"),r=this.measureContext.measureText(t).width;e.height=Math.ceil(this._getTextHeight()*this._dpr),e.width=Math.ceil(r*this._dpr),n.scale(this._dpr,this._dpr),n.font=`${this.fontSize}px ${this.fontFamily}`,n.textBaseline="middle",n.fillText(t,0,Math.round(this._getTextHeight()/2)),this.cache.set(t,e)}return e}_getTextHeight(){return this.fontSize*(1+2*this.vPadding)}fillText(t,e,n,r,i=null){const o=(i?i/this.fontSize:1)/this._dpr,a=this._getText(e),s=a.height*o,u=a.width*o;t.drawImage(a,n,Math.round(r-s/2),u,s)}clearCache(){this.cache=new Map,this._dpr=window.devicePixelRatio||1}}function oh(t,e){nh&&(nh.remove(),nh=null);const n=document.createElement("div");n.className="context-menu";const r=t.menuContainer||document.body;for(let e of t.items){let t;"divider"==e.type?(t=document.createElement("div"),t.classList.add("context-menu-divider")):"header"==e.type?(t=document.createElement("div"),t.classList.add("context-menu-header"),t.innerText=e.label||"-"):(t=document.createElement(e.callback?"a":"div"),t.classList.add("context-menu-item"),t.innerText=e.label||"-",e.callback&&t.addEventListener("mouseup",()=>{performance.now()-o>200&&(n.remove(),e.callback())})),n.appendChild(t)}n.style.left=e.clientX+"px",n.style.top=e.clientY+"px",nh=n,r.appendChild(n);const i=n.getBoundingClientRect();i.bottom>window.innerHeight&&(n.style.top=window.innerHeight-n.offsetHeight-10+"px"),i.right>window.innerWidth&&(n.style.left=window.innerWidth-n.offsetWidth-10+"px"),r.addEventListener("click",()=>n.remove(),{once:!0});const o=performance.now();r.addEventListener("mouseup",()=>{performance.now()-o>500&&n.remove()},{once:!0}),e.preventDefault()}function ah(t){return""!==t&&!("number"==typeof t&&isNaN(t))&&null!==t}const sh="nominal",uh="quantitative";class ch{constructor(t){this.sampleTrack=t,this.styles=this.sampleTrack.styles,this.textCache=new ih(this.styles.fontSize,this.styles.fontFamily),this._dpr=window.devicePixelRatio}initialize(){this.prepareSampleAttributes(),this.labelCanvas=this.sampleTrack.leftCanvas,this.sampleMouseTracker=new Kf({element:this.labelCanvas,tooltip:this.sampleTrack.genomeSpy.tooltip,resolver:this.sampleTrack.findSampleAt.bind(this.sampleTrack),tooltipConverter:t=>Promise.resolve(this.sampleToTooltip(t))}).on("contextmenu",this.createContextMenu.bind(this));const t=this.sampleTrack.get2d(document.createElement("canvas"));t.font=`${this.styles.fontSize}px ${this.styles.fontFamily}`,this.maxLabelWidth=Cc([...this.sampleTrack.samples.values()].map(e=>t.measureText(e.displayName).width),.98),this.attributeScales.size>0&&(this.attributeLabelCanvas=this.sampleTrack.createCanvas(),this.attributeLabelCanvas.style.zIndex="1",this.attributeLabelMouseTracker=new Kf({element:this.attributeLabelCanvas,tooltip:this.sampleTrack.genomeSpy.tooltip,resolver:this.findAttributeAt.bind(this),tooltipConverter:t=>Promise.resolve(t)}).on("click",t=>this._sortByAttribute(t)).on("mouseover",t=>this.renderAttributeLabels({hoveredAttribute:t})).on("mouseleave",()=>this.renderAttributeLabels()))}getMinWidth(){return this.maxLabelWidth+this.sampleTrack.styles.horizontalSpacing+this.attributeScales.size*this.sampleTrack.styles.attributeWidth+this.sampleTrack.styles.horizontalSpacing}createContextMenu(t,e,n){let r=[];const i=this.findAttributeAt(n);if(t){if(i){const e=t=>this.sampleTrack.updateSamples(this.sampleTrack.sampleOrder.filter(e=>t(this.sampleTrack.samples.get(e).attributes[i],n))),n=t.attributes[i],o="string"==typeof n;if(r=r.concat([{label:`Attribute: ${i}`,type:"header"},{label:"Sort by",callback:()=>this._sortByAttribute(i)}]),o&&r.push({label:"Retain first sample of each",callback:()=>{const t=new Set;this.sampleTrack.updateSamples(this.sampleTrack.sampleOrder.map(t=>this.sampleTrack.samples.get(t)).filter(e=>!(e=>{const n=t.has(e);return t.add(e),n})(e.attributes[i])).map(t=>t.id))}}),o)r=r.concat([{type:"divider"},{label:""===n?`Samples with undefined ${i}`:`Samples with ${i} = ${n}`,type:"header"},{label:"Retain",callback:()=>e((t,e)=>t===e)},{label:"Remove",callback:()=>e((t,e)=>t!==e)}]);else{const t=Xr(".4");r=r.concat([{type:"divider"}]),r=ah(n)?r.concat([{label:`Remove ${i} less than ${t(n)}`,callback:()=>e((t,e)=>isNaN(t)||t>=e)},{label:`Remove ${i} greater than ${t(n)}`,callback:()=>e((t,e)=>isNaN(t)||t<=e)}]):r.concat([{label:`Remove undefined ${i}`,callback:()=>e((t,e)=>"string"==typeof t||null!==t&&!isNaN(t))}])}}else r=r.concat([{label:"Sort by name",callback:()=>this.sampleTrack.sortSamples(t=>t.displayName)},{label:`Sample: ${t.displayName}`,type:"header"},{label:"Retain",callback:()=>this.sampleTrack.updateSamples(this.sampleTrack.sampleOrder.filter(e=>e==t.id))},{label:"Remove",callback:()=>this.sampleTrack.updateSamples(this.sampleTrack.sampleOrder.filter(e=>e!=t.id))}]);oh({items:r},e)}else e.preventDefault()}_sortByAttribute(t){let e;const n=this.attributeScales.get(t);if("ordinal"==n.type){const r=Oc("ordinal")().domain(n.domain()).range(Tu(0,n.domain().length)).unknown(-1);e=e=>r(e.attributes[t])}else e=e=>e.attributes[t];this.sampleTrack.sortSamples(e)}resizeCanvases(t){const e=this.sampleTrack.getHeight();this.sampleTrack.adjustCanvas(this.labelCanvas,t,e),this.attributeLabelCanvas&&(this.sampleTrack.adjustCanvas(this.attributeLabelCanvas,t,100),this.attributeLabelCanvas.style.top=`${e}px`);const n={tail:0,add:function(t){const e=new fi(this.tail,this.tail+t);return this.tail+=t,e}};this.labelInterval=n.add(Math.ceil(this.maxLabelWidth)),n.add(this.sampleTrack.styles.horizontalSpacing),this.attributeInterval=n.add(this.attributeScales.size*this.sampleTrack.styles.attributeWidth)}renderLabels(t){const e=t&&t.leftScale||this.sampleTrack.sampleScale,n=t&&t.rightScale||this.sampleTrack.sampleScale,r=t&&t.yTransitionProgress||0,i=this.sampleTrack.get2d(this.labelCanvas);i.clearRect(0,0,this.labelCanvas.width,this.labelCanvas.height),window.devicePixelRatio!=this._dpr&&(this._dpr=window.devicePixelRatio,this.textCache.clearCache());const o=t=>t*this.labelCanvas.clientHeight,a=new fi(0,1).transform(o);e.getDomain().forEach(t=>{const s=this.sampleTrack.samples.get(t),u=e.scale(t).mix(n.scale(t),r).transform(this.sampleTrack.yTransform).transform(o);if(u.width()>0&&a.connectedWith(u)){const t=Math.min(this.sampleTrack.styles.fontSize,u.width());this.textCache.fillText(i,s.displayName,this.labelInterval.lower,u.centre(),t),this.attributeScales.forEach((t,e)=>{const n=s.attributes[e];i.fillStyle=ah(n)?t(n):this.styles.naColor,i.fillRect(this.attributeInterval.lower+this.attributeBandScale(e),u.lower,this.attributeBandScale.bandwidth(),u.width())})}})}renderAttributeLabels(t){if(!this.attributeLabelCanvas)return;const e=this.sampleTrack.get2d(this.attributeLabelCanvas);e.clearRect(0,0,this.labelCanvas.width,this.labelCanvas.height),e.save();const n=Math.min(1.15*this.attributeBandScale.bandwidth(),this.sampleTrack.styles.fontSize);e.font=`${n}px ${this.sampleTrack.styles.fontFamily}`,e.textBaseline="middle",e.rotate(.5*Math.PI),e.translate(0,-this.attributeInterval.lower-this.attributeBandScale.bandwidth()/2),this.attributeBandScale.domain().forEach(n=>{e.fillStyle=n==(t&&t.hoveredAttribute)?"red":"black",e.fillText(n,2,-this.attributeBandScale(n))}),e.restore()}findAttributeAt(t){const e=t[0]-this.attributeInterval.lower;return this.attributeBandScale.domain().find(t=>{const n=this.attributeBandScale(t);return e>=n&&e<n+this.attributeBandScale.bandwidth()})}sampleToTooltip(t){const e=(t,e)=>ah(e)?this.attributeScales.get(t)(e):this.styles.naColor,n='<table class="attributes"'+Object.entries(t.attributes).map(([t,n])=>`\n                <tr>\n                    <th>${Zf(t)}</th>\n                    <td>${Zf(ff(n))}</td>\n                    <td class="color" style="background-color: ${e(t,n)}"></td>\n                </tr>`).join("")+"</table>";return`\n        <div class="sample-track-sample-tooltip">\n            <div class="title">\n                <strong>${Zf(t.id)}</strong>\n            </div>\n\n            ${n}\n        </div>`}_getAttributeConfig(t){return((this.sampleTrack.config.samples?this.sampleTrack.config.samples.attributes:{})||{})[t]||{}}prepareSampleAttributes(){const t=[...this.sampleTrack.samples.values()],e=t.flatMap(t=>Object.keys(t.attributes)).reduce((t,e)=>t.add(e),new Set);this.attributeScales=new Map,e.forEach(e=>{let n;const r=t=>t.attributes[e],i=this._getAttributeConfig(e);let o=i.type;if(!o)switch(st(t.map(r))){case"integer":case"number":o=uh;break;default:o=sh}const a=i.scale||{};a.type||(a.type=o==uh?"linear":"ordinal"),a.domain||(a.domain=$l(o),a.domain.extendAll([...new Set(t.map(r))].sort())),a.range||a.scheme||(a.scheme=o==sh?a.domain.length<=10?"tableau10":"tableau20":"orangered"),n=Il(a).unknown(this.styles.naColor),this.attributeScales.set(e,n)}),this.attributeBandScale=rh().domain(Array.from(e.keys())).paddingInner(this.sampleTrack.styles.attributePaddingInner).range([0,this.sampleTrack.styles.attributeWidth*e.size])}}class lh{constructor(t){this.key=t}map(t){}ungroup(){throw new Error("Abstract")}ungroupAll(){let t=this;for(;t instanceof hh;)t=t.ungroup();return(t)}flatData(){const t=this._collectDataGroups();let e=0,n=t[e].data,r=0;return{[Symbol.iterator](){return this},next(){return n&&r<n.length?{value:n[r++]}:(e++,e<t.length?(n=t[e].data,r=0,this.next()):{done:!0})}}}_collectDataGroups(){throw new Error("Abstract")}}class fh extends lh{constructor(t,e){super(t),this.data=e}map(t){return new fh(this.key,t(this.data))}ungroup(){throw new Error("Trying to ungroup a DataGroup!")}_collectDataGroups(){return[this]}}class hh extends lh{constructor(t,e){super(t),this.subgroups=e}hasDataChildren(){return this.subgroups[0]instanceof fh}map(t){return new hh(this.key,this.subgroups.map(e=>e.map(t)))}ungroup(){if(this.hasDataChildren()){const t=this.subgroups.map(t=>t.data).flat();return new fh(this.key,t)}return new hh(this.key,this.subgroups.map(t=>t.ungroup()))}_collectDataGroups(){return this.subgroups.map(t=>t._collectDataGroups()).flat()}}class dh{constructor(t,e,n){this.config=t,this.baseUrl=e,this.namedDataProvider=n}getUngroupedData(){return this.getData().then(t=>t.ungroupAll().data)}async getData(){if(this.config.values)return this._getImmediateData();if(this.config.sequence)return this._getSequence();if(this.config.url)return await this._fetchAndReadAll();if(this.config.name){const t=this.namedDataProvider(this.config.name);if(t)return new fh(this.config.name,t);throw new Error("No such named dataset: "+this.config.name)}throw new Error('No "url", "values", "sequence", or "name" defined in data configuration!')}_getFormat(t){const e={...this.config.format};if(e.type=e.type||t,e.parse=e.parse||"auto",!e.type)throw new Error("Format for data source was not defined and it could not be inferred: "+JSON.stringify(this.config));return e}_extractTypeFromUrl(t){const e=t.match(/\.(csv|tsv|json)/);return e?e[1]:null}_getImmediateData(){let t;const e=this.config.values;if(Array.isArray(e))t=e.length>0?"object"==typeof e[0]?e:e.map(t=>({data:t})):[];else{if("string"!=typeof e)throw new Error('"values" in data configuration is not an array nor a string!');t=vn(e,this._getFormat())}return new fh("immediate",t)}_getSequence(){const t=this.config.sequence;if("number"!=typeof t.start||"number"!=typeof t.stop)throw new Error("Missing or invalid start or stop in sequence generator config: "+JSON.stringify(t));const e=Tu(t.start,t.stop,t.step||1).map(e=>({[t.as||"data"]:e}));return new fh("sequence",e)}async _fetchAndRead(t){let e;try{e=await bn({baseURL:this.baseUrl}).load(t)}catch(e){throw new Error(`Cannot fetch: ${t}: ${e.message}`)}try{return new fh(t,vn(e,this._getFormat(this._extractTypeFromUrl(t))))}catch(e){throw new Error(`Cannot parse: ${t}: ${e.message}`)}}async _fetchAndReadAll(){const t=this.config.url;if("string"==typeof t)return this._fetchAndRead(t);if(Array.isArray(t))return new hh("root",await Promise.all(t.map(t=>this._fetchAndRead(t))));throw new Error("url is neither a string nor an array: "+JSON.stringify(t))}}const ph={paddingInner:.2,paddingOuter:.2,attributeWidth:12,attributePaddingInner:.05,naColor:"#D8D8D8",fontSize:12,fontFamily:"sans-serif",horizontalSpacing:10,height:null};function mh(t){const e=Object.assign({},t);return delete e.sample,delete e.displayName,e}class gh extends Qf{constructor(t,e,n){super(t,e,n),this.styles=Object.assign({},ph,e.styles),this.attributePanel=new ch(this),this.yTransform=Nu()}setSamples(t){this.samples=new Map(t.map(t=>[t.id,t])),this.sampleOrder=t.map(t=>t.id),this.sampleOrderHistory=[[...this.sampleOrder]]}getMinAxisWidth(){return this.attributePanel.getMinWidth()}resizeCanvases(t){super.resizeCanvases(t),this.attributePanel.resizeCanvases(t.axis)}async initialize(t){if(await super.initialize(t),this.config.samples){const t=new dh(this.config.samples.data,this.genomeSpy.config.baseUrl);this.setSamples((await t.getUngroupedData()).map(t=>({id:t.sample,displayName:t.displayName||t.sample,attributes:mh(t)})))}else{const t=this.view.getResolution("sample");t&&this.setSamples(t.getDataDomain().map(t=>({id:t,displayName:t,attributes:[]})))}if(!this.samples)throw new Error("No samples defined!");this.trackContainer.className="sample-track",this.sampleScale=new eh,this.sampleScale.domain(this.sampleOrder),this.sampleScale.paddingInner=this.styles.paddingInner,this.sampleScale.paddingOuter=this.styles.paddingOuter,this.viewportMouseTracker.on("contextmenu",this.createContextMenu.bind(this)),this.attributePanel.initialize(),this.initializePeek(),this.initializeFisheye(),this.genomeSpy.on("layout",()=>{this.attributePanel.renderLabels(),this.attributePanel.renderAttributeLabels()})}initializePeek(){let t=!1,e=null;let n=1,r=0;const i=0,o=1,a=2;let s=i;const u=t=>{if(t.deltaY&&!t.isPinching()){const e=this.getHeight()*n;r=Math.max(0,Math.min(1,r-t.deltaY/e)),c(),t.stop()}},c=()=>{this.renderViewport(),this.attributePanel.renderLabels()},l=()=>{s==a&&(s=o,this.genomeSpy.zoom.popListener(),vi({duration:100,from:n,to:1,onUpdate:t=>{n=t,c()}}).then(()=>{s=i,this.yTransform=Nu(),c()}))},f=()=>{s==i&&(s=o,r=hi(this.glCanvas,e)[1]/this.getHeight(),(r<0||r>1)&&(r=.5),this.yTransform=t=>(t-r)*n+r,this.yTransform.invert=t=>(r*(n-1)+t)/n,this.genomeSpy.zoom.pushListener(u),vi({duration:230,from:1,to:Math.max(1,30/this.getHeight()/this.sampleScale.getBandWidth()),easingFunction:Ai,onUpdate:t=>{n=t,c()}}).then(()=>{s=a}))};this.genomeSpy.container.addEventListener("mousemove",t=>{e=t,this.fisheye&&focus()}),document.body.addEventListener("keydown",e=>{e.repeat||"KeyZ"!=e.code||(t?e.shiftKey?(l(),t=!1):t=!1:(f(),t=e.shiftKey))}),document.body.addEventListener("keyup",e=>{"KeyZ"!=e.code||t||e.shiftKey||l()}),this.togglePeek=()=>{switch(s){case i:f();break;case a:l()}}}initializeFisheye(){let t=null,e=!1;const n=()=>{this.renderViewport(),this.attributePanel.renderLabels()},r=()=>{this.fisheye.focus(hi(this.glCanvas,t)[1]/this.getHeight()),n()};this.genomeSpy.container.addEventListener("mousemove",e=>{t=e,this.fisheye&&r()});let i=.01;const o=()=>{vi({duration:100,from:i,to:.01,onUpdate:t=>{this.fisheye.distortion(t),i=t,r()}}).then(()=>{this.fisheye=void 0,this.yTransform=Nu(),n()})},a=()=>{this.fisheye=function(){let t=200,e=2,n=1,r=1,i=0;function o(e){const o=e-i,a=Math.abs(o);if(!a||a>=t)return e;const s=n*(1-Math.exp(-a*r))/a*.75+.25;return i+o*s}function a(){return n=Math.exp(e),n=n/(n-1)*t,r=e/t,o}return o.radius=function(e){return arguments.length?(t=+e,a()):t},o.distortion=function(t){return arguments.length?(e=+t,a()):e},o.focus=function(t){return arguments.length?(i=t,o):i},a()}(),this.fisheye.radius(150/this.getHeight()),this.yTransform=this.fisheye,this.yTransform.invert=t=>t,vi({duration:150,from:.01,to:Math.max(1,35/this.sampleScale.getBandWidth()/this.getHeight()),onUpdate:t=>{this.fisheye.distortion(t),i=t,r()}})};document.body.addEventListener("keydown",t=>{t.repeat||"KeyE"!=t.code||(e?t.shiftKey?(o(),e=!1):e=!1:(a(),e=t.shiftKey))}),document.body.addEventListener("keyup",t=>{"KeyE"!=t.code||!this.fisheye||e||t.shiftKey||o()}),this.toggleFisheye=()=>{this.fisheye?o():a()}}findSampleAt(t){const e=this.getHeight()/this.sampleScale.getDomain().length*this.sampleScale.paddingOuter<2.5,n=this.sampleScale.invert(this.yTransform.invert(t[1]/this.getHeight()),e);return n?this.samples.get(n):null}findDatumAndMarkAt(t){const[e,n]=t,r=this.sampleScale.invert(this.yTransform.invert(n/this.getHeight()));if(!r)return null;const i=this.sampleScale.scale(r);for(const t of nf(this.view).reverse())if(null!==t.properties.tooltip){const o=t.findDatum(r,e,n,i.transform(this.yTransform).transform(t=>t*this.getHeight()));if(o)return{datum:o,mark:t}}}createContextMenu(t,e,n){let r=[];const i=this.genomeSpy.rescaledX.invert(n[0]);for(const t of nf(this.view))if(t.properties&&t.properties.sorting){r.push({label:t.unitView.spec.title||"- No title -",type:"header"});for(const e of t.properties.sorting.fields)r.push({label:`Sort by ${e}`,callback:()=>this.sortSamplesByLocus(t,i,e)})}oh({items:r},e)}sortSamplesByLocus(t,e,n){const r=this.sampleOrder.map(r=>{return(i=t.findDatumAt(r,e))?i[n]:void 0;var i}),i=t=>null!=t&&t==t,o="number"==st(r)?t=>i(t)?t:-1/0:t=>i(t)?t:"",a=new Map(function(){return sf(arguments)}(this.sampleOrder,r.map(o)));this.sortSamples(t=>a.get(t.id))}sortSamples(t){let e=this.getSamplesSortedByAttribute(t,!1);Io(e,this.sampleOrder)&&(e=this.getSamplesSortedByAttribute(t,!0)),this.updateSamples(e)}backtrackSamples(){if(this.sampleOrderHistory.length>1){this.sampleOrderHistory.pop();const t=this.sampleOrderHistory[this.sampleOrderHistory.length-1],e=this.sampleScale.clone();e.domain(t),this.genomeSpy.eventEmitter.emit("samplesupdated"),this.animateSampleTransition(this.sampleScale,e,!0).then(()=>{this.sampleOrder=t,this.sampleScale=e,this.renderViewport(),this.attributePanel.renderLabels()})}}updateSamples(t){if(Io(t,this.sampleOrderHistory[this.sampleOrderHistory.length-1]))return;this.sampleOrderHistory.length>1&&Io(t,this.sampleOrderHistory[this.sampleOrderHistory.length-2])?this.sampleOrderHistory.pop():this.sampleOrderHistory.push(t),this.genomeSpy.eventEmitter.emit("samplesupdated");const e=this.sampleScale.clone();e.domain(t),this.animateSampleTransition(this.sampleScale,e).then(()=>{this.sampleOrder=t,this.sampleScale=e,this.renderViewport(),this.attributePanel.renderLabels()})}animateSampleTransition(t,e,n=!1){t=this.addCollapsedBands(e,t),e=this.addCollapsedBands(t,e),n&&([t,e]=[e,t]);const r=oi().domain([0,.4]).clamp(!0),i=oi().domain([.15,1]).clamp(!0),o=bi(Ei),a=bi(xi);return this.attributePanel.sampleMouseTracker.clear(),this.viewportMouseTracker.clear(),nf(this.view).forEach(t=>t.onBeforeSampleAnimation()),vi({from:n?1:0,to:n?0:1,duration:n?500:1200,easingFunction:wi,onUpdate:n=>{const s={leftScale:t,rightScale:e,yTransitionProgress:o(r(n)),xTransitionProgress:a(i(n))};this.renderViewport(s),this.attributePanel.renderLabels(s)}}).then(()=>nf(this.view).forEach(t=>t.onAfterSampleAnimation()))}addCollapsedBands(t,e){const n=[...e.getDomain()],r=Array(n.length).fill(1);let i=-1;for(let e of t.getDomain()){const t=n.indexOf(e);t>=0?i=t:(i++,n.splice(i,0,e),r.splice(i,0,0))}const o=e.clone();return o.domain(n,r),o}getSamplesSortedByAttribute(t,e=!1){const n=t=>"number"==typeof t&&isNaN(t)?-1/0:null===t?"":t;return[...this.sampleOrder].sort((r,i)=>{let o=n(t(this.samples.get(r))),a=n(t(this.samples.get(i)));return e&&([o,a]=[a,o]),o<a?-1:o>a?1:0})}renderViewport(t){const e=this.gl,n=t=>t,r=t&&t.leftScale||this.sampleScale,i=t&&t.rightScale||this.sampleScale,o=t&&t.xTransitionProgress||0,a=t&&t.yTransitionProgress||0;e.clear(e.COLOR_BUFFER_BIT);const s={...this.getDomainUniforms(),transitionOffset:o,zoomLevel:this.genomeSpy.getExpZoomLevel()},u=r.getDomain().map(t=>{const e=r.scale(t).mix(i.scale(t),a).transform(this.yTransform).transform(n),o=r.scale(t).transform(this.yTransform).transform(n);return{sampleId:t,uniforms:{yPosLeft:[e.lower,e.width()],yPosRight:[o.lower,o.width()]}}}).filter(t=>t.uniforms.yPosLeft[0]<=1&&t.uniforms.yPosLeft[0]+t.uniforms.yPosLeft[1]>=0||t.uniforms.yPosRight[0]<=1&&t.uniforms.yPosRight[0]+t.uniforms.yPosRight[1]>=0);for(const t of nf(this.view))t.render(u,s)}}const yh={fontSize:12,fontFamily:"sans-serif",chromColor:"black",locusColor:"#a8a8a8"};const vh=Su().domain(["gneg","gpos25","gpos50","gpos75","gpos100","acen","stalk","gvar"]).range(["#f0f0f0","#e0e0e0","#d0d0d0","#c0c0c0","#a0a0a0","#cc4444","#338833","#000000"].map(t=>({background:Xn(t),foreground:Xn(ir(t).l<.5?"#ddd":"black"),shadow:Xn(ir(t).l<.5?"transparent":"rgba(255, 255, 255, 0.25)")}))),bh={fontSize:11,fontFamily:"sans-serif",labelMargin:5};class wh{constructor(t=[],e=Ah){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let t=(this.length>>1)-1;t>=0;t--)this._down(t)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:n}=this,r=e[t];for(;t>0;){const i=t-1>>1,o=e[i];if(n(r,o)>=0)break;e[t]=o,t=i}e[t]=r}_down(t){const{data:e,compare:n}=this,r=this.length>>1,i=e[t];for(;t<r;){let r=1+(t<<1),o=e[r];const a=r+1;if(a<this.length&&n(e[a],o)<0&&(r=a,o=e[a]),n(o,i)>=0)break;e[t]=o,t=r}e[t]=i}}function Ah(t,e){return t<e?-1:t>e?1:0}var Eh=n(17),xh=n.n(Eh),_h=n(18),Ch=n.n(_h),Th=n(19),Oh=n.n(Th);const Sh=new Map;const Mh={geneFullVisibilityThreshold:3e7,geneFadeGradientFactor:2.8,maxSymbolsToShow:70,lanes:3,laneHeight:15,laneSpacing:10,symbolYOffset:2,fontSize:11,fontFamily:"sans-serif"};function kh(t){const e=t.symbol;return[{label:e,type:"header"},{type:"divider"},{label:"Search gene symbol in...",type:"header"},{label:"NCBI Gene",callback:()=>window.open(`https://www.ncbi.nlm.nih.gov/gene?cmd=search&term=${e}%5Bsym%5D`)},{label:"GeneCards",callback:()=>window.open(`https://www.genecards.org/Search/Symbol?queryString=${e}`)},{label:"OMIM",callback:()=>window.open(`https://www.omim.org/search/?index=entry&start=1&limit=10&sort=score+desc%2C+prefix_sort+desc&search=approved_gene_symbol%3A${e}`)}]}function Dh(t,e,n){const r=(t,e)=>n(e,t),i=new wh([],r);let o;for(o=0;o<e&&o<t.length;o++)i.push(t[o]);for(;o<t.length;o++){const e=t[o];r(e,i.peek())>0&&(i.push(e),i.pop())}const a=[];for(;i.length;)a.push(i.pop());return a.reverse()}class Fh extends Oi{formatInterval(t){return t.lower+"-"+t.upper}parseInterval(t){const e=t.match(/^(-?\d+)-(-?\d+)$/);return e?new fi(parseInt(e[1]),parseInt(e[2])):null}getExtent(){}}class Nh{constructor(){this.accessorCreators=[],this.register(t=>{if(t.field)try{const e=Object(V.g)(t.field);return e.constant=!1,e.fields=Object(V.a)(e),e}catch(t){throw new Error(`Invalid field definition: ${t.message}`)}}),this.register(t=>t.expr?function(t){const e=No(t);return e.constant=0==e.fields.length,e}(t.expr):void 0),this.register(t=>{if(void 0!==t.constant){const e=Object(V.c)(t.constant);return e.constant=!0,e.fields=[],e}})}register(t){this.accessorCreators.push(t)}createAccessor(t){for(const e of this.accessorCreators){const n=e(t);if(n)return n}}}const Ih={axis:class extends Mi{constructor(t,e){super(t,e)}async initialize(t){await super.initialize(t),this.height=Math.ceil(40),this.trackContainer.className="axis-track",this.trackContainer.style.height=`${this.height}px`,this.tickCanvas=this.createCanvas(),this.genomeSpy.on("zoom",this.renderTicks.bind(this)),this.genomeSpy.on("layout",function(t){this.resizeCanvases(t),this.renderTicks()}.bind(this)),this.genomeSpy.zoom.attachZoomEvents(this.tickCanvas)}resizeCanvases(t){this.adjustCanvas(this.tickCanvas,t.viewport),this._layout=t}renderTicks(){const t=this.get2d(this.tickCanvas),e=e=>t.measureText(e).width,n=this.tickCanvas.clientWidth,r=(this.tickCanvas.clientHeight,Oc("linear")().domain(this.genomeSpy.getZoomedScale().domain()).range([0,n])),i=rf(this.genomeSpy.viewRoot).map(t=>t.resolutions.x).filter(t=>t).map(t=>af(t,n,e,"horizontal",r)).find(t=>!!t);t.clearRect(0,0,this.tickCanvas.clientWidth,this.tickCanvas.clientHeight);const o=i.props;if(o.domain){const e=!1?i.ticks:r.domain();t.fillStyle=o.domainColor,t.fillRect(r(e[0])-o.tickWidth/2,i.offsets.domain,Math.abs(r(e[0])-r(e[e.length-1]))+o.tickWidth+(r.bandwidth?r.bandwidth():0),o.domainWidth)}const a=(r.bandwidth&&r.bandwidth()||0)/2;if(o.ticks)for(const e of i.ticks){const n=r(e)+a;t.fillStyle=o.tickColor,t.fillRect(n-o.tickWidth/2,i.offsets.ticks-o.tickSize,o.tickWidth,o.tickSize)}if(o.labels){t.font=`${o.labelFont} ${o.labelFontSize}px`,t.textAlign="center",t.textBaseline="top";for(let e=0;e<i.ticks.length;e++){const n=i.ticks[e],s=i.tickLabels[e],u=r(n)+a;t.fillStyle=o.labelColor,t.fillText(s,u,i.offsets.labels)}}i.title&&(t.fillStyle=o.titleColor,t.font=`${o.titleFont} ${o.titleFontSize}px`,t.textAlign="center",t.textBaseline="bottom",t.fillText(i.title,n/2,i.offsets.title))}},cytobands:class extends Xf{constructor(t,e){if(super(t,e),this.styles=bh,!(t.coordinateSystem instanceof Si))throw new Error("The coordinate system is not genomic!");this.genome=t.coordinateSystem}async initialize(t){await super.initialize(t),this.trackContainer.className="cytoband-track",this.trackContainer.style.height="21px";try{this.mappedCytobands=(e=this.genome.chromMapper,n=await bn({baseURL:this.genome.baseUrl}).load(`${this.genome.name}/cytoBand.${this.genome.name}.txt`),Ci(n).filter(t=>/^chr[0-9XY]{1,2}$/.test(t[0])).map(t=>({chrom:t[0],chromStart:+t[1],chromEnd:+t[2],name:t[3],gieStain:t[4]})).map(t=>({interval:e.segmentToContinuous(t.chrom,t.chromStart,t.chromEnd),name:t.name,chrom:t.chrom,gieStain:t.gieStain})))}catch(t){throw console.error(t),new Error(`Could not load chrom sizes: ${t.message}`)}var e,n;this.initializeWebGL(),this.bandLabelCanvas=this.createCanvas();const r=this.get2d(this.bandLabelCanvas);r.font=`${this.styles.fontSize}px ${this.styles.fontFamily}`,this._bandLabelWidths=this.mappedCytobands.map(t=>r.measureText(t.name).width),this._minBandLabelWidth=this._bandLabelWidths.reduce((t,e)=>Math.min(t,e),1/0),this.mouseTracker=new Kf({element:this.bandLabelCanvas,resolver:this.findCytobandAt.bind(this)}).on("dblclick",t=>this.genomeSpy.zoomTo(t.interval.pad(.25*t.interval.width()))),this.genomeSpy.on("zoom",()=>{this.render()}),this.genomeSpy.on("layout",t=>{this.resizeCanvases(t),this.render()}),this.genomeSpy.zoom.attachZoomEvents(this.bandLabelCanvas)}initializeWebGL(){super.initializeWebGL();const t=this.gl;this.programInfo=Ts(t,[Ls.a,zs.a].map(t=>this.processShader(t)));const e=function(t,e=8e6){const n=Xn("black"),r=[],i=[],o=[],a=[],s=[0,0],u=[0,0];for(let c of t){const t=Us(c.interval.lower,s),l=Us(c.interval.upper,u),f=0+(c.paddingTopLeft||c.paddingTop||0),h=0+(c.paddingTopRight||c.paddingTop||0),d=1-(c.paddingBottomLeft||c.paddingBottom||0),p=1-(c.paddingBottomRight||c.paddingBottom||0),m=c.color||n,g=c.colorTop||m,y=c.colorBottom||m,v=su(g),b=su(y);r.push(...t),i.push(d),o.push(...b),a.push(1);const w=c.interval.width()<1/0&&Math.ceil(c.interval.width()/e);for(let t=0;t<=w;t++){const e=t/w,n=Us(c.interval.lower+c.interval.width()*e,s),u=d+(p-d)*e,l=f+(h-f)*e;r.push(...n,...n),i.push(u,l),o.push(...b,...v),a.push(1,1)}r.push(...l),i.push(h),o.push(...v),a.push(1)}return{arrays:{x:{data:new Float32Array(r),numComponents:2},y:{data:new Float32Array(i),numComponents:1},width:{data:new Float32Array(i.length),numComponents:1},color:{data:new Float32Array(o),numComponents:3},opacity:{data:new Float32Array(a),numComponents:1}},vertexCount:i.length,drawMode:au}}(this.mappedCytobands.map(t=>Object.assign({interval:t.interval,colorTop:vh(t.gieStain).background.darker(.3),colorBottom:vh(t.gieStain).background.brighter(.1)},function(t){if("acen"==t.gieStain){if(t.name.startsWith("p"))return{paddingTopRight:.5,paddingBottomRight:.5};if(t.name.startsWith("q"))return{paddingTopLeft:.5,paddingBottomLeft:.5}}return{}}(t))));this.bufferInfo=ya(this.gl,e.arrays),t.useProgram(this.programInfo.program),_s(t,this.programInfo,this.bufferInfo),As(this.programInfo,{yPosLeft:[0,1],yPosRight:[0,1],uYTranslate:0,uYScale:1})}resizeCanvases(t){this.adjustCanvas(this.bandLabelCanvas,t.viewport),this.adjustCanvas(this.glCanvas,t.viewport),this.adjustGl(),this.viewportDimensions={width:t.viewport.width(),height:this.trackContainer.clientHeight}}render(){this.renderBands(),this.renderLabels(),this.renderChromosomeBoundaries()}renderBands(){const t=this.gl;t.clear(t.COLOR_BUFFER_BIT),As(this.programInfo,this.getDomainUniforms()),Os(t,this.bufferInfo,t.TRIANGLE_STRIP)}renderLabels(){const t=this.genomeSpy.getZoomedScale(),e=fi.fromArray(t.range()),n=this.get2d(this.bandLabelCanvas);n.font=`${this.styles.fontSize}px ${this.styles.fontFamily}`,n.textBaseline="middle",n.textAlign="center";const r=window.devicePixelRatio||1;n.shadowOffsetY=1*r,n.clearRect(0,0,this.viewportDimensions.width,this.viewportDimensions.height);const i=this.viewportDimensions.height/2,o=t.invert(this._minBandLabelWidth+2*this.styles.labelMargin)-t.invert(0),a=this.genomeSpy.getViewportDomain();this.mappedCytobands.forEach((r,s)=>{if(!a.connectedWith(r.interval)||r.interval.width()<o)return;const u=r.interval.transform(t),c=this._bandLabelWidths[s];if(u.connectedWith(e)&&u.width()>c+2*this.styles.labelMargin){let t=u.centre();const o=vh(r.gieStain);n.fillStyle=o.foreground,n.shadowColor=o.shadow;const a=c/2+this.styles.labelMargin;t<e.lower+a?(t=Math.max(t,e.lower+a),t=Math.min(t,u.upper-a)):t>e.upper-a&&(t=Math.min(t,e.upper-a),t=Math.max(t,u.lower+a)),n.fillText(r.name,t,i)}})}renderChromosomeBoundaries(){const t=this.genomeSpy.getZoomedScale(),e=this.bandLabelCanvas.getContext("2d");e.strokeStyle="#909090",e.setLineDash([3,3]);const n=fi.fromArray(t.domain());this.genome.chromMapper.getChromosomes().forEach((r,i)=>{const o=r.continuousInterval;if(i>0&&n.contains(o.lower)){const n=t(o.lower);e.beginPath(),e.moveTo(n,0),e.lineTo(n,this.viewportDimensions.height),e.stroke()}})}findCytobandAt(t){const e=this.genomeSpy.rescaledX.invert(t[0]);return this.mappedCytobands.find(t=>t.interval.contains(e))}search(t){const e=/^[0-9]+$/.test(t)?e=>e.chrom.substring(3)==t:e=>(e.chrom.substring(3)+e.name).startsWith(t),n=this.mappedCytobands.filter(e);if(n.length>0)return new fi(Math.min.apply(null,n.map(t=>t.interval.centre()-t.interval.width()/2)),Math.max.apply(null,n.map(t=>t.interval.centre()+t.interval.width()/2)))}searchHelp(){return"<p>Zoom in to a cytoband, arm or chromosome. Examples:</p>\n            <ul>\n                <li>8p11.23</li>\n                <li>8p11</li>\n                <li>8p</li>\n                <li>8</li>\n            </ul>"}},genomeAxis:class extends Mi{constructor(t,e){if(super(t,e),this.styles=yh,!(t.coordinateSystem instanceof Si))throw new Error("The coordinate system is not genomic!");this.genome=t.coordinateSystem}async initialize(t){await super.initialize(t),this.height=Math.ceil(1.5*this.styles.fontSize),this.trackContainer.className="genome-axis-track",this.trackContainer.style.height=`${this.height}px`,this.tickCanvas=this.createCanvas(),this.genomeSpy.on("zoom",this.renderTicks.bind(this)),this.genomeSpy.on("layout",function(t){this.resizeCanvases(t),this.renderTicks()}.bind(this)),this.genomeSpy.zoom.attachZoomEvents(this.tickCanvas);const e=this.genome.chromMapper;this.chromosomes=e.getChromosomes();const n=this.get2d(this.tickCanvas);n.font=`${this.styles.fontSize}px ${this.styles.fontFamily}`,this._chromLabelWidths=this.chromosomes.map(t=>n.measureText(t.name).width),this.tickCanvas.addEventListener("dblclick",t=>this.genomeSpy.zoomTo(e.getChromosome(e.toChromosomal(this.genomeSpy.getZoomedScale().invert(hi(this.tickCanvas,t)[0])).chromosome).continuousInterval))}resizeCanvases(t){this.adjustCanvas(this.tickCanvas,t.viewport),this._layout=t}renderTicks(){const t=this.genomeSpy.getZoomedScale(),e=this.genome.chromMapper,n=this.get2d(this.tickCanvas),r=fi.fromArray(t.range()),i=fi.fromArray(t.domain()),o=i.width()>5e7?Xr(".3s"):Xr(","),a=n.measureText(o(123e6)).width,s=Math.round(1*this.tickCanvas.clientHeight);n.textBaseline="bottom",n.font=`${this.styles.fontSize}px ${this.styles.fontFamily}`;const u=(e,r,u=null,c=0)=>{const l=a+r/2,f=Math.min(20,Math.floor(this._layout.viewport.width()/l/2)),h=Cn(i.lower,i.upper,f);if(e.width()<2.5*h)return;if(null==u&&(u=e),u.lower==e.lower&&(u=u.withLower(u.lower+1)),null==(u=u.intersect(new fi(-1/0,t.invert(this.tickCanvas.clientWidth+l))).intersect(new fi(-1/0,e.upper-t.invert(l/2)+t.invert(0)))))return;if(c>0){const t=t=>{const e=Zn(Xn(this.styles.locusColor));return e.opacity=t,e},e=n.createLinearGradient(c,0,c+30,0);e.addColorStop(0,t(0)),e.addColorStop(.5,t(.3)),e.addColorStop(1,t(1)),n.fillStyle=e}else n.fillStyle=this.styles.locusColor;n.textAlign="center";for(let r=Math.ceil((u.lower-e.lower)/h)*h+.5-1;r+e.lower<u.upper;r+=h){const i=t(r+e.lower)-.5,a=o(r-.5+1);n.fillRect(i,0,1,3),n.fillText(a,i,s)}};if(n.clearRect(0,0,this.tickCanvas.clientWidth,this.tickCanvas.clientHeight),this.chromosomes.forEach((i,o)=>{const a=e.getChromosome(i.name).continuousInterval.transform(t);r.contains(a.lower)&&(n.fillStyle=this.styles.chromColor,n.fillRect(a.lower-.5,0,1,this.tickCanvas.clientHeight/1),a.width()>this._chromLabelWidths[o]+8&&(n.textAlign="left",n.fillText(i.name,a.lower-.5+5,s)),u(e.getChromosome(i.name).continuousInterval,this._chromLabelWidths[o]))}),i.lower>0){const r=e.getChromosome(e.toChromosomal(i.lower).chromosome),o=r.continuousInterval.transform(t),a=this._chromLabelWidths[r.index],c=Math.min(o.upper-a-3,5);n.fillStyle=this.styles.chromColor,n.textAlign="left",n.fillText(r.name,c,s);const l=t.invert(c),f=r.continuousInterval.upper;l<f&&u(r.continuousInterval,a,new fi(l,f),a+5)}}},geneAnnotation:class extends Xf{constructor(t,e){super(t,e),this.styles=Mh,this.symbolsOnLanes=[...Array(40).keys()].map(t=>new th(t=>t.screenInterval)),this.bodyOpacityScale=oi().range([0,1]).domain([this.styles.geneFullVisibilityThreshold*this.styles.geneFadeGradientFactor,this.styles.geneFullVisibilityThreshold]).clamp(!0)}setGenes(t){this.genes=t,this.geneClusters=function(t){let e=0,n=[],r=null,i=0,o=0,a=[];t.map(t=>({pos:t.interval.lower,start:!0,gene:t})).concat(t.map(t=>({pos:t.interval.upper,start:!1,gene:t}))).sort((t,e)=>t.pos-e.pos).forEach(t=>{t.start&&(0==e&&(null==r&&(r=t.pos),t.pos-i>1e5&&(n.push({id:o,genes:a,interval:new fi(r,i)}),a=[],r=t.pos,o++)),a.push(t.gene),e++),t.start||(e--,i=t.pos)}),r&&n.push({id:o,genes:a,interval:new fi(r,i)});return n}(t);const e=Dh(this.genes,300,(t,e)=>e.score-t.score),n=e[e.length-1].score;this.overviewGenes=this.genes.filter(t=>t.score>=n)}async initialize(t){await super.initialize(t),this.trackContainer.className="gene-track",this.trackContainer.style.height=this.styles.lanes*(this.styles.laneHeight+this.styles.laneSpacing)+"px",this.trackContainer.style.marginTop=`${this.styles.laneSpacing}px`;const e=this.genomeSpy.coordinateSystem;if(!(e instanceof Si))throw new Error("The coordinate system is not genomic!");const n=`${e.baseUrl}/${e.name}/refSef_genes_scored_compressed.${e.name}.txt`;this.setGenes(function(t,e){const n=new Set(t.getChromosomes().map(t=>t.name));let r=0;const i=Ci(e).filter(t=>n.has(t[1])).map(e=>{const n=parseInt(e[2],10),i=n+parseInt(e[3],10);return r+=1e-7,{id:e[0],symbol:e[0],chrom:e[1],start:n,end:i,strand:e[4],score:+e[5]+r,exons:e[6],interval:t.segmentToContinuous(e[1],n,i),lane:void 0}});i.sort((t,e)=>t.interval.lower-e.interval.lower);const o=[],a={"-":0,"+":1},s=(t,e)=>o[t]&&o[t]>e;return i.forEach(t=>{let e=a[t.strand];if(s(e,t.interval.lower))for(e=0;e<20&&s(e,t.interval.lower);)e++;o[e]=t.interval.upper,t.lane=e}),i}(e.chromMapper,await fetch(n,{credentials:"same-origin"}).then(t=>{if(t.ok)return t.text();throw new Error(`Could not load gene annotations: ${n} \nReason: ${t.status} ${t.statusText}`)}))),this.initializeWebGL(),this.visibleGenes=[],this.visibleClusters=[],this.geneBufferInfoMap=new Map,this.exonBufferInfoMap=new Map,this.symbolWidths=new Map,this.symbolCanvas=this.createCanvas(),this.mouseTracker=new Kf({element:this.symbolCanvas,resolver:this.findGeneAt.bind(this),tooltip:this.genomeSpy.tooltip,tooltipConverter:t=>new Promise(e=>async function(t){if(Sh.has(t))return Sh.get(t);console.log("Searching: "+t);const e={mode:"cors"},n=(await fetch(`https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=gene&term=${t}[GENE]&sort=relevance&retmode=json`,e).then(t=>t.json())).esearchresult.idlist[0];if(n){const r=(await fetch(`https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi?db=gene&id=${n}&retmode=json`,e).then(t=>t.json())).result[n];return Sh.set(t,r),r}return null}(t.symbol).then(t=>e(this.entrezSummary2Html(t))))}).on("dblclick",t=>this.genomeSpy.zoomTo(t.interval.pad(.25*t.interval.width()))).on("contextmenu",(t,e)=>oh({items:kh(t)},e)),this.genomeSpy.on("zoom",()=>{this.render()}),this.genomeSpy.on("layout",t=>{this.resizeCanvases(t),this.render()}),this.genomeSpy.zoom.attachZoomEvents(this.symbolCanvas)}initializeWebGL(){super.initializeWebGL(),this.gl.enable(this.gl.BLEND),this.geneProgramInfo=Ts(this.gl,[xh.a,Ch.a].map(t=>this.processShader(t))),this.exonProgramInfo=Ts(this.gl,[Oh.a,zs.a].map(t=>this.processShader(t)))}entrezSummary2Html(t){return`\n        <div class="gene-track-tooltip">\n            <div class="title">\n                <strong>${Zf(t.name)}</strong>\n                ${Zf(t.description)}\n            </div>\n\n            <p class="summary">\n                ${Zf(t.summary)}\n            </p>\n\n            <div class="source">\n                Source: NCBI Gene\n            </p>\n        </div>`}findGeneAt(t){const e=this.styles.laneHeight+this.styles.laneSpacing,n=t[1]-this.styles.laneHeight-this.styles.symbolYOffset,r=Math.round(n/e);if(r<0||Math.abs(r*e-n)>1.3*this.styles.fontSize/2)return null;const i=this.symbolsOnLanes[r].intervalAt(t[0]);return i?i.gene:null}resizeCanvases(t){this.adjustCanvas(this.glCanvas,t.viewport),this.adjustCanvas(this.symbolCanvas,t.viewport),this.adjustGl(this.gl)}updateVisibleClusters(){const t=this.genomeSpy.getViewportDomain(),e=this.geneClusters.slice(On(t=>t.interval.upper).right(this.geneClusters,t.lower),On(t=>t.interval.lower).left(this.geneClusters,t.upper)),n=new Set(this.visibleClusters.map(t=>t.id)),r=new Set(e.map(t=>t.id)),i=e.filter(t=>!n.has(t.id)),o=this.visibleClusters.filter(t=>!r.has(t.id));this.visibleClusters=e;const a=t=>ya(this.gl,t.arrays,{numElements:t.numElements});i.forEach(t=>{this.exonBufferInfoMap.set(t.id,a(function(t,e,n){const r=t.map(t=>function(t){const e=[],n=t.exons.split(",");let r=t.interval.lower;for(let t=0;t<n.length;){r+=parseInt(n[t++],10);const i=r;r+=parseInt(n[t++],10);const o=r;e.push(new fi(i,o))}return e}(t)),i=r.map(t=>t.length).reduce((t,e)=>t+e,0),o=new Float32Array(6*i*2),a=new Float32Array(6*i),s=new Float32Array(6*i);let u=0;return t.forEach((t,i)=>{r[i].forEach(r=>{const i=Us(r.lower),c=Us(r.upper),l=r.width(),f=t.lane*(e+n),h=f+e;o.set([].concat(i,c,i,c,i,c),6*u*2),a.set([h,h,f,f,f,h],6*u),s.set([-l,l,-l,l,-l,l],6*u),u++})}),{arrays:{x:{data:o,numComponents:2,drawType:35040},y:{data:a,numComponents:1,drawType:35040},width:{data:s,numComponents:1,drawType:35040},height:{value:[0]}},numElements:6*i}}(t.genes,this.styles.laneHeight,this.styles.laneSpacing))),this.geneBufferInfoMap.set(t.id,a(function(t,e,n){const r=new Float32Array(6*t.length*2),i=new Float32Array(6*t.length),o=new Float32Array(6*t.length);return t.forEach((t,a)=>{const s=Us(t.interval.lower),u=Us(t.interval.upper),c=t.lane*(e+n),l=c+e;r.set([].concat(s,u,s,u,s,u),6*a*2),i.set([l,l,c,c,c,l],6*a),o.set([1,1,0,0,0,1],6*a)}),{arrays:{x:{data:r,numComponents:2,drawType:35040},y:{data:i,numComponents:1,drawType:35040},yEdge:{data:o,numComponents:1,drawType:35040}},numElements:6*t.length}}(t.genes,this.styles.laneHeight,this.styles.laneSpacing)))}),o.forEach(t=>{this.exonBufferInfoMap.delete(t.id),this.geneBufferInfoMap.delete(t.id)})}render(){const t=this.gl;t.clear(t.COLOR_BUFFER_BIT),(this.glCanvas.style.opacity=this.bodyOpacityScale(this.genomeSpy.getViewportDomain().width()))&&(this.updateVisibleClusters(),this.renderGenes()),this.renderSymbols()}renderSymbols(){this.symbolsOnLanes.forEach(t=>t.clear());const t=this.genomeSpy.getZoomedScale(),e=this.genomeSpy.getViewportDomain(),n=this.genomeSpy.getExpZoomLevel()>this.overviewGenes.length/this.styles.maxSymbolsToShow?this.genes:this.overviewGenes,r=On(t=>t.interval.lower);const i=Dh(n.slice(r.right(n,e.lower-5e5),r.left(n,e.upper+1e6)).filter(t=>e.connectedWith(t.interval)),this.styles.maxSymbolsToShow,(t,e)=>e.score-t.score),o=this.bodyOpacityScale(this.genomeSpy.getViewportDomain().width()),a=this.get2d(this.symbolCanvas);a.textBaseline="middle",a.textAlign="center",a.strokeStyle="rgba(255, 255, 255, 0.9)",a.lineWidth=3,a.lineJoin="round";const s=this.styles.laneHeight+this.styles.symbolYOffset;a.clearRect(0,0,this.symbolCanvas.width,this.symbolCanvas.height);for(const e of i){const n=t(e.interval.centre()),r=e.symbol;let i=this.symbolWidths.get(r);i||(i=a.measureText(r).width,this.symbolWidths.set(r,i));const u=i/2+5,c=new fi(n-u,n+u);if(!this.symbolsOnLanes[e.lane].addIfRoom({screenInterval:c,gene:e}))continue;const l=e.lane*(this.styles.laneHeight+this.styles.laneSpacing)+s;o&&(a.globalAlpha=o,a.font=`${.6*this.styles.fontSize}px ${this.styles.fontFamily}`,"-"==e.strand?a.fillText("◀",n-i/2-4,l):a.fillText("▶",n+i/2+4,l),a.globalAlpha=1),a.font=`${this.styles.fontSize}px ${this.styles.fontFamily}`,a.strokeText(r,n,l),a.fillText(r,n,l)}}renderGenes(){const t=this.gl,e={uMinWidth:1/t.drawingBufferWidth,uColor:[0,0,0],...this.getDomainUniforms()},n=(new qf).scale([this.gl.canvas.clientWidth,1,1]),r=this.viewportProjection.clone().multiplyRight(n);t.useProgram(this.geneProgramInfo.program),As(this.geneProgramInfo,{...e,uTMatrix:r,uResolution:this.styles.laneHeight}),this.visibleClusters.forEach(e=>{const n=this.geneBufferInfoMap.get(e.id);_s(t,this.geneProgramInfo,n),Os(t,n)}),t.useProgram(this.exonProgramInfo.program),As(this.exonProgramInfo,{...e,uTMatrix:r}),this.visibleClusters.forEach(e=>{const n=this.exonBufferInfoMap.get(e.id);_s(t,this.exonProgramInfo,n),Os(t,n)})}search(t){t=t.toUpperCase();const e=this.genes.filter(e=>e.symbol==t);if(e.length>0){e.sort((t,e)=>e.interval.width()-t.interval.width());const t=e[0].interval;return t.pad(.25*t.width())}return null}searchHelp(){return"<p>Find a gene or transcript. Examples:</p>\n        <ul>\n            <li>BRCA1</li>\n            <li>TP53</li>\n        </ul>"}}};class Rh{constructor(t,e){this.container=t,this.config=e,this.eventEmitter=new li.a,this.zoom=new pi(this._zoomed.bind(this)),this.maxUnitZoom=30,this.tracks=[],this.accessorFactory=new Nh,this._dpr=window.devicePixelRatio,this.coordinateSystem=null,this.namedDataProviders=[],this.viewportTransform=new mi}on(...t){this.eventEmitter.on(...t)}registerNamedDataProvider(t){this.namedDataProviders.unshift(t)}getNamedData(t){for(const e of this.namedDataProviders){const n=e(t);if(n)return n}}_constrainX(t){return new mi(t.k,Math.min(0,Math.max(t.x,-(t.k-1)*this.layout.viewport.width())))}_zoomed(t){if(t.deltaY){let e=Math.pow(2,t.deltaY/500);const n=Math.max(Math.min(this.viewportTransform.k*e,this.scaleExtent[1]),this.scaleExtent[0]);e=n/this.viewportTransform.k;const r=(this.viewportTransform.x-t.mouseX)*e+t.mouseX;this._zoomWithTransform(this._constrainX(new mi(n,r)))}else this._zoomWithTransform(this._constrainX(new mi(this.viewportTransform.k,this.viewportTransform.x+t.deltaX)))}_zoomWithTransform(t){this.viewportTransform=t,this.rescaledX=this.viewportTransform.rescale(this.xScale),this.eventEmitter.emit("zoom",this.getViewportDomain())}getDomain(){let t=this.viewRoot.resolutions.x.getDomain();return t?fi.fromArray(t):new fi(0,1)}getViewportDomain(){return fi.fromArray(this.rescaledX.domain())}getViewportDomainString(){return this.coordinateSystem.formatInterval(this.getViewportDomain().intersect(this.getDomain()))}getZoomedScale(){return this.rescaledX.copy()}getAxisWidth(){return this.tracks.map(t=>t.getMinAxisWidth()).reduce((t,e)=>Math.max(t,e),0)}getLinearZoomLevel(){const t=this.coordinateSystem.getExtent();if(t){const e=t.width(),n=this.getViewportDomain().width(),r=this.maxUnitZoom;return Math.log2(e/n)/Math.log2(e/r)}}getExpZoomLevel(){return this.getDomain().width()/this.getViewportDomain().width()}zoomTo(t){const e=this.xScale,n=this.getViewportDomain(),r=t=>(new mi).scale(this.layout.viewport.width()/(e(t.upper)-e(t.lower))).translate(-e(t.lower)),i=ui([n.centre(),0,n.width()],[t.centre(),0,t.width()]);return vi({duration:300+.07*i.duration,onUpdate:t=>{const e=i(t),n=new fi(e[0]-e[2]/2,e[0]+e[2]/2);this._zoomWithTransform(r(n))}})}async search(t){const e=[{search:t=>this.coordinateSystem.parseInterval(t)},...this.tracks].map(e=>e.search(t)).find(t=>t);if(!e)throw`No matches found for "${t}"`;await this.zoomTo(e)}_getSampleTracks(){return this.tracks.filter(t=>t instanceof gh)}backtrackSamples(){const t=this._getSampleTracks()[0];t&&t.backtrackSamples()}isSomethingToBacktrack(){const t=this._getSampleTracks()[0];return t&&t.sampleOrderHistory.length>1}_resized(){const t=window.getComputedStyle(this.container,null),e=this.container.clientWidth-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight),n=Math.ceil(this.getAxisWidth()),r=e-n;this.xScale.range([0,r]),this.rescaledX.range([0,r]),this.layout={axis:new fi(0,n),viewport:new fi(n,n+r)},this.scaleExtent=[1,this.coordinateSystem.getExtent()?this.getDomain().width()/this.maxUnitZoom:1/0],this.eventEmitter.emit("layout",this.layout)}_prepareContainer(){this.loadingMessageElement=document.createElement("div"),this.loadingMessageElement.className="loading-message",this.loadingMessageElement.innerHTML='<div class="message">Loading...</div>',this.container.appendChild(this.loadingMessageElement),this._listeners=[{target:window,type:"resize",listener:this._resized.bind(this)},{target:window,type:"mousemove",listener:()=>{window.devicePixelRatio!=this._dpr&&(this._dpr=window.devicePixelRatio,this._resized())}},{target:this.container,type:"contextmenu",listener:t=>t.preventDefault()}];for(const t of this._listeners)t.target.addEventListener(t.type,t.listener);const t=document.createElement("div");t.classList.add("track-stack"),this.container.appendChild(t),this.trackStack=t,this.tooltip=new yi(this.container),this.container.classList.add("genome-spy"),this.container.classList.add("loading")}destroy(){for(const t of this._listeners)t.target.removeEventListener(t.type,t.listener);for(;this.container.firstChild;)this.container.firstChild.remove();this.container.classList.remove("genome-spy"),this.container.classList.remove("loading")}async launch(){this._prepareContainer();try{this.config.genome?this.coordinateSystem=new Si(this.config.genome):this.coordinateSystem=new Fh,await this.coordinateSystem.initialize(this);const t={coordinateSystem:this.coordinateSystem,accessorFactory:this.accessorFactory,genomeSpy:this,getDataSource:(t,e)=>new dh(t,e,this.getNamedData.bind(this))},e=this.config;return Jl(e)&&await async function(t){t.concat=await Promise.all(t.concat.map(e=>Ql(e)&&e.import.url?async function(t,e){if(!t.import.url)throw new Error("Cannot import, not an external track: "+JSON.stringify(t));const n=bn({baseURL:e}),r=t.import.url,i=JSON.parse(await n.load(r).catch(t=>{throw new Error(`Could not load imported track spec: ${r} \nReason: ${t.message}`)}));if(function(t){return Kl(t)||Zl(t)||Jl(t)}(i))return i.baseUrl=(await n.sanitize(r)).href.match(/^.*\//)[0],i;throw new Error(`The imported spec "${r}" is not a view spec: ${JSON.stringify(t)}`)}(e,t.baseUrl):e))}(e),this.viewRoot=ef(e,t),this.viewRoot.visit(t=>{t instanceof Xl&&t.resolve()}),this.coordinateSystem instanceof Fh&&(this.viewRoot=function(t){const e=t.resolutions.x;if(e&&e.getAxisProps()){if(t instanceof Gl)return t.children.push(ef({import:{name:"axis"}},t.context)),t;{const e=ef({name:"implicit_root",concat:[{import:{name:"axis"}}]},t.context);return e.children.unshift(t),t.parent=e,e.resolutions.x=t.resolutions.x,delete t.resolutions.x,e}}return t}(this.viewRoot)),this.coordinateSystem.getExtent()&&this.viewRoot.getResolution("x").setDomain($l("quantitative",this.coordinateSystem.getExtent().toArray())),await async function(t){const e=[];t.visit(t=>{e.push(t.loadData())}),await Promise.all(e),t.visit(t=>t.transformData()),t.visit(t=>{t instanceof Xl&&t.mark.initializeData()})}(this.viewRoot),this.viewRoot.visit(t=>{t instanceof Xl&&t.mark.initializeEncoders()}),this._createTracks(),await Promise.all(this.tracks.map(t=>{const e=document.createElement("div");return e.className="genome-spy-track",this.trackStack.appendChild(e),t.initialize(e)})),this.xScale=oi().domain(this.viewRoot.getResolution("x").getScale().domain()),this.rescaledX=this.xScale,this._resized(),this}catch(t){const e=`${t.view?`At "${t.view.getPathString()}": `:""}${t.toString()}`;console.error(e),console.error(t.stack),function(t,e){const n=document.createElement("div");n.className="message-box";const r=document.createElement("div");r.textContent=e,n.appendChild(r),t.appendChild(n)}(this.container,e)}finally{this.container.classList.remove("loading")}}_createTracks(){this.tracks=[],this.viewRoot.visit(t=>{if(t instanceof jo){const e=t.spec.import.name;if(e){if(!Ih[e])throw new Error(`Unknown track name: ${e}`);this.tracks.push(new Ih[e](this,t.spec))}}else if(!(t instanceof Gl)&&(t.parent instanceof Gl||null==t.parent)){const e=new(t.getResolution("sample")?gh:Qf)(this,t.spec,t);this.tracks.push(e)}})}}n(27);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const Bh=new WeakMap,Lh=o(t=>e=>{if(!(e instanceof T))throw new Error("unsafeHTML can only be used in text bindings");const n=Bh.get(e);if(void 0!==n&&E(t)&&t===n.value&&e.value===n.fragment)return;const r=document.createElement("template");r.innerHTML=t;const i=document.importNode(r.content,!0);e.setValue(i),Bh.set(e,{value:t,fragment:i})});var Ph=n(7),zh={prefix:"fas",iconName:"arrows-alt-v",icon:[256,512,[],"f338","M214.059 377.941H168V134.059h46.059c21.382 0 32.09-25.851 16.971-40.971L144.971 7.029c-9.373-9.373-24.568-9.373-33.941 0L24.971 93.088c-15.119 15.119-4.411 40.971 16.971 40.971H88v243.882H41.941c-21.382 0-32.09 25.851-16.971 40.971l86.059 86.059c9.373 9.373 24.568 9.373 33.941 0l86.059-86.059c15.12-15.119 4.412-40.971-16.97-40.971z"]},Uh={prefix:"fas",iconName:"fish",icon:[576,512,[],"f578","M327.1 96c-89.97 0-168.54 54.77-212.27 101.63L27.5 131.58c-12.13-9.18-30.24.6-27.14 14.66L24.54 256 .35 365.77c-3.1 14.06 15.01 23.83 27.14 14.66l87.33-66.05C158.55 361.23 237.13 416 327.1 416 464.56 416 576 288 576 256S464.56 96 327.1 96zm87.43 184c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24 13.26 0 24 10.74 24 24 0 13.25-10.75 24-24 24z"]},Wh={prefix:"fas",iconName:"info-circle",icon:[512,512,[],"f05a","M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"]},jh={prefix:"fas",iconName:"question-circle",icon:[512,512,[],"f059","M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zM262.655 90c-54.497 0-89.255 22.957-116.549 63.758-3.536 5.286-2.353 12.415 2.715 16.258l34.699 26.31c5.205 3.947 12.621 3.008 16.665-2.122 17.864-22.658 30.113-35.797 57.303-35.797 20.429 0 45.698 13.148 45.698 32.958 0 14.976-12.363 22.667-32.534 33.976C247.128 238.528 216 254.941 216 296v4c0 6.627 5.373 12 12 12h56c6.627 0 12-5.373 12-12v-1.333c0-28.462 83.186-29.647 83.186-106.667 0-58.002-60.165-102-116.531-102zM256 338c-25.365 0-46 20.635-46 46 0 25.364 20.635 46 46 46s46-20.636 46-46c0-25.365-20.635-46-46-46z"]},Hh={prefix:"fas",iconName:"undo",icon:[512,512,[],"f0e2","M212.333 224.333H12c-6.627 0-12-5.373-12-12V12C0 5.373 5.373 0 12 0h48c6.627 0 12 5.373 12 12v78.112C117.773 39.279 184.26 7.47 258.175 8.007c136.906.994 246.448 111.623 246.157 248.532C504.041 393.258 393.12 504 256.333 504c-64.089 0-122.496-24.313-166.51-64.215-5.099-4.622-5.334-12.554-.467-17.42l33.967-33.967c4.474-4.474 11.662-4.717 16.401-.525C170.76 415.336 211.58 432 256.333 432c97.268 0 176-78.716 176-176 0-97.267-78.716-176-176-176-58.496 0-110.28 28.476-142.274 72.333h98.274c6.627 0 12 5.373 12 12v48c0 6.627-5.373 12-12 12z"]};class Yh{constructor(t,e){this.config=e,this.appContainer=t,this.appContainer==document.body?(this.appContainer.style.margin="0",this.appContainer.style.padding="0"):this.appContainer.style.position="relative";const n=this;function r(){return P`
                <div class="search-help" @click=${s}>
                    <p>Focus to a specific range. Examples:</p>
                    <ul>
                        <!-- TODO: Display only when using a genomic coordinate system-->
                        <li>chr8:21,445,873-24,623,697</li>
                        <li>chr4:166,014,727-chr15:23,731,397</li>
                    </ul>

                    ${Lh((n.genomeSpy?n.genomeSpy.tracks.map(t=>t.searchHelp()):[]).join(""))}
                </div>
            `}function i(){const t=n.genomeSpy&&n.genomeSpy._getSampleTracks().length>0?P`
                          <button
                              class="tool-btn backtrack-samples"
                              title="Backtrack samples (B)"
                              ?disabled=${!n.genomeSpy.isSomethingToBacktrack()}
                              @click=${l}
                          >
                              ${Object(Ph.a)(Hh).node[0]}
                          </button>

                          <button
                              class="tool-btn"
                              title="Fisheye (E)"
                              @click=${()=>n.genomeSpy._getSampleTracks()[0].toggleFisheye()}
                          >
                              ${Object(Ph.a)(Uh).node[0]}
                          </button>

                          <button
                              class="tool-btn"
                              title="Peek (Z)"
                              @click=${()=>n.genomeSpy._getSampleTracks()[0].togglePeek()}
                          >
                              ${Object(Ph.a)(zh).node[0]}
                          </button>
                      `:"";return P`
                ${t}

                <button
                    class="tool-btn"
                    title="Info"
                    @click=${()=>alert("TODO")}
                >
                    ${Object(Ph.a)(Wh).node[0]}
                </button>

                ${n.genomeSpy&&n.genomeSpy.config.title?P`
                          <span class="vis-title"
                              >${n.genomeSpy.config.title}</span
                          >
                      `:""}

                <span class="spacer"></span>

                <button
                    class="tool-btn"
                    title="Help"
                    @click=${()=>window.open("https://genomespy.app/docs/","_blank")}
                >
                    ${Object(Ph.a)(jh).node[0]}
                </button>
            `}function o(){return P`
                <nav class="toolbar">
                    <div class="title">
                        GenomeSpy
                    </div>
                    <div class="search">
                        <input
                            type="text"
                            class="search-input"
                            value=${n.genomeSpy?n.genomeSpy.getViewportDomainString():""}
                            @keydown=${c}
                            @focus=${u}
                        />
                        ${r()}
                    </div>
                    ${i()}
                </nav>
            `}const a=t=>this.appContainer.getElementsByClassName(t)[0];function s(t){const e=t.target;"LI"==e.tagName&&function(t){const e=a("search-input");(function(t,e){return new Promise(n=>{let r=0;const i=700/t.length+30;!function o(){e.value=t.substring(0,r),r>=t.length?setTimeout(n,500):(r++,setTimeout(o,Math.random()*i*2))}()})})(t,e).then(()=>{e.blur(),n.genomeSpy.search(t)})}(e.innerText)}function u(t){t.target.select()}function c(t){const e=t.target;13==t.keyCode?(t.preventDefault(),n.genomeSpy.search(e.value).then(()=>{e.focus(),e.select()}).catch(t=>alert(t))):27==t.keyCode?e.blur():t.stopPropagation()}function l(){n.genomeSpy.backtrackSamples()}this._renderTemplate=()=>{L(P`
                <div class="genome-spy-app">
                    ${o()}
                    <div class="genome-spy-container"></div>
                </div>
            `,n.appContainer)},this._renderTemplate(),document.addEventListener("keydown",t=>{switch(t.code){case"KeyF":t.metaKey||t.altKey||t.ctrlKey||(t.preventDefault(),a("search-input").focus());break;case"Backspace":case"KeyB":n.genomeSpy.backtrackSamples()}}),a("genome-spy-container").addEventListener("click",t=>{a("search-input").blur()}),this.genomeSpy=new Rh(a("genome-spy-container"),this.config)}async launch(){const t=t=>this.appContainer.getElementsByClassName(t)[0];this.genomeSpy.on("zoom",()=>{t("search-input").value=this.genomeSpy.getViewportDomainString()}),this.genomeSpy.on("samplesupdated",()=>{this._renderTemplate()}),await this.genomeSpy.launch(),this._renderTemplate()}async updateConfig(t){this.config=t,this.genomeSpy.destroy(),await this.launch()}}async function $h(t,e,n={}){let r;if(Object(V.o)(t)){if(r=document.querySelector(t),!r)throw new Error(`No such element: ${t}`)}else{if(!(t instanceof HTMLElement))throw new Error(`Invalid element: ${t}`);r=t}try{const t=Object(V.n)(e)?e:await async function(t){let e;try{e=JSON.parse(await bn().load(t))}catch(e){throw new Error(`Could not load or parse configuration: ${t}, reason: ${e.message}`)}if(!e.baseUrl){const n=t.match(/^.*\//);e.baseUrl=n&&n[0]||"./"}return e}(e);if(t.baseUrl=t.baseUrl||"",n.bare){const e=new Rh(r,t);return qh(e,n),await e.launch(),e}{const e=new Yh(r,t);return qh(e.genomeSpy,n),await e.launch(),e.genomeSpy}}catch(t){r.innerText=t.toString(),console.error(t)}}function qh(t,e){e.namedDataProvider&&t.registerNamedDataProvider(e.namedDataProvider)}function*Xh(t){const e=t.length;let n=0,r=n;for(;n<e;){const i=t.charCodeAt(n++);let o;if(10===i?o=t.substring(r,n-1):13===i?(o=t.substring(r,n-1),10===t.charCodeAt(n+1)&&n++):n===e&&(o=t.substring(r,n-1)),void 0!==o&&(yield o,o=void 0,r=n,n>=e))return o}}function Vh(t){return new Promise((e,n)=>{let r=new FileReader;r.onload=()=>e(r.result),r.onerror=n,r.readAsText(t)})}function Gh(){return new Promise((t,e)=>window.requestAnimationFrame(()=>window.requestAnimationFrame(t)))}const Kh="#f70",Zh="black",Jh="#49A0F2",Qh="#f7f7f7",td={name:"chromGrid",mark:"rule",data:{name:"chromSizes"},encoding:{x:{chrom:"name",pos:"size",type:"quantitative"},color:{value:"#d8d8d8"}}};function ed(t,{lower:e,upper:n,title:r,domain:i}){const o=[];return e&&n&&o.push({mark:{type:"rect",minWidth:2,minOpacity:1},encoding:{y:{field:e,type:"quantitative",title:null},y2:{field:n},color:{value:Kh},opacity:{value:.3}}}),o.push({mark:{type:"rule",size:3,minLength:3},encoding:{y:{field:t,type:"quantitative",scale:{domain:i},title:r},color:{value:Zh}}}),o}function nd(t){return Math.max(0,Math.log((t-1e3)/4)/Math.log(3))||0}n(21);n.d(e,"FILE_TYPES",(function(){return id}));const rd=["hg38","hg19"],id={HETS:{name:"HETS",title:"Allelic counts",example:"tumor.hets.tsv",column:"REF_COUNT"},CR:{name:"CR",title:"Denoised copy ratios",example:"tumor.denoisedCR.tsv",column:"LOG2_COPY_RATIO"},SEG:{name:"SEG",title:"Modeled segments",example:"tumor.modelFinal.seg",column:"LOG2_COPY_RATIO_POSTERIOR_50"},DICT:{name:"DICT",title:"Sequence dictionary",example:"GRCh38.d1.vd1.fa.dict",column:void 0}};function od(t){const e=function(t,e="@"){for(const n of Xh(t))if("string"==typeof e&&n[0]!==e)return n}(t);if("string"==typeof e&&""!==e){const t=e.split("\t");for(const e of Object.values(id))if(e.column&&t.includes(e.column))return e}else if("@"===t[0])return id.DICT}function ad(t){const e=function(t){const e={},n=(t,n)=>{e[t]||(e[t]=[]),e[t].push(n)};for(const e of Xh(t)){const t=e.match(/^@([A-Z]{2})\t(.*)/);if(!t)break;{const e=t[1];if("CO"===e)n(e,commentMatch[1]);else{n(e,Object.fromEntries(t[2].split("\t").map(t=>t.match(/^([A-Za-z][A-Za-z0-9]):(.*)/)).filter(t=>t).map(t=>t.slice(1))))}}}return e}(t);if(!e.SQ)throw new Error("The SAM header has no sequence dictionary!");return e.SQ.map(t=>({name:t.SN,size:+t.LN}))}new class{constructor(){this.files=new Map,this.genome=rd[0],this.dragging=!1,this.genomeSpyLaunched=!1,this.render()}_getMainTemplate(){const t=t=>{const e=this.files.get(t);return P`
                <tr>
                    <td>${t.title}</td>
                    ${e?P`
                              <td class="status okay">
                                  <span class="icon">&#x2714;</span>
                              </td>
                              <td>
                                  ${e.name}
                              </td>
                              <td>
                                  ${e.data?`${e.data.length} records`:"Parsing..."}
                              </td>
                          `:P`
                              <td class="status">
                                  <span class="icon">&#x2717;</span>
                              </td>
                              <td>
                                  Missing.
                                  <span class="example-file"
                                      >Example: ${t.example}</span
                                  >
                              </td>
                              <td></td>
                          `}
                </tr>
            `},e=()=>P`
            <div class="btn-group" role="group">
                ${rd.map(t=>P`
                        <button
                            type="button"
                            @click=${()=>this.selectGenome(t)}
                            class="btn btn-secondary ${this.genome===t?"active":""}"
                        >
                            ${t}
                        </button>
                    `)}
                <button
                    type="button"
                    @click=${()=>this.selectGenome(void 0)}
                    class="btn btn-secondary ${this.genome?"":"active"}"
                >
                    .dict file
                </button>
            </div>
        `;return P`
            ${(()=>P`
            <div
                @dragenter=${this.drag}
                @dragover=${this.drag}
                @dragleave=${this.drag}
                @drop=${this.drop}
                class=${U({"drop-zone":!0,dragging:this.dragging,"active-panel":!this.genomeSpyLaunched})}
            >
                <div class="file-box">
                    <h2>
                        1. Choose a genome assembly or a sequence dictionary
                    </h2>

                    <p>
                        Choosing a genome assembly instead of a sequence
                        dictionary activates cytoband, GC content, and RefSeq
                        gene tracks.
                    </p>

                    ${e()}

                    <h2>2. Select files</h2>

                    <p>
                        Please provide at least one of the following files to
                        start visualizing. File types are detected from the TSV
                        header row.
                    </p>

                    <p>
                        N.B. All data processing takes place in your web
                        browser. Nothing is uploaded anywhere.
                    </p>

                    <table class="file-table">
                        ${Object.values(id).filter(t=>t!==id.DICT||!this.genome).map(t)}
                    </table>

                    <input
                        type="file"
                        multiple
                        accept=".tsv,.seg"
                        id="fileInput"
                        @change=${this.filesChosen}
                        style="display:none"
                    />

                    <div class="upload-button-wrapper">
                        <button
                            class="btn"
                            style="margin-right: 1em"
                            @click=${t=>{document.getElementById("fileInput").click(),t.preventDefault(),t.stopPropagation()}}
                        >
                            Choose files
                        </button>
                        or drag and drop here.
                    </div>

                    <h2>3. Explore the data</h2>

                    Zoom with the mouse wheel or touchpad, pan by dragging or
                    with the touchpad. Hover an item to get details.

                    <div class="buttons">
                        <button
                            ?disabled=${!this.isReadyToVisualize()}
                            @click=${this.visualize}
                            class="btn btn-lg"
                        >
                            Let's visualize!
                        </button>
                    </div>
                </div>
            </div>
        `)()}

            <div
                id="genome-spy-container"
                class=${U({"active-panel":!!this.genomeSpyLaunched})}
            ></div>
        `}_getToolbarTemplate(){return P`
            <div class="buttons ${this.genomeSpy?"visible":"hidden"}">
                <button @click=${this.closeVisualization}>
                    &#x21D0; Back to files
                </button>
            </div>
        `}drag(t){t.stopPropagation(),t.preventDefault(),"dragleave"===t.type?(this.dragging=!1,this.render()):(this.dragging=!0,this.render())}drop(t){t.stopPropagation(),t.preventDefault(),this.dragging=!1;const e=t.dataTransfer.files;this.handleFiles(e)}isReadyToVisualize(){const t=new Map([...this.files.entries()].filter(t=>t[0]!==id.DICT));return t.size>0&&[...t.values()].every(t=>t.data)&&(this.genome||this.files.has(id.DICT))}render(){L(this._getMainTemplate(),document.querySelector("main"),{eventContext:this}),L(this._getToolbarTemplate(),document.querySelector("header .toolbar"),{eventContext:this})}async visualize(){this.closeVisualization();const t=function(t,e){const n=e?{name:e}:{contigs:t.get(id.DICT).data},[r,i,o]=[id.SEG,id.CR,id.HETS].map(n=>{const r=t.get(n),i=r?r.data:[];if(/^hg\d+/.test(e)){let t;const e=e=>{const n=e.contig;return n===t||(/^(chr)?(\d{1,2}|[XY])$/.test(n)?(t=n,!0):(t="",!1))};return i.filter(e)}return i});return{genome:n,data:{values:r},encoding:{x:{chrom:"contig",pos:"start",type:"quantitative",offset:-1},x2:{chrom:"contig",pos:"end"}},concat:[...e?[{import:{name:"cytobands"}},{import:{url:`https://genomespy.app/tracks/gc-content/gc-content.${e}.json`}}]:[],{name:"logRTrack",plotBackground:Qh,layer:[td,{data:{values:i},transform:[{type:"filter",expr:"!isNaN(datum.logR) && datum.logR > -3"}],title:"Single interval midpoint",mark:{type:"point",geometricZoomBound:nd(i.length)},encoding:{x:{chrom:"contig",pos:"pos",type:"quantitative"},y:{field:"logR",type:"quantitative",title:null,scale:{}},color:{value:Jh},size:{value:150},opacity:{value:.25},strokeWidth:{value:0}}},{title:"Denoised copy-ratio",transform:[{type:"filter",expr:"datum.LOG2_COPY_RATIO_POSTERIOR_50 > -3"}],layer:ed("LOG2_COPY_RATIO_POSTERIOR_50",{lower:"LOG2_COPY_RATIO_POSTERIOR_10",upper:"LOG2_COPY_RATIO_POSTERIOR_90",title:"Log2 copy ratio"})}]},{name:"bafTrack",plotBackground:"#f7f7f7",layer:[td,{data:{values:o},title:"B allele frequency",mark:{type:"point",geometricZoomBound:nd(o.length)},encoding:{x:{chrom:"contig",pos:"pos",offset:-.5,type:"quantitative"},y:{field:"baf",type:"quantitative",title:null},color:{value:Jh},size:{value:150},opacity:{value:.3},strokeWidth:{value:0}}},{title:"Alternate-allele fraction",layer:[{layer:ed("MINOR_ALLELE_FRACTION_POSTERIOR_50",{lower:"MINOR_ALLELE_FRACTION_POSTERIOR_10",upper:"MINOR_ALLELE_FRACTION_POSTERIOR_90",title:"Alternate-allele fraction",scale:[0,1]})},{transform:[10,50,90].map(t=>`MINOR_ALLELE_FRACTION_POSTERIOR_${t}`).map(t=>({type:"formula",expr:`1 - datum.${t}`,as:t})),layer:ed("MINOR_ALLELE_FRACTION_POSTERIOR_50",{lower:"MINOR_ALLELE_FRACTION_POSTERIOR_10",upper:"MINOR_ALLELE_FRACTION_POSTERIOR_90",title:"Alternate-allele fraction"})}]}]},{import:{name:"genomeAxis"}},...e?[{import:{name:"geneAnnotation"}}]:[]]}}(this.files,this.genome);this.genomeSpyLaunched=!0,this.render(),this.genomeSpy=await $h(document.querySelector("#genome-spy-container"),t,{bare:!0}),this.render()}closeVisualization(){this.genomeSpy&&(this.genomeSpy.destroy(),this.genomeSpy=void 0),this.genomeSpyLaunched=!1,this.render()}selectGenome(t){this.genome=t,this.render()}filesChosen(t){this.handleFiles(t.target.files)}async handleFiles(t){const e=t=>""!==t?+t:null,n={[id.HETS.name]:t=>{const e=+t.ALT_COUNT,n=+t.REF_COUNT;return{contig:t.CONTIG,pos:+t.POSITION,baf:e/(n+e)}},[id.CR.name]:t=>{const n=+t.START,r=+t.END;return{contig:t.CONTIG,start:n,end:r,pos:(n-1+r)/2,logR:e(t.LOG2_COPY_RATIO)}},[id.SEG.name]:t=>({contig:t.CONTIG,start:+t.START,end:+t.END,NUM_POINTS_COPY_RATIO:+t.NUM_POINTS_COPY_RATIO,NUM_POINTS_ALLELE_FRACTION:+t.NUM_POINTS_ALLELE_FRACTION,LOG2_COPY_RATIO_POSTERIOR_10:+t.LOG2_COPY_RATIO_POSTERIOR_10,LOG2_COPY_RATIO_POSTERIOR_50:e(t.LOG2_COPY_RATIO_POSTERIOR_50),LOG2_COPY_RATIO_POSTERIOR_90:+t.LOG2_COPY_RATIO_POSTERIOR_90,MINOR_ALLELE_FRACTION_POSTERIOR_10:+t.MINOR_ALLELE_FRACTION_POSTERIOR_10,MINOR_ALLELE_FRACTION_POSTERIOR_50:e(t.MINOR_ALLELE_FRACTION_POSTERIOR_50),MINOR_ALLELE_FRACTION_POSTERIOR_90:+t.MINOR_ALLELE_FRACTION_POSTERIOR_90})},r=[];for(const e of t){const t=await Vh(e),n=od(t);n?(r.push({file:e,textContent:t,type:n}),this.files.set(n,{name:e.name,data:null})):alert(`Cannot recognise this file: ${e.name}.`),n===id.DICT&&(this.genome=void 0)}for(const t of r){let e;this.render(),await Gh(),e=t.type!==id.DICT?X("\t",{comment:"@"}).parse(t.textContent,n[t.type.name]):ad(t.textContent),this.files.set(t.type,{name:t.file.name,data:e})}await Gh(),this.render(),3===new Set(r.map(t=>t.type).filter(t=>t.type!==id.DICT)).size&&this.isReadyToVisualize()&&this.visualize()}}}]);
//# sourceMappingURL=main.js.map